import{a as J}from"./chunk-XX426LW7.js";import{a as Xe,b as Ye,c as Ke,d as Ze,e as Qe,f as et}from"./chunk-74B4PIC2.js";import{a as $,b as G}from"./chunk-H5Q2MUI4.js";import{b as Be,c as He}from"./chunk-S36J2H5Q.js";import{b as W,g as je}from"./chunk-F3RYFQ6B.js";import"./chunk-TDHPXMC7.js";import{a as Ce}from"./chunk-NHWKIFHZ.js";import{c as Ue,d as $e,g as Ge,h as We,i as Je,j as qe}from"./chunk-P7C4W3NB.js";import"./chunk-VO3YBL7P.js";import{a as j,b as U}from"./chunk-ROJ55FAU.js";import{a as Ae,b as Le}from"./chunk-Q5HFPYVW.js";import"./chunk-NJ5QHTB6.js";import"./chunk-OL6EOTCO.js";import{b as Te,c as ke,d as Ne,e as Ie,h as Fe,i as Re}from"./chunk-72MGGUFA.js";import{c as De,d as z,f as V,g as ye,i as xe,j as Me,k as Pe,l as we,p as Se,q as Oe,r as Ee,v as B,w as H}from"./chunk-5NEP5BWI.js";import"./chunk-QR2Q3M5C.js";import{c as be,d as he}from"./chunk-7V3ZHUQC.js";import{a as ze,b as Ve}from"./chunk-MO4NRYQI.js";import"./chunk-S3FWETWA.js";import{Ca as K,Ga as k,h as L,i as ue,k as fe,m as ve,w as _e,wb as P,xb as w}from"./chunk-72AVHRIS.js";import{$b as R,Ab as c,Ac as I,Cc as h,Dc as f,Hb as T,Mb as p,Ob as g,Pa as r,U as v,Z as D,_ as y,bb as x,bc as d,cc as b,dc as S,ec as re,gc as le,hb as E,hc as de,ic as me,ja as u,jc as A,kc as O,lc as se,ma as ie,rb as _,sb as C,sc as M,tc as ce,ub as ne,uc as N,vb as oe,vc as pe,wb as ae,xb as m,yb as i,yc as ge,zb as n}from"./chunk-XTNRL3Y3.js";var rt=()=>[10,20,50,100];function lt(a,e){a&1&&(i(0,"tr")(1,"th",11),d(2,"Estado"),n(),i(3,"th",12),d(4," Dominio "),c(5,"p-sortIcon",13),n(),i(6,"th",14),d(7," Vence "),c(8,"p-sortIcon",15),n(),i(9,"th",16),d(10,"Nameservers"),n(),i(11,"th",17),d(12,"Lock"),n(),i(13,"th",17),d(14,"Privacy"),n(),i(15,"th",18),d(16,"Acciones"),n()())}function dt(a,e){if(a&1){let t=T();i(0,"tr",19)(1,"td",20),c(2,"app-expiration-semaphore",21),n(),i(3,"td",22)(4,"strong"),d(5),n()(),i(6,"td")(7,"span",23),d(8),M(9,"date"),n()(),i(10,"td",24)(11,"span",25),d(12),n()(),i(13,"td",26),c(14,"p-tag",27),n(),i(15,"td",26),c(16,"p-tag",27),n(),i(17,"td",28)(18,"p-button",29),p("onClick",function(l){let s=D(t).$implicit,F=g();return y(F.onEditDomain(s,l))}),n(),i(19,"p-button",30),p("onClick",function(){let l=D(t).$implicit,s=g();return y(s.onDomainClick(l))}),n()()()}if(a&2){let t=e.$implicit,o=g();r(2),m("expiresAt",t.expiresAt),r(3),b(t.domainName),r(3),S(" ",N(9,13,t.expiresAt.toDate(),"dd/MM/yyyy HH:mm")," "),r(3),m("title",o.formatNameservers(t.nameservers)),r(),S(" ",o.formatNameservers(t.nameservers)," "),r(2),m("value",t.domainLock?"S\xED":"No")("severity",o.getPrivacyLockSeverity(t.domainLock||!1)),r(2),m("value",t.privacyProtection?"S\xED":"No")("severity",o.getPrivacyLockSeverity(t.privacyProtection||!1)),r(2),m("text",!0)("pTooltip","Editar"),r(),m("text",!0)("pTooltip","Ver detalles")}}function mt(a,e){a&1&&(i(0,"div",32),c(1,"i",34),i(2,"p"),d(3,"Cargando dominios..."),n()())}function st(a,e){a&1&&(i(0,"p",36),d(1,"Intenta cambiar los filtros de b\xFAsqueda"),n())}function ct(a,e){if(a&1&&(i(0,"div",33),c(1,"i",35),i(2,"p"),d(3,"No se encontraron dominios"),n(),_(4,st,2,0,"p",36),n()),a&2){let t=g(2);r(4),C(t.searchText()||t.selectedDaysFilter()!==null?4:-1)}}function pt(a,e){if(a&1&&(i(0,"tr")(1,"td",31),_(2,mt,4,0,"div",32)(3,ct,5,1,"div",33),n()()),a&2){let t=g();r(2),C(t.isLoading()?2:3)}}var q=class a{domains=f.required();isLoading=f(!1);totalRecords=f(0);domainClicked=h();domainEditClicked=h();pageChanged=h();searchText=u("");selectedDaysFilter=u(null);daysFilterOptions=[{label:"Todos",value:null},{label:"< 7 d\xEDas",value:7},{label:"< 15 d\xEDas",value:15},{label:"< 30 d\xEDas",value:30},{label:"< 60 d\xEDas",value:60},{label:"< 90 d\xEDas",value:90}];filteredDomains=I(()=>{let e=this.domains(),t=this.searchText().toLowerCase();t&&(e=e.filter(l=>l.domainName?.toLowerCase().includes(t)));let o=this.selectedDaysFilter();if(o!==null){let l=new Date;l.setDate(l.getDate()+o),e=e.filter(s=>{let F=this.toDate(s.expiresAt);return F&&F<=l})}return e});onSearch(e){let t=e.target.value;this.searchText.set(t)}onDaysFilterChange(e){this.selectedDaysFilter.set(e)}onDomainClick(e){this.domainClicked.emit(e)}getPrivacyLockSeverity(e){return e?"success":"secondary"}formatNameservers(e){return!e||e.length===0?"N/A":e.join(", ")}onEditDomain(e,t){t.stopPropagation(),this.domainEditClicked.emit(e)}toDate(e){return e?e instanceof Date?e:typeof e=="string"?new Date(e):typeof e=="object"&&"toDate"in e?e.toDate():typeof e=="object"&&"seconds"in e?new Date(e.seconds*1e3):null:null}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=x({type:a,selectors:[["app-domains-table"]],inputs:{domains:[1,"domains"],isLoading:[1,"isLoading"],totalRecords:[1,"totalRecords"]},outputs:{domainClicked:"domainClicked",domainEditClicked:"domainEditClicked",pageChanged:"pageChanged"},decls:13,vars:14,consts:[[1,"domains-table-container"],[1,"table-toolbar"],["iconPosition","left",1,"search-field"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar dominio...",3,"input","value"],["optionLabel","label","optionValue","value","placeholder","Filtrar por d\xEDas",1,"days-filter",3,"ngModelChange","options","ngModel"],[1,"results-count"],["currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} dominios","scrollHeight","600px","responsiveLayout","scroll",1,"domains-table",3,"value","loading","paginator","rows","showCurrentPageReport","rowsPerPageOptions","virtualScroll","virtualScrollItemSize"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[2,"width","80px"],["pSortableColumn","domain"],["field","domain"],["pSortableColumn","expiresAt",2,"width","180px"],["field","expiresAt"],[2,"width","250px"],[1,"text-center",2,"width","100px"],[1,"text-center",2,"width","120px"],[1,"domain-row"],[1,"semaphore-cell"],[3,"expiresAt"],[1,"domain-name"],[1,"expiration-date"],[1,"nameservers-cell"],[1,"nameservers-text",3,"title"],[1,"text-center"],[3,"value","severity"],[1,"text-center","action-buttons"],["icon","pi pi-pencil","size","small","severity","secondary","tooltipPosition","top",3,"onClick","text","pTooltip"],["icon","pi pi-eye","size","small","tooltipPosition","top",3,"onClick","text","pTooltip"],["colspan","7",1,"empty-state"],[1,"loading-state"],[1,"no-data"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2rem"],[1,"pi","pi-inbox",2,"font-size","3rem","color","var(--text-color-secondary)"],[1,"hint"]],template:function(t,o){t&1&&(i(0,"div",0)(1,"div",1)(2,"p-iconfield",2),c(3,"p-inputicon",3),i(4,"input",4),p("input",function(s){return o.onSearch(s)}),n()(),i(5,"p-select",5),me("ngModelChange",function(s){return de(o.selectedDaysFilter,s)||(o.selectedDaysFilter=s),s}),p("ngModelChange",function(s){return o.onDaysFilterChange(s)}),n(),i(6,"div",6)(7,"span"),d(8),n()()(),i(9,"p-table",7),E(10,lt,17,0,"ng-template",8)(11,dt,20,16,"ng-template",9)(12,pt,4,1,"ng-template",10),n()()),t&2&&(r(4),m("value",o.searchText()),r(),m("options",o.daysFilterOptions),le("ngModel",o.selectedDaysFilter),r(3),re("",o.filteredDomains().length," de ",o.totalRecords()," dominios"),r(),m("value",o.filteredDomains())("loading",o.isLoading())("paginator",!0)("rows",20)("showCurrentPageReport",!0)("rowsPerPageOptions",O(13,rt))("virtualScroll",o.filteredDomains().length>50)("virtualScrollItemSize",60))},dependencies:[Oe,V,xe,qe,Ge,k,We,Je,H,B,w,P,Re,Fe,U,j,ke,Te,Ie,Ne,he,be,J,L],styles:[".domains-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.table-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex-wrap:wrap;padding:1rem;background:#fff;border-radius:8px;box-shadow:0 1px 3px #00000014}.table-toolbar[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{flex:1;min-width:250px}.table-toolbar[_ngcontent-%COMP%]   .days-filter[_ngcontent-%COMP%]{min-width:180px}.table-toolbar[_ngcontent-%COMP%]   .results-count[_ngcontent-%COMP%]{margin-left:auto;font-size:.9rem;color:var(--text-color-secondary);font-weight:500}@media(max-width:768px){.table-toolbar[_ngcontent-%COMP%]   .results-count[_ngcontent-%COMP%]{margin-left:0;width:100%;text-align:center}}.domains-table[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 1px 3px #00000014}.domains-table[_ngcontent-%COMP%]     .p-datatable-header{background:#f9fafb;border-bottom:2px solid #e5e7eb}.domains-table[_ngcontent-%COMP%]     .p-datatable-thead>tr>th{background:#f9fafb;color:#374151;font-weight:600;border-bottom:2px solid #e5e7eb}.domains-table[_ngcontent-%COMP%]     .p-datatable-tbody>tr{transition:background-color .2s ease}.domains-table[_ngcontent-%COMP%]     .p-datatable-tbody>tr:hover{background-color:#f9fafb}.domains-table[_ngcontent-%COMP%]     .p-paginator .p-select{z-index:100}.domains-table[_ngcontent-%COMP%]     .p-paginator .p-select-overlay{z-index:100!important}.domain-row[_ngcontent-%COMP%]   .semaphore-cell[_ngcontent-%COMP%]{text-align:center}.domain-row[_ngcontent-%COMP%]   .domain-name[_ngcontent-%COMP%]{font-weight:600;color:var(--primary-color)}.domain-row[_ngcontent-%COMP%]   .expiration-date[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-color-secondary)}.domain-row[_ngcontent-%COMP%]   .nameservers-cell[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-color-secondary)}.domain-row[_ngcontent-%COMP%]   .nameservers-text[_ngcontent-%COMP%]{display:inline-block;max-width:240px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.loading-state[_ngcontent-%COMP%], .no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--text-color-secondary)}.loading-state[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%], .no-data[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-size:.9rem;font-style:italic}@media(max-width:768px){.table-toolbar[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%], .table-toolbar[_ngcontent-%COMP%]   .days-filter[_ngcontent-%COMP%]{width:100%;min-width:auto}}"],changeDetection:0})};var ut=()=>({width:"700px",maxWidth:"95vw"}),ft=()=>["0"];function vt(a,e){if(a&1&&(i(0,"div",6)(1,"label",7),d(2,"Fecha de Creaci\xF3n"),n(),i(3,"div",8),d(4),M(5,"date"),n()()),a&2){let t=g(2);r(4),S(" ",N(5,1,t.domain().createdAt.toDate(),"dd/MM/yyyy HH:mm")," ")}}function _t(a,e){if(a&1&&(i(0,"li",22),c(1,"i",23),i(2,"code"),d(3),n()()),a&2){let t=e.$implicit;r(3),b(t)}}function Ct(a,e){if(a&1&&(i(0,"ul",13),oe(1,_t,4,1,"li",22,ne),n()),a&2){let t=g(2);r(),ae(t.domain().nameservers)}}function bt(a,e){a&1&&(i(0,"p",14),d(1,"No hay nameservers configurados"),n())}function ht(a,e){if(a&1){let t=T();i(0,"p-button",24),p("onClick",function(){D(t);let l=g(2);return y(l.onClose())}),n()}}function Dt(a,e){if(a&1&&(i(0,"div",1)(1,"div",2)(2,"div",3),c(3,"app-expiration-semaphore",4),i(4,"h2"),d(5),n()()(),c(6,"p-divider"),i(7,"div",5)(8,"div",6)(9,"label",7),d(10,"Fecha de Vencimiento"),n(),i(11,"div",8)(12,"strong"),d(13),M(14,"date"),n()()(),_(15,vt,6,4,"div",6),i(16,"div",6)(17,"label",7),d(18,"Domain Lock"),n(),i(19,"div",8),c(20,"p-tag",9),n()(),i(21,"div",6)(22,"label",7),d(23,"Privacidad WHOIS"),n(),i(24,"div",8),c(25,"p-tag",9),n()()(),c(26,"p-divider"),i(27,"div",10)(28,"h3",11),c(29,"i",12),d(30," Nameservers "),n(),_(31,Ct,3,0,"ul",13)(32,bt,2,0,"p",14),n(),c(33,"p-divider"),i(34,"div",15)(35,"p-accordion",16)(36,"p-accordionpanel",17)(37,"p-accordionheader")(38,"div",18),c(39,"i",19),i(40,"span"),d(41,"Datos Raw (JSON)"),n()()(),i(42,"p-accordioncontent")(43,"pre",20),d(44),M(45,"json"),n()()()()()(),E(46,ht,1,0,"ng-template",21)),a&2){let t=g();r(3),m("expiresAt",t.domain().expiresAt),r(2),b(t.domain().domainName),r(8),b(N(14,11,t.domain().expiresAt.toDate(),"dd/MM/yyyy HH:mm")),r(2),C(t.domain().createdAt?15:-1),r(5),m("value",t.domain().domainLock?"Activado":"Desactivado")("severity",t.getTagSeverity(t.domain().domainLock||!1)),r(5),m("value",t.domain().privacyProtection?"Activada":"Desactivada")("severity",t.getTagSeverity(t.domain().privacyProtection||!1)),r(6),C(t.domain().nameservers&&t.domain().nameservers.length>0?31:32),r(4),m("value",O(16,ft)),r(9),b(ce(45,14,t.domain()))}}var X=class a{domain=f.required();visible=f.required();visibleChange=h();showRawData=u(!1);onClose(){this.visibleChange.emit(!1)}toggleRawData(){this.showRawData.update(e=>!e)}getTagSeverity(e){return e?"success":"secondary"}formatNameservers(e){return!e||e.length===0?"N/A":e.join(`
`)}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=x({type:a,selectors:[["app-domain-details-dialog"]],inputs:{domain:[1,"domain"],visible:[1,"visible"]},outputs:{visibleChange:"visibleChange"},decls:2,vars:8,consts:[[1,"domain-details-dialog",3,"visibleChange","header","visible","modal","dismissableMask"],[1,"dialog-content"],[1,"domain-header"],[1,"domain-title"],[3,"expiresAt"],[1,"details-grid"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"],[3,"value","severity"],[1,"nameservers-section"],[1,"section-title"],[1,"pi","pi-server"],[1,"nameservers-list"],[1,"no-data"],[1,"raw-data-section"],[3,"value"],["value","0"],[1,"accordion-header"],[1,"pi","pi-code"],[1,"raw-data-content"],["pTemplate","footer"],[1,"nameserver-item"],[1,"pi","pi-angle-right"],["label","Cerrar","icon","pi pi-times","severity","secondary",3,"onClick"]],template:function(t,o){t&1&&(i(0,"p-dialog",0),p("visibleChange",function(){return o.onClose()}),_(1,Dt,47,17),n()),t&2&&(R(O(7,ut)),m("header","Detalles del Dominio")("visible",o.visible())("modal",!0)("dismissableMask",!0),r(),C(o.domain()?1:-1))},dependencies:[G,$,k,w,P,U,j,Ye,Xe,et,Ke,Ze,Qe,J,L,ue],styles:[".dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.domain-header[_ngcontent-%COMP%]   .domain-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.domain-header[_ngcontent-%COMP%]   .domain-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;color:var(--primary-color);font-weight:700}.details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}@media(max-width:576px){.details-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}}.detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.detail-item[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:var(--text-color-secondary);text-transform:uppercase;letter-spacing:.5px}.detail-item[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-size:1rem;color:var(--text-color)}.nameservers-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0 0 1rem;font-size:1.1rem;font-weight:600;color:var(--text-color)}.nameservers-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary-color)}.nameservers-section[_ngcontent-%COMP%]   .nameservers-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:.5rem}.nameservers-section[_ngcontent-%COMP%]   .nameserver-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;background:#f9fafb;border-radius:6px;border:1px solid #e5e7eb}.nameservers-section[_ngcontent-%COMP%]   .nameserver-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary-color);font-size:.85rem}.nameservers-section[_ngcontent-%COMP%]   .nameserver-item[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-size:.9rem;color:#374151}.nameservers-section[_ngcontent-%COMP%]   .no-data[_ngcontent-%COMP%]{color:var(--text-color-secondary);font-style:italic;margin:0}.raw-data-section[_ngcontent-%COMP%]     .p-accordion .p-accordion-header .accordion-header{display:flex;align-items:center;gap:.5rem;font-weight:600}.raw-data-section[_ngcontent-%COMP%]     .p-accordion .p-accordion-header .accordion-header i{color:var(--primary-color)}.raw-data-section[_ngcontent-%COMP%]     .p-accordion .p-accordion-content{padding:0}.raw-data-section[_ngcontent-%COMP%]   .raw-data-content[_ngcontent-%COMP%]{background:#1e293b;color:#e2e8f0;padding:1.5rem;margin:0;border-radius:6px;font-family:Courier New,monospace;font-size:.85rem;line-height:1.6;overflow-x:auto;max-height:400px}.raw-data-section[_ngcontent-%COMP%]   .raw-data-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.raw-data-section[_ngcontent-%COMP%]   .raw-data-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0f172a;border-radius:4px}.raw-data-section[_ngcontent-%COMP%]   .raw-data-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#475569;border-radius:4px}.raw-data-section[_ngcontent-%COMP%]   .raw-data-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#64748b}  .domain-details-dialog .p-dialog-header{background:linear-gradient(135deg,#475569,#334155);color:#fff;border-top-left-radius:8px;border-top-right-radius:8px}  .domain-details-dialog .p-dialog-header .p-dialog-title{font-weight:700}  .domain-details-dialog .p-dialog-header .p-dialog-header-icon{color:#fff}  .domain-details-dialog .p-dialog-header .p-dialog-header-icon:hover{background-color:#ffffff1a}  .domain-details-dialog .p-divider{margin:1rem 0}"],changeDetection:0})};function yt(a){let e=a,t=Math.floor(Math.abs(a)),o=a.toString().replace(/^[^.]*\.?/,"").length,l=parseInt(a.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return e===1?1:l===0&&t!==0&&t%1e6===0&&o===0||!(l>=0&&l<=5)?4:5}var it=["es",[["a.\u202Fm.","p.\u202Fm."],void 0,["a.\xA0m.","p.\xA0m."]],void 0,[["D","L","M","X","J","V","S"],["dom","lun","mar","mi\xE9","jue","vie","s\xE1b"],["domingo","lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado"],["DO","LU","MA","MI","JU","VI","SA"]],void 0,[["E","F","M","A","M","J","J","A","S","O","N","D"],["ene","feb","mar","abr","may","jun","jul","ago","sept","oct","nov","dic"],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]],void 0,[["a. C.","d. C."],void 0,["antes de Cristo","despu\xE9s de Cristo"]],1,[6,0],["d/M/yy","d MMM y","d 'de' MMMM 'de' y","EEEE, d 'de' MMMM 'de' y"],["H:mm","H:mm:ss","H:mm:ss z","H:mm:ss (zzzz)"],["{1}, {0}",void 0,void 0,void 0],[",",".",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0\xA0%","#,##0.00\xA0\xA4","#E0"],"EUR","\u20AC","euro",{AUD:[void 0,"$"],BRL:[void 0,"R$"],BYN:[void 0,"\u0440."],CAD:[void 0,"$"],CNY:[void 0,"\xA5"],EGP:[void 0,"EGP"],ESP:["\u20A7"],GBP:[void 0,"\xA3"],HKD:[void 0,"$"],ILS:[void 0,"\u20AA"],INR:[void 0,"\u20B9"],JPY:[void 0,"\xA5"],KRW:[void 0,"\u20A9"],MXN:[void 0,"$"],NZD:[void 0,"$"],PHP:[void 0,"\u20B1"],RON:[void 0,"L"],THB:["\u0E3F"],TWD:[void 0,"NT$"],USD:["US$","$"],XAF:[],XCD:[void 0,"$"],XOF:[]},"ltr",yt];var xt=()=>({width:"600px"}),Mt=a=>[a,"COP","symbol","1.0-0","es"];function Pt(a,e){a&1&&(i(0,"small",5),d(1,"Ingresa un email v\xE1lido"),n())}function wt(a,e){if(a&1){let t=T();i(0,"p-button",13),p("onClick",function(){D(t);let l=g();return y(l.onClose())}),n(),i(1,"p-button",14),p("onClick",function(){D(t);let l=g();return y(l.onSave())}),n()}if(a&2){let t=g();m("disabled",t.isSaving()),r(),m("loading",t.isSaving())("disabled",t.editForm.invalid)}}ve(it);var Y=class a{fb=v(Se);domainService=v(W);domain=f.required();visible=f.required();visibleChange=h();domainUpdated=h();isSaving=u(!1);totalPrice=u(0);editForm=this.fb.group({contactEmail:["",[z.email]],hostingRenewalPrice:[0,[z.min(0)]],domainRenewalPrice:[0,[z.min(0)]]});constructor(){ie(()=>{let e=this.domain();e&&(this.editForm.patchValue({contactEmail:e.contactEmail||"",hostingRenewalPrice:e.hostingRenewalPrice||0,domainRenewalPrice:e.domainRenewalPrice||0}),this.updateTotalPrice())}),this.editForm.valueChanges.subscribe(()=>{this.updateTotalPrice()})}updateTotalPrice(){let e=this.editForm.value.hostingRenewalPrice||0,t=this.editForm.value.domainRenewalPrice||0;this.totalPrice.set(e+t)}async onSave(){let e=this.domain();if(!(!e||this.editForm.invalid)){this.isSaving.set(!0);try{let t={contactEmail:this.editForm.value.contactEmail||void 0,hostingRenewalPrice:this.editForm.value.hostingRenewalPrice||void 0,domainRenewalPrice:this.editForm.value.domainRenewalPrice||void 0};await this.domainService.updateDomain(e.id,t),this.domainUpdated.emit(),this.onClose()}catch(t){console.error("Error updating domain:",t)}finally{this.isSaving.set(!1)}}}onClose(){this.editForm.reset(),this.visibleChange.emit(!1)}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=x({type:a,selectors:[["app-domain-edit-dialog"]],inputs:{domain:[1,"domain"],visible:[1,"visible"]},outputs:{visibleChange:"visibleChange",domainUpdated:"domainUpdated"},features:[A([{provide:ge,useValue:"es"}])],decls:22,vars:21,consts:[[3,"visibleChange","header","visible","modal","draggable","resizable"],[3,"ngSubmit","formGroup"],[1,"field"],["for","contactEmail"],["pInputText","","id","contactEmail","formControlName","contactEmail","type","email","placeholder","cliente@ejemplo.com",1,"w-full"],[1,"p-error"],["for","hostingPrice"],["inputId","hostingPrice","formControlName","hostingRenewalPrice","mode","currency","currency","COP","locale","es",1,"w-full",3,"min"],["for","domainPrice"],["inputId","domainPrice","formControlName","domainRenewalPrice","mode","currency","currency","COP","locale","es",1,"w-full",3,"min"],[1,"total-price"],[1,"price"],["pTemplate","footer"],["label","Cancelar","icon","pi pi-times","severity","secondary",3,"onClick","disabled"],["label","Guardar","icon","pi pi-check",3,"onClick","loading","disabled"]],template:function(t,o){if(t&1&&(i(0,"p-dialog",0),p("visibleChange",function(s){return o.visibleChange.emit(s)}),i(1,"form",1),p("ngSubmit",function(){return o.onSave()}),i(2,"div",2)(3,"label",3),d(4,"Email de Contacto"),n(),c(5,"input",4),_(6,Pt,2,0,"small",5),n(),i(7,"div",2)(8,"label",6),d(9,"Precio Renovaci\xF3n Hosting (COP)"),n(),c(10,"p-inputNumber",7),n(),i(11,"div",2)(12,"label",8),d(13,"Precio Renovaci\xF3n Dominio (COP)"),n(),c(14,"p-inputNumber",9),n(),i(15,"div",10)(16,"strong"),d(17,"Total Renovaci\xF3n:"),n(),i(18,"span",11),d(19),M(20,"currency"),n()()(),E(21,wt,2,3,"ng-template",12),n()),t&2){let l,s;R(O(18,xt)),m("header","Editar Dominio - "+(((l=o.domain())==null?null:l.domainName)||""))("visible",o.visible())("modal",!0)("draggable",!1)("resizable",!1),r(),m("formGroup",o.editForm),r(5),C((s=o.editForm.get("contactEmail"))!=null&&s.invalid&&((s=o.editForm.get("contactEmail"))!=null&&s.touched)?6:-1),r(4),m("min",0),r(4),m("min",0),r(5),b(pe(20,12,se(19,Mt,o.totalPrice())))}},dependencies:[Ee,Me,De,V,ye,we,Pe,G,$,k,w,P,H,B,$e,Ue,fe],styles:[".field[_ngcontent-%COMP%]{margin-bottom:1.5rem}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:var(--text-color)}.field[_ngcontent-%COMP%]   small.p-error[_ngcontent-%COMP%]{display:block;margin-top:.25rem;color:var(--red-500)}.total-price[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background:var(--surface-100);border-radius:var(--border-radius);margin-top:1rem}.total-price[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:1.1rem;color:var(--text-color)}.total-price[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:700;color:var(--primary-color)}"],changeDetection:0})};var te=class a{domainService=v(W);workspaceContext=v(Ce);exportService=v(je);route=v(_e);messageService=v(K);domains=u([]);isLoading=this.domainService.isLoading;error=this.domainService.error;selectedDomain=u(null);showDetailsDialog=u(!1);showEditDialog=u(!1);workspaceName=I(()=>this.workspaceContext.getCurrentWorkspace()?.name||"Workspace");totalDomains=I(()=>this.domains().length);ngOnInit(){this.loadDomains()}async loadDomains(){try{let e=this.route.snapshot.paramMap.get("workspaceId");if(!e)throw new Error("No se encontr\xF3 el ID del workspace");let t=await this.domainService.getAllDomains(e);this.domains.set(t),t.length===0&&this.messageService.add({severity:"info",summary:"Sin dominios",detail:"No se encontraron dominios para este workspace. Aseg\xFArate de haber ejecutado la sincronizaci\xF3n.",life:5e3})}catch(e){console.error("[DomainsPage] Error loading domains:",e);let t=e instanceof Error?e.message:"Error al cargar dominios";e instanceof Error&&e.message.includes("index")&&(t="El \xEDndice de Firestore est\xE1 construy\xE9ndose. Espera unos minutos y recarga la p\xE1gina."),this.messageService.add({severity:"error",summary:"Error",detail:t})}}onDomainClicked(e){this.selectedDomain.set(e),this.showDetailsDialog.set(!0)}onDialogVisibilityChange(e){this.showDetailsDialog.set(e),e||this.selectedDomain.set(null)}onEditDomain(e){this.selectedDomain.set(e),this.showEditDialog.set(!0)}onEditDialogVisibilityChange(e){this.showEditDialog.set(e),e||this.selectedDomain.set(null)}exportToCSV(){let e=this.domains();if(e.length===0){this.messageService.add({severity:"warn",summary:"Sin datos",detail:"No hay dominios para exportar",life:3e3});return}let t=e.map(l=>({Dominio:l.domainName,Workspace:this.workspaceName(),"Fecha de Vencimiento":this.formatDate(l.expiresAt),Estado:this.domainService.getExpirationStatus(l.expiresAt)})),o=`dominios-${this.workspaceName().replace(/\s+/g,"-").toLowerCase()}-${new Date().toISOString().split("T")[0]}.csv`;this.exportService.exportToCSV(t,o),this.messageService.add({severity:"success",summary:"Exportado",detail:`Datos exportados a ${o}`,life:3e3})}formatDate(e){return e?e instanceof Date?e.toLocaleDateString():typeof e=="object"&&"toDate"in e?e.toDate().toLocaleDateString():String(e):""}onDomainUpdated(){this.messageService.add({severity:"success",summary:"Dominio actualizado",detail:"Los cambios se guardaron correctamente"}),this.loadDomains()}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=x({type:a,selectors:[["app-domains"]],features:[A([K])],decls:15,vars:11,consts:[["role","main","aria-labelledby","domains-heading",1,"domains-page"],["role","banner",1,"page-header"],[1,"header-content"],["id","domains-heading",1,"page-title"],["aria-hidden","true",1,"pi","pi-globe"],[1,"page-subtitle"],[1,"header-actions"],["label","Exportar CSV","icon","pi pi-download","severity","secondary",3,"onClick","outlined","disabled"],[3,"domainClicked","domainEditClicked","domains","isLoading","totalRecords"],[3,"visibleChange","domain","visible"],[3,"visibleChange","domainUpdated","domain","visible"]],template:function(t,o){t&1&&(i(0,"div",0),c(1,"p-toast"),i(2,"div",1)(3,"div",2)(4,"h1",3),c(5,"i",4),d(6),n(),i(7,"p",5),d(8,"Gestiona y monitorea los dominios de este workspace"),n()(),i(9,"div",6)(10,"p-button",7),p("onClick",function(){return o.exportToCSV()}),n()()(),i(11,"p-card")(12,"app-domains-table",8),p("domainClicked",function(s){return o.onDomainClicked(s)})("domainEditClicked",function(s){return o.onEditDomain(s)}),n()(),i(13,"app-domain-details-dialog",9),p("visibleChange",function(s){return o.onDialogVisibilityChange(s)}),n(),i(14,"app-domain-edit-dialog",10),p("visibleChange",function(s){return o.onEditDialogVisibilityChange(s)})("domainUpdated",function(){return o.onDomainUpdated()}),n()()),t&2&&(m("@fadeIn",void 0),r(6),S(" Dominios - ",o.workspaceName()," "),r(4),m("outlined",!0)("disabled",o.totalDomains()===0),r(2),m("domains",o.domains())("isLoading",o.isLoading())("totalRecords",o.totalDomains()),r(),m("domain",o.selectedDomain())("visible",o.showDetailsDialog()),r(),m("domain",o.selectedDomain())("visible",o.showEditDialog()))},dependencies:[Ve,ze,He,Be,q,X,Y,w,P],styles:[".domains-page[_ngcontent-%COMP%]{min-height:100vh;background-color:#f9fafb;padding:2rem}.domains-page.ng-animating[_ngcontent-%COMP%]{overflow:hidden}@media(max-width:768px){.domains-page[_ngcontent-%COMP%]{padding:1rem}}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem;animation:_ngcontent-%COMP%_slideDown .3s ease-out}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin:0 0 .5rem;font-size:1.75rem;font-weight:700;color:#1f2937}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#64748b}@media(max-width:768px){.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:1.5rem}}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{color:var(--text-color-secondary);margin:0}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:1rem}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}"],data:{animation:[Ae,Le]},changeDetection:0})};export{te as default};
