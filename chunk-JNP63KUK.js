import{Ba as So,G as hi,H as Ao,I as _h,Qa as Ih,Sa as Ro,Ta as Co,Za as fi,_a as Eh,cb as wh,ia as yh,la as di,m as gh,pa as bo}from"./chunk-WQRABBEY.js";import{$ as sh,Ac as vo,Cc as _e,Db as dh,Dc as z,Nc as To,P as rh,Pb as fh,Q as ih,Qb as ph,S as Eo,U as cr,a as H,ac as mh,b as xe,bb as li,cb as ah,d as Io,db as ch,fb as uh,gb as ur,ja as oh,jc as wo,ma as ci,pa as ui,rb as lh,sb as hh}from"./chunk-XTNRL3Y3.js";var vh=()=>{};var bh=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},cg=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],u=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Sh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,u=a?n[i+1]:0,l=i+2<n.length,d=l?n[i+2]:0,p=s>>2,m=(s&3)<<4|u>>4,_=(u&15)<<2|d>>6,S=d&63;l||(S=64,a||(_=64)),r.push(t[p],t[m],t[_],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(bh(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):cg(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||d==null||m==null)throw new No;let _=s<<2|u>>4;if(r.push(_),d!==64){let S=u<<4&240|d>>2;if(r.push(S),m!==64){let P=d<<6&192|m;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},No=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},ug=function(n){let e=bh(n);return Sh.encodeByteArray(e,!0)},hr=function(n){return ug(n).replace(/\./g,"")},mi=function(n){try{return Sh.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Rh(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var lg=()=>Rh().__FIREBASE_DEFAULTS__,hg=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},dg=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&mi(n[1]);return e&&JSON.parse(e)},gi=()=>{try{return vh()||lg()||hg()||dg()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ko=n=>gi()?.emulatorHosts?.[n],_i=n=>{let e=ko(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Oo=()=>gi()?.config,Vo=n=>gi()?.[`_${n}`];var pi=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Le(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dn(n){return(await fetch(n,{credentials:"include"})).ok}function Ch(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=H({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[hr(JSON.stringify(t)),hr(JSON.stringify(a)),""].join(".")}var lr={};function fg(){let n={prod:[],emulator:[]};for(let e of Object.keys(lr))lr[e]?n.emulator.push(e):n.prod.push(e);return n}function pg(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var Th=!1;function fn(n,e){if(typeof window>"u"||typeof document>"u"||!Le(window.location.host)||lr[n]===e||lr[n]||Th)return;lr[n]=e;function t(_){return`__firebase__banner__${_}`}let r="__firebase__banner",s=fg().prod.length>0;function a(){let _=document.getElementById(r);_&&_.remove()}function u(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function l(_,S){_.setAttribute("width","24"),_.setAttribute("id",S),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function d(){let _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Th=!0,a()},_}function p(_,S){_.setAttribute("id",S),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function m(){let _=pg(r),S=t("text"),P=document.getElementById(S)||document.createElement("span"),O=t("learnmore"),N=document.getElementById(O)||document.createElement("a"),B=t("preprendIcon"),$=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){let Q=_.element;u(Q),p(N,O);let me=d();l($,B),Q.append($,P,N,me),document.body.appendChild(Q)}s?(P.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function de(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ph(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(de())}function mg(){let n=gi()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Nh(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Dh(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function kh(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Oh(){let n=de();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Vh(){return!mg()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xo(){try{return typeof indexedDB=="object"}catch{return!1}}function xh(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var gg="FirebaseError",Ae=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=gg,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xe.prototype.create)}},Xe=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?_g(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new Ae(i,u,r)}};function _g(n,e){return n.replace(yg,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var yg=/\{\$([^}]+)}/g;function Lh(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ze(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(Ah(s)&&Ah(a)){if(!ze(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Ah(n){return n!==null&&typeof n=="object"}function dr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function pn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function mn(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Mh(n,e){let t=new Do(n,e);return t.subscribe.bind(t)}var Do=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Ig(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Po),i.error===void 0&&(i.error=Po),i.complete===void 0&&(i.complete=Po);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Ig(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Po(){}var dv=14400*1e3;function X(n){return n&&n._delegate?n._delegate:n}var Re=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var jt="[DEFAULT]";var Lo=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new pi;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wg(e))try{this.getOrInitializeService({instanceIdentifier:jt})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=jt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=jt){return this.instances.has(e)}getOptions(e=jt){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Eg(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=jt){return this.component?this.component.multipleInstances?e:jt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Eg(n){return n===jt?void 0:n}function wg(n){return n.instantiationMode==="EAGER"}var yi=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Lo(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var vg=[],j=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(j||{}),Tg={debug:j.DEBUG,verbose:j.VERBOSE,info:j.INFO,warn:j.WARN,error:j.ERROR,silent:j.SILENT},Ag=j.INFO,bg={[j.DEBUG]:"log",[j.VERBOSE]:"log",[j.INFO]:"info",[j.WARN]:"warn",[j.ERROR]:"error"},Sg=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=bg[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Et=class{constructor(e){this.name=e,this._logLevel=Ag,this._logHandler=Sg,this._userLogHandler=null,vg.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in j))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Tg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,j.DEBUG,...e),this._logHandler(this,j.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,j.VERBOSE,...e),this._logHandler(this,j.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,j.INFO,...e),this._logHandler(this,j.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,j.WARN,...e),this._logHandler(this,j.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,j.ERROR,...e),this._logHandler(this,j.ERROR,...e)}};var Rg=(n,e)=>e.some(t=>n instanceof t),Fh,Uh;function Cg(){return Fh||(Fh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Pg(){return Uh||(Uh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Bh=new WeakMap,Fo=new WeakMap,qh=new WeakMap,Mo=new WeakMap,Bo=new WeakMap;function Ng(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(je(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Bh.set(t,n)}).catch(()=>{}),Bo.set(e,n),e}function Dg(n){if(Fo.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});Fo.set(n,e)}var Uo={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Fo.get(n);if(e==="objectStoreNames")return n.objectStoreNames||qh.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return je(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function zh(n){Uo=n(Uo)}function kg(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Ii(this),e,...t);return qh.set(r,e.sort?e.sort():[e]),je(r)}:Pg().includes(n)?function(...e){return n.apply(Ii(this),e),je(Bh.get(this))}:function(...e){return je(n.apply(Ii(this),e))}}function Og(n){return typeof n=="function"?kg(n):(n instanceof IDBTransaction&&Dg(n),Rg(n,Cg())?new Proxy(n,Uo):n)}function je(n){if(n instanceof IDBRequest)return Ng(n);if(Mo.has(n))return Mo.get(n);let e=Og(n);return e!==n&&(Mo.set(n,e),Bo.set(e,n)),e}var Ii=n=>Bo.get(n);function $h(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),u=je(a);return r&&a.addEventListener("upgradeneeded",l=>{r(je(a.result),l.oldVersion,l.newVersion,je(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),u.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var Vg=["get","getKey","getAll","getAllKeys","count"],xg=["put","add","delete","clear"],qo=new Map;function jh(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(qo.get(e))return qo.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=xg.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Vg.includes(t)))return;let s=async function(a,...u){let l=this.transaction(a,i?"readwrite":"readonly"),d=l.store;return r&&(d=d.index(u.shift())),(await Promise.all([d[t](...u),i&&l.done]))[0]};return qo.set(e,s),s}zh(n=>xe(H({},n),{get:(e,t,r)=>jh(e,t)||n.get(e,t,r),has:(e,t)=>!!jh(e,t)||n.has(e,t)}));var jo=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Lg(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Lg(n){return n.getComponent()?.type==="VERSION"}var $o="@firebase/app",Gh="0.14.6";var Ze=new Et("@firebase/app"),Mg="@firebase/app-compat",Fg="@firebase/analytics-compat",Ug="@firebase/analytics",Bg="@firebase/app-check-compat",qg="@firebase/app-check",zg="@firebase/auth",jg="@firebase/auth-compat",$g="@firebase/database",Gg="@firebase/data-connect",Kg="@firebase/database-compat",Hg="@firebase/functions",Wg="@firebase/functions-compat",Qg="@firebase/installations",Jg="@firebase/installations-compat",Yg="@firebase/messaging",Xg="@firebase/messaging-compat",Zg="@firebase/performance",e_="@firebase/performance-compat",t_="@firebase/remote-config",n_="@firebase/remote-config-compat",r_="@firebase/storage",i_="@firebase/storage-compat",s_="@firebase/firestore",o_="@firebase/ai",a_="@firebase/firestore-compat",c_="firebase",u_="12.6.0";var Go="[DEFAULT]",l_={[$o]:"fire-core",[Mg]:"fire-core-compat",[Ug]:"fire-analytics",[Fg]:"fire-analytics-compat",[qg]:"fire-app-check",[Bg]:"fire-app-check-compat",[zg]:"fire-auth",[jg]:"fire-auth-compat",[$g]:"fire-rtdb",[Gg]:"fire-data-connect",[Kg]:"fire-rtdb-compat",[Hg]:"fire-fn",[Wg]:"fire-fn-compat",[Qg]:"fire-iid",[Jg]:"fire-iid-compat",[Yg]:"fire-fcm",[Xg]:"fire-fcm-compat",[Zg]:"fire-perf",[e_]:"fire-perf-compat",[t_]:"fire-rc",[n_]:"fire-rc-compat",[r_]:"fire-gcs",[i_]:"fire-gcs-compat",[s_]:"fire-fst",[a_]:"fire-fst-compat",[o_]:"fire-vertex","fire-js":"fire-js",[c_]:"fire-js-all"};var Ei=new Map,h_=new Map,Ko=new Map;function Kh(n,e){try{n.container.addComponent(e)}catch(t){Ze.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function $e(n){let e=n.name;if(Ko.has(e))return Ze.debug(`There were multiple attempts to register component ${e}.`),!1;Ko.set(e,n);for(let t of Ei.values())Kh(t,n);for(let t of h_.values())Kh(t,n);return!0}function $t(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function be(n){return n==null?!1:n.settings!==void 0}var d_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wt=new Xe("app","Firebase",d_);var Ho=class{constructor(e,t,r){this._isDeleted=!1,this._options=H({},e),this._config=H({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Re("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wt.create("app-deleted",{appName:this._name})}};var vt=u_;function Jo(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=H({name:Go,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw wt.create("bad-app-name",{appName:String(i)});if(t||(t=Oo()),!t)throw wt.create("no-options");let s=Ei.get(i);if(s){if(ze(t,s.options)&&ze(r,s.config))return s;throw wt.create("duplicate-app",{appName:i})}let a=new yi(i);for(let l of Ko.values())a.addComponent(l);let u=new Ho(t,r,a);return Ei.set(i,u),u}function gn(n=Go){let e=Ei.get(n);if(!e&&n===Go&&Oo())return Jo();if(!e)throw wt.create("no-app",{appName:n});return e}function Ce(n,e,t){let r=l_[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){let a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ze.warn(a.join(" "));return}$e(new Re(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var f_="firebase-heartbeat-database",p_=1,fr="firebase-heartbeat-store",zo=null;function Jh(){return zo||(zo=$h(f_,p_,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(fr)}catch(t){console.warn(t)}}}}).catch(n=>{throw wt.create("idb-open",{originalErrorMessage:n.message})})),zo}async function m_(n){try{let t=(await Jh()).transaction(fr),r=await t.objectStore(fr).get(Yh(n));return await t.done,r}catch(e){if(e instanceof Ae)Ze.warn(e.message);else{let t=wt.create("idb-get",{originalErrorMessage:e?.message});Ze.warn(t.message)}}}async function Hh(n,e){try{let r=(await Jh()).transaction(fr,"readwrite");await r.objectStore(fr).put(e,Yh(n)),await r.done}catch(t){if(t instanceof Ae)Ze.warn(t.message);else{let r=wt.create("idb-set",{originalErrorMessage:t?.message});Ze.warn(r.message)}}}function Yh(n){return`${n.name}!${n.options.appId}`}var g_=1024,__=30,Wo=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Qo(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Wh();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>__){let i=I_(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ze.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=Wh(),{heartbeatsToSend:t,unsentEntries:r}=y_(this._heartbeatsCache.heartbeats),i=hr(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ze.warn(e),""}}};function Wh(){return new Date().toISOString().substring(0,10)}function y_(n,e=g_){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Qh(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Qh(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Qo=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xo()?xh().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await m_(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return Hh(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return Hh(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function Qh(n){return hr(JSON.stringify({version:2,heartbeats:n})).length}function I_(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function E_(n){$e(new Re("platform-logger",e=>new jo(e),"PRIVATE")),$e(new Re("heartbeat",e=>new Wo(e),"PRIVATE")),Ce($o,Gh,n),Ce($o,Gh,"esm2020"),Ce("fire-js","")}E_("");var w_="firebase",v_="12.7.0";Ce(w_,v_,"app");function pd(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var md=pd,gd=new Xe("auth","Firebase",pd());var Si=new Et("@firebase/auth");function T_(n,...e){Si.logLevel<=j.WARN&&Si.warn(`Auth (${vt}): ${n}`,...e)}function vi(n,...e){Si.logLevel<=j.ERROR&&Si.error(`Auth (${vt}): ${n}`,...e)}function Ke(n,...e){throw Ea(n,...e)}function Gt(n,...e){return Ea(n,...e)}function _d(n,e,t){let r=xe(H({},md()),{[e]:t});return new Xe("auth","Firebase",r).create(e,{appName:n.name})}function bt(n){return _d(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ea(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return gd.create(n,...e)}function M(n,e,...t){if(!n)throw Ea(e,...t)}function et(n){let e="INTERNAL ASSERTION FAILED: "+n;throw vi(e),new Error(e)}function St(n,e){n||et(e)}function ea(){return typeof self<"u"&&self.location?.href||""}function A_(){return Xh()==="http:"||Xh()==="https:"}function Xh(){return typeof self<"u"&&self.location?.protocol||null}function b_(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(A_()||Dh()||"connection"in navigator)?navigator.onLine:!0}function S_(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Kt=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,St(t>e,"Short delay should be less than long delay!"),this.isMobile=Ph()||kh()}get(){return b_()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function wa(n,e){St(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ri=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;et("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;et("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;et("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var R_={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var C_=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],P_=new Kt(3e4,6e4);function Wt(n,e){return n.tenantId&&!e.tenantId?xe(H({},e),{tenantId:n.tenantId}):e}async function Rt(n,e,t,r,i={}){return yd(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});let u=dr(H({key:n.config.apiKey},a)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);let d=H({method:e,headers:l},s);return Nh()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&Le(n.emulatorConfig.host)&&(d.credentials="include"),Ri.fetch()(await Id(n,n.config.apiHost,t,u),d)})}async function yd(n,e,t){n._canInitEmulator=!1;let r=H(H({},R_),e);try{let i=new ta(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=await s.json();if("needConfirmation"in a)throw wi(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let u=s.ok?a.errorMessage:a.error.message,[l,d]=u.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw wi(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw wi(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw wi(n,"user-disabled",a);let p=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw _d(n,p,d);Ke(n,p)}}catch(i){if(i instanceof Ae)throw i;Ke(n,"network-request-failed",{message:String(i)})}}async function Fi(n,e,t,r,i={}){let s=await Rt(n,e,t,r,i);return"mfaPendingCredential"in s&&Ke(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Id(n,e,t,r){let i=`${e}${t}?${r}`,s=n,a=s.config.emulator?wa(n.config,i):`${n.config.apiScheme}://${i}`;return C_.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}function N_(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var ta=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Gt(this.auth,"network-request-failed")),P_.get())})}};function wi(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Gt(n,e,r);return i.customData._tokenResponse=t,i}function Zh(n){return n!==void 0&&n.enterprise!==void 0}var na=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return N_(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};async function D_(n,e){return Rt(n,"GET","/v2/recaptchaConfig",Wt(n,e))}async function k_(n,e){return Rt(n,"POST","/v1/accounts:delete",e)}async function Ci(n,e){return Rt(n,"POST","/v1/accounts:lookup",e)}function mr(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ed(n,e=!1){let t=X(n),r=await t.getIdToken(e),i=va(r);M(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:mr(Yo(i.auth_time)),issuedAtTime:mr(Yo(i.iat)),expirationTime:mr(Yo(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Yo(n){return Number(n)*1e3}function va(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return vi("JWT malformed, contained fewer than 3 sections"),null;try{let i=mi(t);return i?JSON.parse(i):(vi("Failed to decode base64 JWT payload"),null)}catch(i){return vi("Caught error parsing JWT payload as JSON",i?.toString()),null}}function ed(n){let e=va(n);return M(e,"internal-error"),M(typeof e.exp<"u","internal-error"),M(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function _r(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ae&&O_(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function O_({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var ra=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var yr=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=mr(this.lastLoginAt),this.creationTime=mr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function Pi(n){let e=n.auth,t=await n.getIdToken(),r=await _r(n,Ci(e,{idToken:t}));M(r?.users.length,e,"internal-error");let i=r.users[0];n._notifyReloadListener(i);let s=i.providerUserInfo?.length?vd(i.providerUserInfo):[],a=V_(n.providerData,s),u=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!a?.length,d=u?l:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new yr(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,p)}async function wd(n){let e=X(n);await Pi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function V_(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function vd(n){return n.map(r=>{var i=r,{providerId:e}=i,t=Io(i,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function x_(n,e){let t=await yd(n,{},async()=>{let r=dr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await Id(n,i,"/v1/token",`key=${s}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:u,body:r};return n.emulatorConfig&&Le(n.emulatorConfig.host)&&(l.credentials="include"),Ri.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function L_(n,e){return Rt(n,"POST","/v2/accounts:revokeToken",Wt(n,e))}var gr=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){M(e.idToken,"internal-error"),M(typeof e.idToken<"u","internal-error"),M(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ed(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){M(e.length!==0,"internal-error");let t=ed(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(M(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await x_(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&(M(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(M(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(M(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return et("not implemented")}};function Tt(n,e){M(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var At=class n{constructor(s){var a=s,{uid:e,auth:t,stsTokenManager:r}=a,i=Io(a,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ra(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new yr(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await _r(this,this.stsTokenManager.getToken(this.auth,e));return M(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Ed(this,e)}reload(){return wd(this)}_assign(e){this!==e&&(M(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>H({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(xe(H({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){M(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Pi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(be(this.auth.app))return Promise.reject(bt(this.auth));let e=await this.getIdToken();return await _r(this,k_(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return xe(H({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>H({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,u=t.tenantId??void 0,l=t._redirectEventId??void 0,d=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:m,emailVerified:_,isAnonymous:S,providerData:P,stsTokenManager:O}=t;M(m&&O,e,"internal-error");let N=gr.fromJSON(this.name,O);M(typeof m=="string",e,"internal-error"),Tt(r,e.name),Tt(i,e.name),M(typeof _=="boolean",e,"internal-error"),M(typeof S=="boolean",e,"internal-error"),Tt(s,e.name),Tt(a,e.name),Tt(u,e.name),Tt(l,e.name),Tt(d,e.name),Tt(p,e.name);let B=new n({uid:m,auth:e,email:i,emailVerified:_,displayName:r,isAnonymous:S,photoURL:a,phoneNumber:s,tenantId:u,stsTokenManager:N,createdAt:d,lastLoginAt:p});return P&&Array.isArray(P)&&(B.providerData=P.map($=>H({},$))),l&&(B._redirectEventId=l),B}static async _fromIdTokenResponse(e,t,r=!1){let i=new gr;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Pi(s),s}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];M(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?vd(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,u=new gr;u.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new yr(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,d),l}};var td=new Map;function tt(n){St(n instanceof Function,"Expected a class definition");let e=td.get(n);return e?(St(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,td.set(n,e),e)}var M_=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),ia=M_;function Ti(n,e,t){return`firebase:${n}:${e}:${t}`}var Ni=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Ti(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ti("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await Ci(this.auth,{idToken:e}).catch(()=>{});return t?At._fromGetAccountInfoResponse(this.auth,t,e):null}return At._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(tt(ia),e,r);let i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d),s=i[0]||tt(ia),a=Ti(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=await d._get(a);if(p){let m;if(typeof p=="string"){let _=await Ci(e,{idToken:p}).catch(()=>{});if(!_)break;m=await At._fromGetAccountInfoResponse(e,_,p)}else m=At._fromJSON(e,p);d!==s&&(u=m),s=d;break}}catch{}let l=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,r):(s=l[0],u&&await s._set(a,u.toJSON()),await Promise.all(t.map(async d=>{if(d!==s)try{await d._remove(a)}catch{}})),new n(s,e,r))}};function nd(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Sd(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Td(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Cd(e))return"Blackberry";if(Pd(e))return"Webos";if(Ad(e))return"Safari";if((e.includes("chrome/")||bd(e))&&!e.includes("edge/"))return"Chrome";if(Rd(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Td(n=de()){return/firefox\//i.test(n)}function Ad(n=de()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bd(n=de()){return/crios\//i.test(n)}function Sd(n=de()){return/iemobile/i.test(n)}function Rd(n=de()){return/android/i.test(n)}function Cd(n=de()){return/blackberry/i.test(n)}function Pd(n=de()){return/webos/i.test(n)}function Ta(n=de()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function F_(n=de()){return Ta(n)&&!!window.navigator?.standalone}function U_(){return Oh()&&document.documentMode===10}function Nd(n=de()){return Ta(n)||Rd(n)||Pd(n)||Cd(n)||/windows phone/i.test(n)||Sd(n)}function Dd(n,e=[]){let t;switch(n){case"Browser":t=nd(de());break;case"Worker":t=`${nd(de())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${vt}/${r}`}var sa=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,u)=>{try{let l=e(s);a(l)}catch(l){u(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function B_(n,e={}){return Rt(n,"GET","/v2/passwordPolicy",Wt(n,e))}var q_=6,oa=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??q_,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var aa=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Di(this),this.idTokenSubscription=new Di(this),this.beforeStateQueue=new sa(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=tt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ni.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Ci(this,{idToken:e}),r=await At._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(be(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,u=await this.tryRedirectSignIn(e);(!s||s===a)&&u?.user&&(r=u.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return M(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Pi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=S_()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(be(this.app))return Promise.reject(bt(this));let t=e?X(e):null;return t&&M(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&M(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return be(this.app)?Promise.reject(bt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return be(this.app)?Promise.reject(bt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(tt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await B_(this),t=new oa(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Xe("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await L_(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&tt(e)||this._popupRedirectResolver;M(t,this,"argument-error"),this.redirectPersistenceManager=await Ni.create(this,[tt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(M(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{let l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return M(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Dd(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(be(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&T_(`Error while retrieving App Check token: ${e.error}`),e?.token}};function _n(n){return X(n)}var Di=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Mh(t=>this.observer=t)}get next(){return M(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Ui={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function z_(n){Ui=n}function kd(n){return Ui.loadJS(n)}function j_(){return Ui.recaptchaEnterpriseScript}function $_(){return Ui.gapiScript}function Od(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var ca=class{constructor(){this.enterprise=new ua}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},ua=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var G_="recaptcha-enterprise",Vd="NO_RECAPTCHA",la=class{constructor(e){this.type=G_,this.auth=_n(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,u)=>{D_(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let d=new na(l);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,a(d.siteKey)}}).catch(l=>{u(l)})})}function i(s,a,u){let l=window.grecaptcha;Zh(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(d=>{a(d)}).catch(()=>{a(Vd)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ca().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{r(this.auth).then(u=>{if(!t&&Zh(window.grecaptcha))i(u,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=j_();l.length!==0&&(l+=u),kd(l).then(()=>{i(u,s,a)}).catch(d=>{a(d)})}}).catch(u=>{a(u)})})}};async function pr(n,e,t,r=!1,i=!1){let s=new la(n),a;if(i)a=Vd;else try{a=await s.verify(t)}catch{a=await s.verify(t,!0)}let u=H({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){let l=u.phoneEnrollmentInfo.phoneNumber,d=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){let l=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return r?Object.assign(u,{captchaResp:a}):Object.assign(u,{captchaResponse:a}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function rd(n,e,t,r,i){if(i==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=await pr(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let a=await pr(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)});else if(i==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let s=await pr(n,e,t);return r(n,s).catch(async a=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(a.code==="auth/missing-recaptcha-token"||a.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let u=await pr(n,e,t,!1,!0);return r(n,u)}return Promise.reject(a)})}else{let s=await pr(n,e,t,!1,!0);return r(n,s)}else return Promise.reject(i+" provider is not supported.")}function xd(n,e){let t=$t(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(ze(s,e??{}))return i;Ke(i,"already-initialized")}return t.initialize({options:e})}function K_(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(tt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Ld(n,e,t){let r=_n(n);M(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Md(e),{host:a,port:u}=H_(e),l=u===null?"":`:${u}`,d={url:`${s}//${a}${l}/`},p=Object.freeze({host:a,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){M(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),M(ze(d,r.config.emulator)&&ze(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,Le(a)?(dn(`${s}//${a}${l}`),fn("Auth",!0)):i||W_()}function Md(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function H_(n){let e=Md(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:id(r.substr(s.length+1))}}else{let[s,a]=r.split(":");return{host:s,port:id(a)}}}function id(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function W_(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Ir=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return et("not implemented")}_getIdTokenResponse(e){return et("not implemented")}_linkToIdToken(e,t){return et("not implemented")}_getReauthenticationResolver(e){return et("not implemented")}};async function Q_(n,e){return Rt(n,"POST","/v1/accounts:signUp",e)}async function J_(n,e){return Fi(n,"POST","/v1/accounts:signInWithPassword",Wt(n,e))}async function Y_(n,e){return Fi(n,"POST","/v1/accounts:signInWithEmailLink",Wt(n,e))}async function X_(n,e){return Fi(n,"POST","/v1/accounts:signInWithEmailLink",Wt(n,e))}var Er=class n extends Ir{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rd(e,t,"signInWithPassword",J_,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Y_(e,{email:this._email,oobCode:this._password});default:Ke(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rd(e,r,"signUpPassword",Q_,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return X_(e,{idToken:t,email:this._email,oobCode:this._password});default:Ke(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function Xo(n,e){return Fi(n,"POST","/v1/accounts:signInWithIdp",Wt(n,e))}function Z_(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ey(n){let e=pn(mn(n)).link,t=e?pn(mn(e)).deep_link_id:null,r=pn(mn(n)).deep_link_id;return(r?pn(mn(r)).link:null)||r||t||e||n}var ki=class n{constructor(e){let t=pn(mn(e)),r=t.apiKey??null,i=t.oobCode??null,s=Z_(t.mode??null);M(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){let t=ey(e);try{return new n(t)}catch{return null}}};var Fd=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Er._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=ki.parseLink(r);return M(i,"argument-error"),Er._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Oi=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var ha=class extends Oi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var wr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let s=await At._fromIdTokenResponse(e,r,i),a=sd(r);return new n({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=sd(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function sd(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var da=class n extends Ae{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Ud(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?da._fromErrorAndOperation(n,s,e,r):s})}async function ty(n,e,t=!1){let r=await _r(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wr._forOperation(n,"link",r)}async function ny(n,e,t=!1){let{auth:r}=n;if(be(r.app))return Promise.reject(bt(r));let i="reauthenticate";try{let s=await _r(n,Ud(r,i,e,n),t);M(s.idToken,r,"internal-error");let a=va(s.idToken);M(a,r,"internal-error");let{sub:u}=a;return M(n.uid===u,r,"user-mismatch"),wr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Ke(r,"user-mismatch"),s}}async function Bd(n,e,t=!1){if(be(n.app))return Promise.reject(bt(n));let r="signIn",i=await Ud(n,r,e),s=await wr._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function qd(n,e){return Bd(_n(n),e)}async function ry(n){let e=_n(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function iy(n,e,t){return be(n.app)?Promise.reject(bt(n)):qd(X(n),Fd.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ry(n),r})}function Aa(n,e){return X(n).setPersistence(e)}function zd(n,e,t,r){return X(n).onIdTokenChanged(e,t,r)}function jd(n,e,t){return X(n).beforeAuthStateChanged(e,t)}function sy(n,e,t,r){return X(n).onAuthStateChanged(e,t,r)}function oy(n){return X(n).signOut()}var Vi="__sak";var xi=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Vi,"1"),this.storage.removeItem(Vi),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var ay=1e3,cy=10,uy=(()=>{class n extends xi{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Nd(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,l,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);U_()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,cy):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},ay)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){let r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),Bi=uy;var ly=(()=>{class n extends xi{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),ba=ly;function hy(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var dy=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let r=t,{eventId:i,eventType:s,data:a}=r.data,u=this.handlersMap[s];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let l=Array.from(u).map(async p=>p(r.origin,a)),d=await hy(l);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function $d(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var fa=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((u,l)=>{let d=$d("",20);i.port1.start();let p=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(m){let _=m;if(_.data.eventId===d)switch(_.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(_.data.response);break;default:clearTimeout(p),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}};function Ge(){return window}function fy(n){Ge().location.href=n}function Gd(){return typeof Ge().WorkerGlobalScope<"u"&&typeof Ge().importScripts=="function"}async function py(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function my(){return navigator?.serviceWorker?.controller||null}function gy(){return Gd()?self:null}var Kd="firebaseLocalStorageDb",_y=1,Li="firebaseLocalStorage",Hd="fbase_key",Ht=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function qi(n,e){return n.transaction([Li],e?"readwrite":"readonly").objectStore(Li)}function yy(){let n=indexedDB.deleteDatabase(Kd);return new Ht(n).toPromise()}function pa(){let n=indexedDB.open(Kd,_y);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Li,{keyPath:Hd})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(Li)?e(r):(r.close(),await yy(),e(await pa()))})})}async function od(n,e,t){let r=qi(n,!0).put({[Hd]:e,value:t});return new Ht(r).toPromise()}async function Iy(n,e){let t=qi(n,!1).get(e),r=await new Ht(t).toPromise();return r===void 0?null:r.value}function ad(n,e){let t=qi(n,!0).delete(e);return new Ht(t).toPromise()}var Ey=800,wy=3,vy=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pa(),this.db)}async _withRetries(t){let r=0;for(;;)try{let i=await this._openDb();return await t(i)}catch(i){if(r++>wy)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Gd()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dy._getInstance(gy()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await py(),!this.activeServiceWorker)return;this.sender=new fa(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||my()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await pa();return await od(t,Vi,"1"),await ad(t,Vi),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>od(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){let r=await this._withRetries(i=>Iy(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>ad(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(s=>{let a=qi(s,!1).getAll();return new Ht(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Ey)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Wd=vy;var qv=Od("rcb"),zv=new Kt(3e4,6e4);function Ty(n,e){return e?tt(e):(M(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var vr=class extends Ir{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Xo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Xo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Xo(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Ay(n){return Bd(n.auth,new vr(n),n.bypassAuthState)}function by(n){let{auth:e,user:t}=n;return M(t,e,"internal-error"),ny(t,new vr(n),n.bypassAuthState)}async function Sy(n){let{auth:e,user:t}=n;return M(t,e,"internal-error"),ty(t,new vr(n),n.bypassAuthState)}var ma=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:u}=e;if(a){this.reject(a);return}let l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ay;case"linkViaPopup":case"linkViaRedirect":return Sy;case"reauthViaPopup":case"reauthViaRedirect":return by;default:Ke(this.auth,"internal-error")}}resolve(e){St(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){St(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var jv=new Kt(2e3,1e4);var Ry="pendingRedirect",Ai=new Map,ga=class extends ma{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Ai.get(this.auth._key());if(!e){try{let r=await Cy(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ai.set(this.auth._key(),e)}return this.bypassAuthState||Ai.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function Cy(n,e){let t=Dy(e),r=Ny(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}function Py(n,e){Ai.set(n._key(),e)}function Ny(n){return tt(n._redirectPersistence)}function Dy(n){return Ti(Ry,n.config.apiKey,n.name)}async function ky(n,e,t=!1){if(be(n.app))return Promise.reject(bt(n));let r=_n(n),i=Ty(r,e),a=await new ga(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}var Oy=600*1e3,_a=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Vy(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Qd(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Gt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Oy&&this.cachedEventUids.clear(),this.cachedEventUids.has(cd(e))}saveEventToCache(e){this.cachedEventUids.add(cd(e)),this.lastProcessedEventTime=Date.now()}};function cd(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Qd({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Vy(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Qd(n);default:return!1}}async function xy(n,e={}){return Rt(n,"GET","/v1/projects",e)}var Ly=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,My=/^https?/;async function Fy(n){if(n.config.emulator)return;let{authorizedDomains:e}=await xy(n);for(let t of e)try{if(Uy(t))return}catch{}Ke(n,"unauthorized-domain")}function Uy(n){let e=ea(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!My.test(t))return!1;if(Ly.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var By=new Kt(3e4,6e4);function ud(){let n=Ge().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function qy(n){return new Promise((e,t)=>{function r(){ud(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ud(),t(Gt(n,"network-request-failed"))},timeout:By.get()})}if(Ge().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ge().gapi?.load)r();else{let i=Od("iframefcb");return Ge()[i]=()=>{gapi.load?r():t(Gt(n,"network-request-failed"))},kd(`${$_()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw bi=null,e})}var bi=null;function zy(n){return bi=bi||qy(n),bi}var jy=new Kt(5e3,15e3),$y="__/auth/iframe",Gy="emulator/auth/iframe",Ky={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Hy=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Wy(n){let e=n.config;M(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?wa(e,Gy):`https://${n.config.authDomain}/${$y}`,r={apiKey:e.apiKey,appName:n.name,v:vt},i=Hy.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${dr(r).slice(1)}`}async function Qy(n){let e=await zy(n),t=Ge().gapi;return M(t,n,"internal-error"),e.open({where:document.body,url:Wy(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ky,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});let a=Gt(n,"network-request-failed"),u=Ge().setTimeout(()=>{s(a)},jy.get());function l(){Ge().clearTimeout(u),i(r)}r.ping(l).then(l,()=>{s(a)})}))}var Jy={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Yy=500,Xy=600,Zy="_blank",eI="http://localhost",Mi=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function tI(n,e,t,r=Yy,i=Xy){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",l=xe(H({},Jy),{width:r.toString(),height:i.toString(),top:s,left:a}),d=de().toLowerCase();t&&(u=bd(d)?Zy:t),Td(d)&&(e=e||eI,l.scrollbars="yes");let p=Object.entries(l).reduce((_,[S,P])=>`${_}${S}=${P},`,"");if(F_(d)&&u!=="_self")return nI(e||"",u),new Mi(null);let m=window.open(e||"",u,p);M(m,n,"popup-blocked");try{m.focus()}catch{}return new Mi(m)}function nI(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var rI="__/auth/handler",iI="emulator/auth/handler",sI=encodeURIComponent("fac");async function ld(n,e,t,r,i,s){M(n.config.authDomain,n,"auth-domain-config-required"),M(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:vt,eventId:i};if(e instanceof Oi){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Lh(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,m]of Object.entries(s||{}))a[p]=m}if(e instanceof ha){let p=e.getScopes().filter(m=>m!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let l=await n._getAppCheckToken(),d=l?`#${sI}=${encodeURIComponent(l)}`:"";return`${oI(n)}?${dr(u).slice(1)}${d}`}function oI({config:n}){return n.emulator?wa(n,iI):`https://${n.authDomain}/${rI}`}var Zo="webStorageSupport",ya=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ba,this._completeRedirectFn=ky,this._overrideRedirectResult=Py}async _openPopup(e,t,r,i){St(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let s=await ld(e,t,r,ea(),i);return tI(e,s,$d())}async _openRedirect(e,t,r,i){await this._originValidation(e);let s=await ld(e,t,r,ea(),i);return fy(s),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(St(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await Qy(e),r=new _a(e);return t.register("authEvent",i=>(M(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Zo,{type:Zo},i=>{let s=i?.[0]?.[Zo];s!==void 0&&t(!!s),Ke(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Fy(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Nd()||Ad()||Ta()}},Jd=ya;var hd="@firebase/auth",dd="1.12.0";var Ia=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){M(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function aI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function cI(n){$e(new Re("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;M(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Dd(n)},d=new aa(r,i,s,l);return K_(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),$e(new Re("auth-internal",e=>{let t=_n(e.getProvider("auth").getImmediate());return(r=>new Ia(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ce(hd,dd,aI(n)),Ce(hd,dd,"esm2020")}var uI=300,lI=Vo("authIdTokenMaxAge")||uI,fd=null,hI=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>lI)return;let i=t?.token;fd!==i&&(fd=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Sa(n=gn()){let e=$t(n,"auth");if(e.isInitialized())return e.getImmediate();let t=xd(n,{popupRedirectResolver:Jd,persistence:[Wd,Bi,ba]}),r=Vo("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let a=hI(s.toString());jd(t,a,()=>a(t.currentUser)),zd(t,u=>a(u))}}let i=ko("auth");return i&&Ld(t,`http://${i}`),t}function dI(){return document.getElementsByTagName("head")?.[0]??document}z_({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Gt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",dI().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});cI("Browser");var Yd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xd={};var nt,Ra;(function(){var n;function e(w,g){function I(){}I.prototype=g.prototype,w.F=g.prototype,w.prototype=new I,w.prototype.constructor=w,w.D=function(v,E,A){for(var y=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)y[Se-2]=arguments[Se];return g.prototype[E].apply(v,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,g,I){I||(I=0);let v=Array(16);if(typeof g=="string")for(var E=0;E<16;++E)v[E]=g.charCodeAt(I++)|g.charCodeAt(I++)<<8|g.charCodeAt(I++)<<16|g.charCodeAt(I++)<<24;else for(E=0;E<16;++E)v[E]=g[I++]|g[I++]<<8|g[I++]<<16|g[I++]<<24;g=w.g[0],I=w.g[1],E=w.g[2];let A=w.g[3],y;y=g+(A^I&(E^A))+v[0]+3614090360&4294967295,g=I+(y<<7&4294967295|y>>>25),y=A+(E^g&(I^E))+v[1]+3905402710&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(I^A&(g^I))+v[2]+606105819&4294967295,E=A+(y<<17&4294967295|y>>>15),y=I+(g^E&(A^g))+v[3]+3250441966&4294967295,I=E+(y<<22&4294967295|y>>>10),y=g+(A^I&(E^A))+v[4]+4118548399&4294967295,g=I+(y<<7&4294967295|y>>>25),y=A+(E^g&(I^E))+v[5]+1200080426&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(I^A&(g^I))+v[6]+2821735955&4294967295,E=A+(y<<17&4294967295|y>>>15),y=I+(g^E&(A^g))+v[7]+4249261313&4294967295,I=E+(y<<22&4294967295|y>>>10),y=g+(A^I&(E^A))+v[8]+1770035416&4294967295,g=I+(y<<7&4294967295|y>>>25),y=A+(E^g&(I^E))+v[9]+2336552879&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(I^A&(g^I))+v[10]+4294925233&4294967295,E=A+(y<<17&4294967295|y>>>15),y=I+(g^E&(A^g))+v[11]+2304563134&4294967295,I=E+(y<<22&4294967295|y>>>10),y=g+(A^I&(E^A))+v[12]+1804603682&4294967295,g=I+(y<<7&4294967295|y>>>25),y=A+(E^g&(I^E))+v[13]+4254626195&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(I^A&(g^I))+v[14]+2792965006&4294967295,E=A+(y<<17&4294967295|y>>>15),y=I+(g^E&(A^g))+v[15]+1236535329&4294967295,I=E+(y<<22&4294967295|y>>>10),y=g+(E^A&(I^E))+v[1]+4129170786&4294967295,g=I+(y<<5&4294967295|y>>>27),y=A+(I^E&(g^I))+v[6]+3225465664&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^I&(A^g))+v[11]+643717713&4294967295,E=A+(y<<14&4294967295|y>>>18),y=I+(A^g&(E^A))+v[0]+3921069994&4294967295,I=E+(y<<20&4294967295|y>>>12),y=g+(E^A&(I^E))+v[5]+3593408605&4294967295,g=I+(y<<5&4294967295|y>>>27),y=A+(I^E&(g^I))+v[10]+38016083&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^I&(A^g))+v[15]+3634488961&4294967295,E=A+(y<<14&4294967295|y>>>18),y=I+(A^g&(E^A))+v[4]+3889429448&4294967295,I=E+(y<<20&4294967295|y>>>12),y=g+(E^A&(I^E))+v[9]+568446438&4294967295,g=I+(y<<5&4294967295|y>>>27),y=A+(I^E&(g^I))+v[14]+3275163606&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^I&(A^g))+v[3]+4107603335&4294967295,E=A+(y<<14&4294967295|y>>>18),y=I+(A^g&(E^A))+v[8]+1163531501&4294967295,I=E+(y<<20&4294967295|y>>>12),y=g+(E^A&(I^E))+v[13]+2850285829&4294967295,g=I+(y<<5&4294967295|y>>>27),y=A+(I^E&(g^I))+v[2]+4243563512&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^I&(A^g))+v[7]+1735328473&4294967295,E=A+(y<<14&4294967295|y>>>18),y=I+(A^g&(E^A))+v[12]+2368359562&4294967295,I=E+(y<<20&4294967295|y>>>12),y=g+(I^E^A)+v[5]+4294588738&4294967295,g=I+(y<<4&4294967295|y>>>28),y=A+(g^I^E)+v[8]+2272392833&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^I)+v[11]+1839030562&4294967295,E=A+(y<<16&4294967295|y>>>16),y=I+(E^A^g)+v[14]+4259657740&4294967295,I=E+(y<<23&4294967295|y>>>9),y=g+(I^E^A)+v[1]+2763975236&4294967295,g=I+(y<<4&4294967295|y>>>28),y=A+(g^I^E)+v[4]+1272893353&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^I)+v[7]+4139469664&4294967295,E=A+(y<<16&4294967295|y>>>16),y=I+(E^A^g)+v[10]+3200236656&4294967295,I=E+(y<<23&4294967295|y>>>9),y=g+(I^E^A)+v[13]+681279174&4294967295,g=I+(y<<4&4294967295|y>>>28),y=A+(g^I^E)+v[0]+3936430074&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^I)+v[3]+3572445317&4294967295,E=A+(y<<16&4294967295|y>>>16),y=I+(E^A^g)+v[6]+76029189&4294967295,I=E+(y<<23&4294967295|y>>>9),y=g+(I^E^A)+v[9]+3654602809&4294967295,g=I+(y<<4&4294967295|y>>>28),y=A+(g^I^E)+v[12]+3873151461&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^I)+v[15]+530742520&4294967295,E=A+(y<<16&4294967295|y>>>16),y=I+(E^A^g)+v[2]+3299628645&4294967295,I=E+(y<<23&4294967295|y>>>9),y=g+(E^(I|~A))+v[0]+4096336452&4294967295,g=I+(y<<6&4294967295|y>>>26),y=A+(I^(g|~E))+v[7]+1126891415&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~I))+v[14]+2878612391&4294967295,E=A+(y<<15&4294967295|y>>>17),y=I+(A^(E|~g))+v[5]+4237533241&4294967295,I=E+(y<<21&4294967295|y>>>11),y=g+(E^(I|~A))+v[12]+1700485571&4294967295,g=I+(y<<6&4294967295|y>>>26),y=A+(I^(g|~E))+v[3]+2399980690&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~I))+v[10]+4293915773&4294967295,E=A+(y<<15&4294967295|y>>>17),y=I+(A^(E|~g))+v[1]+2240044497&4294967295,I=E+(y<<21&4294967295|y>>>11),y=g+(E^(I|~A))+v[8]+1873313359&4294967295,g=I+(y<<6&4294967295|y>>>26),y=A+(I^(g|~E))+v[15]+4264355552&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~I))+v[6]+2734768916&4294967295,E=A+(y<<15&4294967295|y>>>17),y=I+(A^(E|~g))+v[13]+1309151649&4294967295,I=E+(y<<21&4294967295|y>>>11),y=g+(E^(I|~A))+v[4]+4149444226&4294967295,g=I+(y<<6&4294967295|y>>>26),y=A+(I^(g|~E))+v[11]+3174756917&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~I))+v[2]+718787259&4294967295,E=A+(y<<15&4294967295|y>>>17),y=I+(A^(E|~g))+v[9]+3951481745&4294967295,w.g[0]=w.g[0]+g&4294967295,w.g[1]=w.g[1]+(E+(y<<21&4294967295|y>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+A&4294967295}r.prototype.v=function(w,g){g===void 0&&(g=w.length);let I=g-this.blockSize,v=this.C,E=this.h,A=0;for(;A<g;){if(E==0)for(;A<=I;)i(this,w,A),A+=this.blockSize;if(typeof w=="string"){for(;A<g;)if(v[E++]=w.charCodeAt(A++),E==this.blockSize){i(this,v),E=0;break}}else for(;A<g;)if(v[E++]=w[A++],E==this.blockSize){i(this,v),E=0;break}}this.h=E,this.o+=g},r.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var g=1;g<w.length-8;++g)w[g]=0;g=this.o*8;for(var I=w.length-8;I<w.length;++I)w[I]=g&255,g/=256;for(this.v(w),w=Array(16),g=0,I=0;I<4;++I)for(let v=0;v<32;v+=8)w[g++]=this.g[I]>>>v&255;return w};function s(w,g){var I=u;return Object.prototype.hasOwnProperty.call(I,w)?I[w]:I[w]=g(w)}function a(w,g){this.h=g;let I=[],v=!0;for(let E=w.length-1;E>=0;E--){let A=w[E]|0;v&&A==g||(I[E]=A,v=!1)}this.g=I}var u={};function l(w){return-128<=w&&w<128?s(w,function(g){return new a([g|0],g<0?-1:0)}):new a([w|0],w<0?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return m;if(w<0)return N(d(-w));let g=[],I=1;for(let v=0;w>=I;v++)g[v]=w/I|0,I*=4294967296;return new a(g,0)}function p(w,g){if(w.length==0)throw Error("number format error: empty string");if(g=g||10,g<2||36<g)throw Error("radix out of range: "+g);if(w.charAt(0)=="-")return N(p(w.substring(1),g));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');let I=d(Math.pow(g,8)),v=m;for(let A=0;A<w.length;A+=8){var E=Math.min(8,w.length-A);let y=parseInt(w.substring(A,A+E),g);E<8?(E=d(Math.pow(g,E)),v=v.j(E).add(d(y))):(v=v.j(I),v=v.add(d(y)))}return v}var m=l(0),_=l(1),S=l(16777216);n=a.prototype,n.m=function(){if(O(this))return-N(this).m();let w=0,g=1;for(let I=0;I<this.g.length;I++){let v=this.i(I);w+=(v>=0?v:4294967296+v)*g,g*=4294967296}return w},n.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(P(this))return"0";if(O(this))return"-"+N(this).toString(w);let g=d(Math.pow(w,6));var I=this;let v="";for(;;){let E=me(I,g).g;I=B(I,E.j(g));let A=((I.g.length>0?I.g[0]:I.h)>>>0).toString(w);if(I=E,P(I))return A+v;for(;A.length<6;)A="0"+A;v=A+v}},n.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function P(w){if(w.h!=0)return!1;for(let g=0;g<w.g.length;g++)if(w.g[g]!=0)return!1;return!0}function O(w){return w.h==-1}n.l=function(w){return w=B(this,w),O(w)?-1:P(w)?0:1};function N(w){let g=w.g.length,I=[];for(let v=0;v<g;v++)I[v]=~w.g[v];return new a(I,~w.h).add(_)}n.abs=function(){return O(this)?N(this):this},n.add=function(w){let g=Math.max(this.g.length,w.g.length),I=[],v=0;for(let E=0;E<=g;E++){let A=v+(this.i(E)&65535)+(w.i(E)&65535),y=(A>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);v=y>>>16,A&=65535,y&=65535,I[E]=y<<16|A}return new a(I,I[I.length-1]&-2147483648?-1:0)};function B(w,g){return w.add(N(g))}n.j=function(w){if(P(this)||P(w))return m;if(O(this))return O(w)?N(this).j(N(w)):N(N(this).j(w));if(O(w))return N(this.j(N(w)));if(this.l(S)<0&&w.l(S)<0)return d(this.m()*w.m());let g=this.g.length+w.g.length,I=[];for(var v=0;v<2*g;v++)I[v]=0;for(v=0;v<this.g.length;v++)for(let E=0;E<w.g.length;E++){let A=this.i(v)>>>16,y=this.i(v)&65535,Se=w.i(E)>>>16,ft=w.i(E)&65535;I[2*v+2*E]+=y*ft,$(I,2*v+2*E),I[2*v+2*E+1]+=A*ft,$(I,2*v+2*E+1),I[2*v+2*E+1]+=y*Se,$(I,2*v+2*E+1),I[2*v+2*E+2]+=A*Se,$(I,2*v+2*E+2)}for(w=0;w<g;w++)I[w]=I[2*w+1]<<16|I[2*w];for(w=g;w<2*g;w++)I[w]=0;return new a(I,0)};function $(w,g){for(;(w[g]&65535)!=w[g];)w[g+1]+=w[g]>>>16,w[g]&=65535,g++}function Q(w,g){this.g=w,this.h=g}function me(w,g){if(P(g))throw Error("division by zero");if(P(w))return new Q(m,m);if(O(w))return g=me(N(w),g),new Q(N(g.g),N(g.h));if(O(g))return g=me(w,N(g)),new Q(N(g.g),g.h);if(w.g.length>30){if(O(w)||O(g))throw Error("slowDivide_ only works with positive integers.");for(var I=_,v=g;v.l(w)<=0;)I=ge(I),v=ge(v);var E=ie(I,1),A=ie(v,1);for(v=ie(v,2),I=ie(I,2);!P(v);){var y=A.add(v);y.l(w)<=0&&(E=E.add(I),A=y),v=ie(v,1),I=ie(I,1)}return g=B(w,E.j(g)),new Q(E,g)}for(E=m;w.l(g)>=0;){for(I=Math.max(1,Math.floor(w.m()/g.m())),v=Math.ceil(Math.log(I)/Math.LN2),v=v<=48?1:Math.pow(2,v-48),A=d(I),y=A.j(g);O(y)||y.l(w)>0;)I-=v,A=d(I),y=A.j(g);P(A)&&(A=_),E=E.add(A),w=B(w,y)}return new Q(E,w)}n.B=function(w){return me(this,w).h},n.and=function(w){let g=Math.max(this.g.length,w.g.length),I=[];for(let v=0;v<g;v++)I[v]=this.i(v)&w.i(v);return new a(I,this.h&w.h)},n.or=function(w){let g=Math.max(this.g.length,w.g.length),I=[];for(let v=0;v<g;v++)I[v]=this.i(v)|w.i(v);return new a(I,this.h|w.h)},n.xor=function(w){let g=Math.max(this.g.length,w.g.length),I=[];for(let v=0;v<g;v++)I[v]=this.i(v)^w.i(v);return new a(I,this.h^w.h)};function ge(w){let g=w.g.length+1,I=[];for(let v=0;v<g;v++)I[v]=w.i(v)<<1|w.i(v-1)>>>31;return new a(I,w.h)}function ie(w,g){let I=g>>5;g%=32;let v=w.g.length-I,E=[];for(let A=0;A<v;A++)E[A]=g>0?w.i(A+I)>>>g|w.i(A+I+1)<<32-g:w.i(A+I);return new a(E,w.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Ra=Xd.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,nt=Xd.Integer=a}).apply(typeof Yd<"u"?Yd:typeof self<"u"?self:typeof window<"u"?window:{});var zi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},rt={};var Ca,fI,yn,Pa,Tr,ji,Na,Da,ka;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof zi=="object"&&zi];for(var c=0;c<o.length;++c){var h=o[c];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function i(o,c){if(c)e:{var h=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var T=o[f];if(!(T in h))break e;h=h[T]}o=o[o.length-1],f=h[o],c=c(f),c!=f&&c!=null&&e(h,o,{configurable:!0,writable:!0,value:c})}}i("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(o){return o||function(c){var h=[],f;for(f in c)Object.prototype.hasOwnProperty.call(c,f)&&h.push([f,c[f]]);return h}});var s=s||{},a=this||self;function u(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function l(o,c,h){return o.call.apply(o.bind,arguments)}function d(o,c,h){return d=l,d.apply(null,arguments)}function p(o,c){var h=Array.prototype.slice.call(arguments,1);return function(){var f=h.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function m(o,c){function h(){}h.prototype=c.prototype,o.Z=c.prototype,o.prototype=new h,o.prototype.constructor=o,o.Ob=function(f,T,b){for(var k=Array(arguments.length-2),q=2;q<arguments.length;q++)k[q-2]=arguments[q];return c.prototype[T].apply(f,k)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function S(o){let c=o.length;if(c>0){let h=Array(c);for(let f=0;f<c;f++)h[f]=o[f];return h}return[]}function P(o,c){for(let f=1;f<arguments.length;f++){let T=arguments[f];var h=typeof T;if(h=h!="object"?h:T?Array.isArray(T)?"array":h:"null",h=="array"||h=="object"&&typeof T.length=="number"){h=o.length||0;let b=T.length||0;o.length=h+b;for(let k=0;k<b;k++)o[h+k]=T[k]}else o.push(T)}}class O{constructor(c,h){this.i=c,this.j=h,this.h=0,this.g=null}get(){let c;return this.h>0?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function N(o){a.setTimeout(()=>{throw o},0)}function B(){var o=w;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class ${constructor(){this.h=this.g=null}add(c,h){let f=Q.get();f.set(c,h),this.h?this.h.next=f:this.g=f,this.h=f}}var Q=new O(()=>new me,o=>o.reset());class me{constructor(){this.next=this.g=this.h=null}set(c,h){this.h=c,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let ge,ie=!1,w=new $,g=()=>{let o=Promise.resolve(void 0);ge=()=>{o.then(I)}};function I(){for(var o;o=B();){try{o.h.call(o.g)}catch(h){N(h)}var c=Q;c.j(o),c.h<100&&(c.h++,o.next=c.g,c.g=o)}ie=!1}function v(){this.u=this.u,this.C=this.C}v.prototype.u=!1,v.prototype.dispose=function(){this.u||(this.u=!0,this.N())},v.prototype[Symbol.dispose]=function(){this.dispose()},v.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let h=()=>{};a.addEventListener("test",h,c),a.removeEventListener("test",h,c)}catch{}return o})();function y(o){return/^[\s\xa0]*$/.test(o)}function Se(o,c){E.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,c)}m(Se,E),Se.prototype.init=function(o,c){let h=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget,c||(h=="mouseover"?c=o.fromElement:h=="mouseout"&&(c=o.toElement)),this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&Se.Z.h.call(this)},Se.prototype.h=function(){Se.Z.h.call(this);let o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var ft="closure_listenable_"+(Math.random()*1e6|0),Dm=0;function km(o,c,h,f,T){this.listener=o,this.proxy=null,this.src=c,this.type=h,this.capture=!!f,this.ha=T,this.key=++Dm,this.da=this.fa=!1}function Kr(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Hr(o,c,h){for(let f in o)c.call(h,o[f],f,o)}function Om(o,c){for(let h in o)c.call(void 0,o[h],h,o)}function tl(o){let c={};for(let h in o)c[h]=o[h];return c}let nl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rl(o,c){let h,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(h in f)o[h]=f[h];for(let b=0;b<nl.length;b++)h=nl[b],Object.prototype.hasOwnProperty.call(f,h)&&(o[h]=f[h])}}function Wr(o){this.src=o,this.g={},this.h=0}Wr.prototype.add=function(o,c,h,f,T){let b=o.toString();o=this.g[b],o||(o=this.g[b]=[],this.h++);let k=Qs(o,c,f,T);return k>-1?(c=o[k],h||(c.fa=!1)):(c=new km(c,this.src,b,!!f,T),c.fa=h,o.push(c)),c};function Ws(o,c){let h=c.type;if(h in o.g){var f=o.g[h],T=Array.prototype.indexOf.call(f,c,void 0),b;(b=T>=0)&&Array.prototype.splice.call(f,T,1),b&&(Kr(c),o.g[h].length==0&&(delete o.g[h],o.h--))}}function Qs(o,c,h,f){for(let T=0;T<o.length;++T){let b=o[T];if(!b.da&&b.listener==c&&b.capture==!!h&&b.ha==f)return T}return-1}var Js="closure_lm_"+(Math.random()*1e6|0),Ys={};function il(o,c,h,f,T){if(f&&f.once)return ol(o,c,h,f,T);if(Array.isArray(c)){for(let b=0;b<c.length;b++)il(o,c[b],h,f,T);return null}return h=to(h),o&&o[ft]?o.J(c,h,u(f)?!!f.capture:!!f,T):sl(o,c,h,!1,f,T)}function sl(o,c,h,f,T,b){if(!c)throw Error("Invalid event type");let k=u(T)?!!T.capture:!!T,q=Zs(o);if(q||(o[Js]=q=new Wr(o)),h=q.add(c,h,f,k,b),h.proxy)return h;if(f=Vm(),h.proxy=f,f.src=o,f.listener=h,o.addEventListener)A||(T=k),T===void 0&&(T=!1),o.addEventListener(c.toString(),f,T);else if(o.attachEvent)o.attachEvent(cl(c.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return h}function Vm(){function o(h){return c.call(o.src,o.listener,h)}let c=xm;return o}function ol(o,c,h,f,T){if(Array.isArray(c)){for(let b=0;b<c.length;b++)ol(o,c[b],h,f,T);return null}return h=to(h),o&&o[ft]?o.K(c,h,u(f)?!!f.capture:!!f,T):sl(o,c,h,!0,f,T)}function al(o,c,h,f,T){if(Array.isArray(c))for(var b=0;b<c.length;b++)al(o,c[b],h,f,T);else f=u(f)?!!f.capture:!!f,h=to(h),o&&o[ft]?(o=o.i,b=String(c).toString(),b in o.g&&(c=o.g[b],h=Qs(c,h,f,T),h>-1&&(Kr(c[h]),Array.prototype.splice.call(c,h,1),c.length==0&&(delete o.g[b],o.h--)))):o&&(o=Zs(o))&&(c=o.g[c.toString()],o=-1,c&&(o=Qs(c,h,f,T)),(h=o>-1?c[o]:null)&&Xs(h))}function Xs(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[ft])Ws(c.i,o);else{var h=o.type,f=o.proxy;c.removeEventListener?c.removeEventListener(h,f,o.capture):c.detachEvent?c.detachEvent(cl(h),f):c.addListener&&c.removeListener&&c.removeListener(f),(h=Zs(c))?(Ws(h,o),h.h==0&&(h.src=null,c[Js]=null)):Kr(o)}}}function cl(o){return o in Ys?Ys[o]:Ys[o]="on"+o}function xm(o,c){if(o.da)o=!0;else{c=new Se(c,this);let h=o.listener,f=o.ha||o.src;o.fa&&Xs(o),o=h.call(f,c)}return o}function Zs(o){return o=o[Js],o instanceof Wr?o:null}var eo="__closure_events_fn_"+(Math.random()*1e9>>>0);function to(o){return typeof o=="function"?o:(o[eo]||(o[eo]=function(c){return o.handleEvent(c)}),o[eo])}function Ie(){v.call(this),this.i=new Wr(this),this.M=this,this.G=null}m(Ie,v),Ie.prototype[ft]=!0,Ie.prototype.removeEventListener=function(o,c,h,f){al(this,o,c,h,f)};function ve(o,c){var h,f=o.G;if(f)for(h=[];f;f=f.G)h.push(f);if(o=o.M,f=c.type||c,typeof c=="string")c=new E(c,o);else if(c instanceof E)c.target=c.target||o;else{var T=c;c=new E(f,o),rl(c,T)}T=!0;let b,k;if(h)for(k=h.length-1;k>=0;k--)b=c.g=h[k],T=Qr(b,f,!0,c)&&T;if(b=c.g=o,T=Qr(b,f,!0,c)&&T,T=Qr(b,f,!1,c)&&T,h)for(k=0;k<h.length;k++)b=c.g=h[k],T=Qr(b,f,!1,c)&&T}Ie.prototype.N=function(){if(Ie.Z.N.call(this),this.i){var o=this.i;for(let c in o.g){let h=o.g[c];for(let f=0;f<h.length;f++)Kr(h[f]);delete o.g[c],o.h--}}this.G=null},Ie.prototype.J=function(o,c,h,f){return this.i.add(String(o),c,!1,h,f)},Ie.prototype.K=function(o,c,h,f){return this.i.add(String(o),c,!0,h,f)};function Qr(o,c,h,f){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();let T=!0;for(let b=0;b<c.length;++b){let k=c[b];if(k&&!k.da&&k.capture==h){let q=k.listener,le=k.ha||k.src;k.fa&&Ws(o.i,k),T=q.call(le,f)!==!1&&T}}return T&&!f.defaultPrevented}function Lm(o,c){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=d(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(c)>2147483647?-1:a.setTimeout(o,c||0)}function ul(o){o.g=Lm(()=>{o.g=null,o.i&&(o.i=!1,ul(o))},o.l);let c=o.h;o.h=null,o.m.apply(null,c)}class Mm extends v{constructor(c,h){super(),this.m=c,this.l=h,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:ul(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Kn(o){v.call(this),this.h=o,this.g={}}m(Kn,v);var ll=[];function hl(o){Hr(o.g,function(c,h){this.g.hasOwnProperty(h)&&Xs(c)},o),o.g={}}Kn.prototype.N=function(){Kn.Z.N.call(this),hl(this)},Kn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var no=a.JSON.stringify,Fm=a.JSON.parse,Um=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function dl(){}function fl(){}var Hn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ro(){E.call(this,"d")}m(ro,E);function io(){E.call(this,"c")}m(io,E);var Ft={},pl=null;function Jr(){return pl=pl||new Ie}Ft.Ia="serverreachability";function ml(o){E.call(this,Ft.Ia,o)}m(ml,E);function Wn(o){let c=Jr();ve(c,new ml(c))}Ft.STAT_EVENT="statevent";function gl(o,c){E.call(this,Ft.STAT_EVENT,o),this.stat=c}m(gl,E);function Te(o){let c=Jr();ve(c,new gl(c,o))}Ft.Ja="timingevent";function _l(o,c){E.call(this,Ft.Ja,o),this.size=c}m(_l,E);function Qn(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},c)}function Jn(){this.g=!0}Jn.prototype.ua=function(){this.g=!1};function Bm(o,c,h,f,T,b){o.info(function(){if(o.g)if(b){var k="",q=b.split("&");for(let Y=0;Y<q.length;Y++){var le=q[Y].split("=");if(le.length>1){let he=le[0];le=le[1];let qe=he.split("_");k=qe.length>=2&&qe[1]=="type"?k+(he+"="+le+"&"):k+(he+"=redacted&")}}}else k=null;else k=b;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+c+`
`+h+`
`+k})}function qm(o,c,h,f,T,b,k){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+c+`
`+h+`
`+b+" "+k})}function un(o,c,h,f){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+jm(o,h)+(f?" "+f:"")})}function zm(o,c){o.info(function(){return"TIMEOUT: "+c})}Jn.prototype.info=function(){};function jm(o,c){if(!o.g)return c;if(!c)return null;try{let b=JSON.parse(c);if(b){for(o=0;o<b.length;o++)if(Array.isArray(b[o])){var h=b[o];if(!(h.length<2)){var f=h[1];if(Array.isArray(f)&&!(f.length<1)){var T=f[0];if(T!="noop"&&T!="stop"&&T!="close")for(let k=1;k<f.length;k++)f[k]=""}}}}return no(b)}catch{return c}}var Yr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},yl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Il;function so(){}m(so,dl),so.prototype.g=function(){return new XMLHttpRequest},Il=new so;function Yn(o){return encodeURIComponent(String(o))}function $m(o){var c=1;o=o.split(":");let h=[];for(;c>0&&o.length;)h.push(o.shift()),c--;return o.length&&h.push(o.join(":")),h}function pt(o,c,h,f){this.j=o,this.i=c,this.l=h,this.S=f||1,this.V=new Kn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new El}function El(){this.i=null,this.g="",this.h=!1}var wl={},oo={};function ao(o,c,h){o.M=1,o.A=Zr(Be(c)),o.u=h,o.R=!0,vl(o,null)}function vl(o,c){o.F=Date.now(),Xr(o),o.B=Be(o.A);var h=o.B,f=o.S;Array.isArray(f)||(f=[String(f)]),xl(h.i,"t",f),o.C=0,h=o.j.L,o.h=new El,o.g=Zl(o.j,h?c:null,!o.u),o.P>0&&(o.O=new Mm(d(o.Y,o,o.g),o.P)),c=o.V,h=o.g,f=o.ba;var T="readystatechange";Array.isArray(T)||(T&&(ll[0]=T.toString()),T=ll);for(let b=0;b<T.length;b++){let k=il(h,T[b],f||c.handleEvent,!1,c.h||c);if(!k)break;c.g[k.key]=k}c=o.J?tl(o.J):{},o.u?(o.v||(o.v="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,c)):(o.v="GET",o.g.ea(o.B,o.v,null,c)),Wn(),Bm(o.i,o.v,o.B,o.l,o.S,o.u)}pt.prototype.ba=function(o){o=o.target;let c=this.O;c&&_t(o)==3?c.j():this.Y(o)},pt.prototype.Y=function(o){try{if(o==this.g)e:{let q=_t(this.g),le=this.g.ya(),Y=this.g.ca();if(!(q<3)&&(q!=3||this.g&&(this.h.h||this.g.la()||zl(this.g)))){this.K||q!=4||le==7||(le==8||Y<=0?Wn(3):Wn(2)),co(this);var c=this.g.ca();this.X=c;var h=Gm(this);if(this.o=c==200,qm(this.i,this.v,this.B,this.l,this.S,q,c),this.o){if(this.U&&!this.L){t:{if(this.g){var f,T=this.g;if((f=T.g?T.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(f)){var b=f;break t}}b=null}if(o=b)un(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,uo(this,o);else{this.o=!1,this.m=3,Te(12),Ut(this),Xn(this);break e}}if(this.R){o=!0;let he;for(;!this.K&&this.C<h.length;)if(he=Km(this,h),he==oo){q==4&&(this.m=4,Te(14),o=!1),un(this.i,this.l,null,"[Incomplete Response]");break}else if(he==wl){this.m=4,Te(15),un(this.i,this.l,h,"[Invalid Chunk]"),o=!1;break}else un(this.i,this.l,he,null),uo(this,he);if(Tl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),q!=4||h.length!=0||this.h.h||(this.m=1,Te(16),o=!1),this.o=this.o&&o,!o)un(this.i,this.l,h,"[Invalid Chunked Response]"),Ut(this),Xn(this);else if(h.length>0&&!this.W){this.W=!0;var k=this.j;k.g==this&&k.aa&&!k.P&&(k.j.info("Great, no buffering proxy detected. Bytes received: "+h.length),_o(k),k.P=!0,Te(11))}}else un(this.i,this.l,h,null),uo(this,h);q==4&&Ut(this),this.o&&!this.K&&(q==4?Ql(this.j,this):(this.o=!1,Xr(this)))}else og(this.g),c==400&&h.indexOf("Unknown SID")>0?(this.m=3,Te(12)):(this.m=0,Te(13)),Ut(this),Xn(this)}}}catch{}finally{}};function Gm(o){if(!Tl(o))return o.g.la();let c=zl(o.g);if(c==="")return"";let h="",f=c.length,T=_t(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return Ut(o),Xn(o),"";o.h.i=new a.TextDecoder}for(let b=0;b<f;b++)o.h.h=!0,h+=o.h.i.decode(c[b],{stream:!(T&&b==f-1)});return c.length=0,o.h.g+=h,o.C=0,o.h.g}function Tl(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function Km(o,c){var h=o.C,f=c.indexOf(`
`,h);return f==-1?oo:(h=Number(c.substring(h,f)),isNaN(h)?wl:(f+=1,f+h>c.length?oo:(c=c.slice(f,f+h),o.C=f+h,c)))}pt.prototype.cancel=function(){this.K=!0,Ut(this)};function Xr(o){o.T=Date.now()+o.H,Al(o,o.H)}function Al(o,c){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Qn(d(o.aa,o),c)}function co(o){o.D&&(a.clearTimeout(o.D),o.D=null)}pt.prototype.aa=function(){this.D=null;let o=Date.now();o-this.T>=0?(zm(this.i,this.B),this.M!=2&&(Wn(),Te(17)),Ut(this),this.m=2,Xn(this)):Al(this,this.T-o)};function Xn(o){o.j.I==0||o.K||Ql(o.j,o)}function Ut(o){co(o);var c=o.O;c&&typeof c.dispose=="function"&&c.dispose(),o.O=null,hl(o.V),o.g&&(c=o.g,o.g=null,c.abort(),c.dispose())}function uo(o,c){try{var h=o.j;if(h.I!=0&&(h.g==o||lo(h.h,o))){if(!o.L&&lo(h.h,o)&&h.I==3){try{var f=h.Ba.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!h.v){if(h.g)if(h.g.F+3e3<o.F)si(h),ri(h);else break e;go(h),Te(18)}}else h.xa=T[1],0<h.xa-h.K&&T[2]<37500&&h.F&&h.A==0&&!h.C&&(h.C=Qn(d(h.Va,h),6e3));Rl(h.h)<=1&&h.ta&&(h.ta=void 0)}else qt(h,11)}else if((o.L||h.g==o)&&si(h),!y(c))for(T=h.Ba.g.parse(c),c=0;c<T.length;c++){let Y=T[c],he=Y[0];if(!(he<=h.K))if(h.K=he,Y=Y[1],h.I==2)if(Y[0]=="c"){h.M=Y[1],h.ba=Y[2];let qe=Y[3];qe!=null&&(h.ka=qe,h.j.info("VER="+h.ka));let zt=Y[4];zt!=null&&(h.za=zt,h.j.info("SVER="+h.za));let yt=Y[5];yt!=null&&typeof yt=="number"&&yt>0&&(f=1.5*yt,h.O=f,h.j.info("backChannelRequestTimeoutMs_="+f)),f=h;let It=o.g;if(It){let ai=It.g?It.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ai){var b=f.h;b.g||ai.indexOf("spdy")==-1&&ai.indexOf("quic")==-1&&ai.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(ho(b,b.h),b.h=null))}if(f.G){let yo=It.g?It.g.getResponseHeader("X-HTTP-Session-Id"):null;yo&&(f.wa=yo,Z(f.J,f.G,yo))}}h.I=3,h.l&&h.l.ra(),h.aa&&(h.T=Date.now()-o.F,h.j.info("Handshake RTT: "+h.T+"ms")),f=h;var k=o;if(f.na=Xl(f,f.L?f.ba:null,f.W),k.L){Cl(f.h,k);var q=k,le=f.O;le&&(q.H=le),q.D&&(co(q),Xr(q)),f.g=k}else Hl(f);h.i.length>0&&ii(h)}else Y[0]!="stop"&&Y[0]!="close"||qt(h,7);else h.I==3&&(Y[0]=="stop"||Y[0]=="close"?Y[0]=="stop"?qt(h,7):mo(h):Y[0]!="noop"&&h.l&&h.l.qa(Y),h.A=0)}}Wn(4)}catch{}}var Hm=class{constructor(o,c){this.g=o,this.map=c}};function bl(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Sl(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Rl(o){return o.h?1:o.g?o.g.size:0}function lo(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function ho(o,c){o.g?o.g.add(c):o.h=c}function Cl(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}bl.prototype.cancel=function(){if(this.i=Pl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Pl(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let c=o.i;for(let h of o.g.values())c=c.concat(h.G);return c}return S(o.i)}var Nl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wm(o,c){if(o){o=o.split("&");for(let h=0;h<o.length;h++){let f=o[h].indexOf("="),T,b=null;f>=0?(T=o[h].substring(0,f),b=o[h].substring(f+1)):T=o[h],c(T,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function mt(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let c;o instanceof mt?(this.l=o.l,Zn(this,o.j),this.o=o.o,this.g=o.g,er(this,o.u),this.h=o.h,fo(this,Ll(o.i)),this.m=o.m):o&&(c=String(o).match(Nl))?(this.l=!1,Zn(this,c[1]||"",!0),this.o=tr(c[2]||""),this.g=tr(c[3]||"",!0),er(this,c[4]),this.h=tr(c[5]||"",!0),fo(this,c[6]||"",!0),this.m=tr(c[7]||"")):(this.l=!1,this.i=new rr(null,this.l))}mt.prototype.toString=function(){let o=[];var c=this.j;c&&o.push(nr(c,Dl,!0),":");var h=this.g;return(h||c=="file")&&(o.push("//"),(c=this.o)&&o.push(nr(c,Dl,!0),"@"),o.push(Yn(h).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.u,h!=null&&o.push(":",String(h))),(h=this.h)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(nr(h,h.charAt(0)=="/"?Ym:Jm,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",nr(h,Zm)),o.join("")},mt.prototype.resolve=function(o){let c=Be(this),h=!!o.j;h?Zn(c,o.j):h=!!o.o,h?c.o=o.o:h=!!o.g,h?c.g=o.g:h=o.u!=null;var f=o.h;if(h)er(c,o.u);else if(h=!!o.h){if(f.charAt(0)!="/")if(this.g&&!this.h)f="/"+f;else{var T=c.h.lastIndexOf("/");T!=-1&&(f=c.h.slice(0,T+1)+f)}if(T=f,T==".."||T==".")f="";else if(T.indexOf("./")!=-1||T.indexOf("/.")!=-1){f=T.lastIndexOf("/",0)==0,T=T.split("/");let b=[];for(let k=0;k<T.length;){let q=T[k++];q=="."?f&&k==T.length&&b.push(""):q==".."?((b.length>1||b.length==1&&b[0]!="")&&b.pop(),f&&k==T.length&&b.push("")):(b.push(q),f=!0)}f=b.join("/")}else f=T}return h?c.h=f:h=o.i.toString()!=="",h?fo(c,Ll(o.i)):h=!!o.m,h&&(c.m=o.m),c};function Be(o){return new mt(o)}function Zn(o,c,h){o.j=h?tr(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function er(o,c){if(c){if(c=Number(c),isNaN(c)||c<0)throw Error("Bad port number "+c);o.u=c}else o.u=null}function fo(o,c,h){c instanceof rr?(o.i=c,eg(o.i,o.l)):(h||(c=nr(c,Xm)),o.i=new rr(c,o.l))}function Z(o,c,h){o.i.set(c,h)}function Zr(o){return Z(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function tr(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function nr(o,c,h){return typeof o=="string"?(o=encodeURI(o).replace(c,Qm),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Qm(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Dl=/[#\/\?@]/g,Jm=/[#\?:]/g,Ym=/[#\?]/g,Xm=/[#\?@]/g,Zm=/#/g;function rr(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function Bt(o){o.g||(o.g=new Map,o.h=0,o.i&&Wm(o.i,function(c,h){o.add(decodeURIComponent(c.replace(/\+/g," ")),h)}))}n=rr.prototype,n.add=function(o,c){Bt(this),this.i=null,o=ln(this,o);let h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(c),this.h+=1,this};function kl(o,c){Bt(o),c=ln(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function Ol(o,c){return Bt(o),c=ln(o,c),o.g.has(c)}n.forEach=function(o,c){Bt(this),this.g.forEach(function(h,f){h.forEach(function(T){o.call(c,T,f,this)},this)},this)};function Vl(o,c){Bt(o);let h=[];if(typeof c=="string")Ol(o,c)&&(h=h.concat(o.g.get(ln(o,c))));else for(o=Array.from(o.g.values()),c=0;c<o.length;c++)h=h.concat(o[c]);return h}n.set=function(o,c){return Bt(this),this.i=null,o=ln(this,o),Ol(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},n.get=function(o,c){return o?(o=Vl(this,o),o.length>0?String(o[0]):c):c};function xl(o,c,h){kl(o,c),h.length>0&&(o.i=null,o.g.set(ln(o,c),S(h)),o.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],c=Array.from(this.g.keys());for(let f=0;f<c.length;f++){var h=c[f];let T=Yn(h);h=Vl(this,h);for(let b=0;b<h.length;b++){let k=T;h[b]!==""&&(k+="="+Yn(h[b])),o.push(k)}}return this.i=o.join("&")};function Ll(o){let c=new rr;return c.i=o.i,o.g&&(c.g=new Map(o.g),c.h=o.h),c}function ln(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function eg(o,c){c&&!o.j&&(Bt(o),o.i=null,o.g.forEach(function(h,f){let T=f.toLowerCase();f!=T&&(kl(this,f),xl(this,T,h))},o)),o.j=c}function tg(o,c){let h=new Jn;if(a.Image){let f=new Image;f.onload=p(gt,h,"TestLoadImage: loaded",!0,c,f),f.onerror=p(gt,h,"TestLoadImage: error",!1,c,f),f.onabort=p(gt,h,"TestLoadImage: abort",!1,c,f),f.ontimeout=p(gt,h,"TestLoadImage: timeout",!1,c,f),a.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else c(!1)}function ng(o,c){let h=new Jn,f=new AbortController,T=setTimeout(()=>{f.abort(),gt(h,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:f.signal}).then(b=>{clearTimeout(T),b.ok?gt(h,"TestPingServer: ok",!0,c):gt(h,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(T),gt(h,"TestPingServer: error",!1,c)})}function gt(o,c,h,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(h)}catch{}}function rg(){this.g=new Um}function ei(o){this.i=o.Sb||null,this.h=o.ab||!1}m(ei,dl),ei.prototype.g=function(){return new ti(this.i,this.h)};function ti(o,c){Ie.call(this),this.H=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(ti,Ie),n=ti.prototype,n.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=c,this.readyState=1,sr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let c={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(c.body=o),(this.H||a).fetch(new Request(this.D,c)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ir(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,sr(this)),this.g&&(this.readyState=3,sr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ml(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ml(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.B.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?ir(this):sr(this),this.readyState==3&&Ml(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,ir(this))},n.Na=function(o){this.g&&(this.response=o,ir(this))},n.ga=function(){this.g&&ir(this)};function ir(o){o.readyState=4,o.l=null,o.j=null,o.B=null,sr(o)}n.setRequestHeader=function(o,c){this.A.append(o,c)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],c=this.h.entries();for(var h=c.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=c.next();return o.join(`\r
`)};function sr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(ti.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Fl(o){let c="";return Hr(o,function(h,f){c+=f,c+=":",c+=h,c+=`\r
`}),c}function po(o,c,h){e:{for(f in h){var f=!1;break e}f=!0}f||(h=Fl(h),typeof o=="string"?h!=null&&Yn(h):Z(o,c,h))}function ne(o){Ie.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(ne,Ie);var ig=/^https?$/i,sg=["POST","PUT"];n=ne.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,c,h,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Il.g(),this.g.onreadystatechange=_(d(this.Ca,this));try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(b){Ul(this,b);return}if(o=h||"",h=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)h.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let b of f.keys())h.set(b,f.get(b));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(h.keys()).find(b=>b.toLowerCase()=="content-type"),T=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(sg,c,void 0)>=0)||f||T||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,k]of h)this.g.setRequestHeader(b,k);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(b){Ul(this,b)}};function Ul(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.o=5,Bl(o),ni(o)}function Bl(o){o.A||(o.A=!0,ve(o,"complete"),ve(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,ve(this,"complete"),ve(this,"abort"),ni(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ni(this,!0)),ne.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ql(this):this.Xa())},n.Xa=function(){ql(this)};function ql(o){if(o.h&&typeof s<"u"){if(o.v&&_t(o)==4)setTimeout(o.Ca.bind(o),0);else if(ve(o,"readystatechange"),_t(o)==4){o.h=!1;try{let b=o.ca();e:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var h;if(!(h=c)){var f;if(f=b===0){let k=String(o.D).match(Nl)[1]||null;!k&&a.self&&a.self.location&&(k=a.self.location.protocol.slice(0,-1)),f=!ig.test(k?k.toLowerCase():"")}h=f}if(h)ve(o,"complete"),ve(o,"success");else{o.o=6;try{var T=_t(o)>2?o.g.statusText:""}catch{T=""}o.l=T+" ["+o.ca()+"]",Bl(o)}}finally{ni(o)}}}}function ni(o,c){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);let h=o.g;o.g=null,c||ve(o,"ready");try{h.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function _t(o){return o.g?o.g.readyState:0}n.ca=function(){try{return _t(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),Fm(c)}};function zl(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function og(o){let c={};o=(o.g&&_t(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(y(o[f]))continue;var h=$m(o[f]);let T=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let b=c[T]||[];c[T]=b,b.push(h)}Om(c,function(f){return f.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function or(o,c,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||c}function jl(o){this.za=0,this.i=[],this.j=new Jn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=or("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=or("baseRetryDelayMs",5e3,o),this.Za=or("retryDelaySeedMs",1e4,o),this.Ta=or("forwardChannelMaxRetries",2,o),this.va=or("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new bl(o&&o.concurrentRequestLimit),this.Ba=new rg,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=jl.prototype,n.ka=8,n.I=1,n.connect=function(o,c,h,f){Te(0),this.W=o,this.H=c||{},h&&f!==void 0&&(this.H.OSID=h,this.H.OAID=f),this.F=this.X,this.J=Xl(this,null,this.W),ii(this)};function mo(o){if($l(o),o.I==3){var c=o.V++,h=Be(o.J);if(Z(h,"SID",o.M),Z(h,"RID",c),Z(h,"TYPE","terminate"),ar(o,h),c=new pt(o,o.j,c),c.M=2,c.A=Zr(Be(h)),h=!1,a.navigator&&a.navigator.sendBeacon)try{h=a.navigator.sendBeacon(c.A.toString(),"")}catch{}!h&&a.Image&&(new Image().src=c.A,h=!0),h||(c.g=Zl(c.j,null),c.g.ea(c.A)),c.F=Date.now(),Xr(c)}Yl(o)}function ri(o){o.g&&(_o(o),o.g.cancel(),o.g=null)}function $l(o){ri(o),o.v&&(a.clearTimeout(o.v),o.v=null),si(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function ii(o){if(!Sl(o.h)&&!o.m){o.m=!0;var c=o.Ea;ge||g(),ie||(ge(),ie=!0),w.add(c,o),o.D=0}}function ag(o,c){return Rl(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=c.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Qn(d(o.Ea,o,c),Jl(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;let T=new pt(this,this.j,o),b=this.o;if(this.U&&(b?(b=tl(b),rl(b,this.U)):b=this.U),this.u!==null||this.R||(T.J=b,b=null),this.S)e:{for(var c=0,h=0;h<this.i.length;h++){t:{var f=this.i[h];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,c>4096){c=h;break e}if(c===4096||h===this.i.length-1){c=h+1;break e}}c=1e3}else c=1e3;c=Kl(this,T,c),h=Be(this.J),Z(h,"RID",o),Z(h,"CVER",22),this.G&&Z(h,"X-HTTP-Session-Id",this.G),ar(this,h),b&&(this.R?c="headers="+Yn(Fl(b))+"&"+c:this.u&&po(h,this.u,b)),ho(this.h,T),this.Ra&&Z(h,"TYPE","init"),this.S?(Z(h,"$req",c),Z(h,"SID","null"),T.U=!0,ao(T,h,null)):ao(T,h,c),this.I=2}}else this.I==3&&(o?Gl(this,o):this.i.length==0||Sl(this.h)||Gl(this))};function Gl(o,c){var h;c?h=c.l:h=o.V++;let f=Be(o.J);Z(f,"SID",o.M),Z(f,"RID",h),Z(f,"AID",o.K),ar(o,f),o.u&&o.o&&po(f,o.u,o.o),h=new pt(o,o.j,h,o.D+1),o.u===null&&(h.J=o.o),c&&(o.i=c.G.concat(o.i)),c=Kl(o,h,1e3),h.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),ho(o.h,h),ao(h,f,c)}function ar(o,c){o.H&&Hr(o.H,function(h,f){Z(c,f,h)}),o.l&&Hr({},function(h,f){Z(c,f,h)})}function Kl(o,c,h){h=Math.min(o.i.length,h);let f=o.l?d(o.l.Ka,o.l,o):null;e:{var T=o.i;let q=-1;for(;;){let le=["count="+h];q==-1?h>0?(q=T[0].g,le.push("ofs="+q)):q=0:le.push("ofs="+q);let Y=!0;for(let he=0;he<h;he++){var b=T[he].g;let qe=T[he].map;if(b-=q,b<0)q=Math.max(0,T[he].g-100),Y=!1;else try{b="req"+b+"_"||"";try{var k=qe instanceof Map?qe:Object.entries(qe);for(let[zt,yt]of k){let It=yt;u(yt)&&(It=no(yt)),le.push(b+zt+"="+encodeURIComponent(It))}}catch(zt){throw le.push(b+"type="+encodeURIComponent("_badmap")),zt}}catch{f&&f(qe)}}if(Y){k=le.join("&");break e}}k=void 0}return o=o.i.splice(0,h),c.G=o,k}function Hl(o){if(!o.g&&!o.v){o.Y=1;var c=o.Da;ge||g(),ie||(ge(),ie=!0),w.add(c,o),o.A=0}}function go(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Qn(d(o.Da,o),Jl(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,Wl(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Qn(d(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Te(10),ri(this),Wl(this))};function _o(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function Wl(o){o.g=new pt(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var c=Be(o.na);Z(c,"RID","rpc"),Z(c,"SID",o.M),Z(c,"AID",o.K),Z(c,"CI",o.F?"0":"1"),!o.F&&o.ia&&Z(c,"TO",o.ia),Z(c,"TYPE","xmlhttp"),ar(o,c),o.u&&o.o&&po(c,o.u,o.o),o.O&&(o.g.H=o.O);var h=o.g;o=o.ba,h.M=1,h.A=Zr(Be(c)),h.u=null,h.R=!0,vl(h,o)}n.Va=function(){this.C!=null&&(this.C=null,ri(this),go(this),Te(19))};function si(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function Ql(o,c){var h=null;if(o.g==c){si(o),_o(o),o.g=null;var f=2}else if(lo(o.h,c))h=c.G,Cl(o.h,c),f=1;else return;if(o.I!=0){if(c.o)if(f==1){h=c.u?c.u.length:0,c=Date.now()-c.F;var T=o.D;f=Jr(),ve(f,new _l(f,h)),ii(o)}else Hl(o);else if(T=c.m,T==3||T==0&&c.X>0||!(f==1&&ag(o,c)||f==2&&go(o)))switch(h&&h.length>0&&(c=o.h,c.i=c.i.concat(h)),T){case 1:qt(o,5);break;case 4:qt(o,10);break;case 3:qt(o,6);break;default:qt(o,2)}}}function Jl(o,c){let h=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(h*=2),h*c}function qt(o,c){if(o.j.info("Error code "+c),c==2){var h=d(o.bb,o),f=o.Ua;let T=!f;f=new mt(f||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Zn(f,"https"),Zr(f),T?tg(f.toString(),h):ng(f.toString(),h)}else Te(2);o.I=0,o.l&&o.l.pa(c),Yl(o),$l(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),Te(2)):(this.j.info("Failed to ping google.com"),Te(1))};function Yl(o){if(o.I=0,o.ja=[],o.l){let c=Pl(o.h);(c.length!=0||o.i.length!=0)&&(P(o.ja,c),P(o.ja,o.i),o.h.i.length=0,S(o.i),o.i.length=0),o.l.oa()}}function Xl(o,c,h){var f=h instanceof mt?Be(h):new mt(h);if(f.g!="")c&&(f.g=c+"."+f.g),er(f,f.u);else{var T=a.location;f=T.protocol,c=c?c+"."+T.hostname:T.hostname,T=+T.port;let b=new mt(null);f&&Zn(b,f),c&&(b.g=c),T&&er(b,T),h&&(b.h=h),f=b}return h=o.G,c=o.wa,h&&c&&Z(f,h,c),Z(f,"VER",o.ka),ar(o,f),f}function Zl(o,c,h){if(c&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Aa&&!o.ma?new ne(new ei({ab:h})):new ne(o.ma),c.Fa(o.L),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function eh(){}n=eh.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function oi(){}oi.prototype.g=function(o,c){return new Ne(o,c)};function Ne(o,c){Ie.call(this),this.g=new jl(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.sa&&(o?o["X-WebChannel-Client-Profile"]=c.sa:o={"X-WebChannel-Client-Profile":c.sa}),this.g.U=o,(o=c&&c.Qb)&&!y(o)&&(this.g.u=o),this.A=c&&c.supportsCrossDomainXhr||!1,this.v=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!y(c)&&(this.g.G=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new hn(this)}m(Ne,Ie),Ne.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ne.prototype.close=function(){mo(this.g)},Ne.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.v&&(h={},h.__data__=no(o),o=h);c.i.push(new Hm(c.Ya++,o)),c.I==3&&ii(c)},Ne.prototype.N=function(){this.g.l=null,delete this.j,mo(this.g),delete this.g,Ne.Z.N.call(this)};function th(o){ro.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(let h in c){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}m(th,ro);function nh(){io.call(this),this.status=1}m(nh,io);function hn(o){this.g=o}m(hn,eh),hn.prototype.ra=function(){ve(this.g,"a")},hn.prototype.qa=function(o){ve(this.g,new th(o))},hn.prototype.pa=function(o){ve(this.g,new nh)},hn.prototype.oa=function(){ve(this.g,"b")},oi.prototype.createWebChannel=oi.prototype.g,Ne.prototype.send=Ne.prototype.o,Ne.prototype.open=Ne.prototype.m,Ne.prototype.close=Ne.prototype.close,ka=rt.createWebChannelTransport=function(){return new oi},Da=rt.getStatEventTarget=function(){return Jr()},Na=rt.Event=Ft,ji=rt.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Yr.NO_ERROR=0,Yr.TIMEOUT=8,Yr.HTTP_ERROR=6,Tr=rt.ErrorCode=Yr,yl.COMPLETE="complete",Pa=rt.EventType=yl,fl.EventType=Hn,Hn.OPEN="a",Hn.CLOSE="b",Hn.ERROR="c",Hn.MESSAGE="d",Ie.prototype.listen=Ie.prototype.J,yn=rt.WebChannel=fl,fI=rt.FetchXmlHttpFactory=ei,ne.prototype.listenOnce=ne.prototype.K,ne.prototype.getLastError=ne.prototype.Ha,ne.prototype.getLastErrorCode=ne.prototype.ya,ne.prototype.getStatus=ne.prototype.ca,ne.prototype.getResponseJson=ne.prototype.La,ne.prototype.getResponseText=ne.prototype.la,ne.prototype.send=ne.prototype.ea,ne.prototype.setWithCredentials=ne.prototype.Fa,Ca=rt.XhrIo=ne}).apply(typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{});var Zd="@firebase/firestore",ef="4.9.3";var fe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};fe.UNAUTHENTICATED=new fe(null),fe.GOOGLE_CREDENTIALS=new fe("google-credentials-uid"),fe.FIRST_PARTY=new fe("first-party-uid"),fe.MOCK_USER=new fe("mock-user");var qn="12.7.0";var Zt=new Et("@firebase/firestore");function In(){return Zt.logLevel}function V(n,...e){if(Zt.logLevel<=j.DEBUG){let t=e.map(Au);Zt.debug(`Firestore (${qn}): ${n}`,...t)}}function st(n,...e){if(Zt.logLevel<=j.ERROR){let t=e.map(Au);Zt.error(`Firestore (${qn}): ${n}`,...t)}}function Cn(n,...e){if(Zt.logLevel<=j.WARN){let t=e.map(Au);Zt.warn(`Firestore (${qn}): ${n}`,...t)}}function Au(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function L(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,jf(n,r,t)}function jf(n,e,t){let r=`FIRESTORE (${qn}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw st(r),new Error(r)}function J(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||jf(e,i,r)}function F(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},D=class extends Ae{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Me=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Ji=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Fa=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(fe.UNAUTHENTICATED))}shutdown(){}},Ua=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Ba=class{constructor(e){this.t=e,this.currentUser=fe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){J(this.o===void 0,42304);let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),s=new Me;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Me,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},u=l=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?u(l):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Me)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(J(typeof r.accessToken=="string",31837,{l:r}),new Ji(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return J(e===null||typeof e=="string",2055,{h:e}),new fe(e)}},qa=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=fe.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},za=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new qa(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(fe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Yi=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},ja=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,be(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){J(this.o===void 0,3512);let r=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.m;return this.m=s.token,V("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Yi(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(J(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Yi(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function pI(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Cr=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=pI(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function G(n,e){return n<e?-1:n>e?1:0}function $a(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),s=e.charAt(r);if(i!==s)return Oa(i)===Oa(s)?G(i,s):Oa(i)?1:-1}return G(n.length,e.length)}var mI=55296,gI=57343;function Oa(n){let e=n.charCodeAt(0);return e>=mI&&e<=gI}function Pn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var tf="__name__",Xi=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&L(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&L(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return G(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):$a(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return nt.fromString(e.substring(4,e.length-2))}},ee=class n extends Xi{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new D(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},_I=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ke=class n extends Xi{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return _I.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===tf}static keyField(){return new n([tf])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new D(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new D(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new D(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new D(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var x=class n{constructor(e){this.path=e}static fromPath(e){return new n(ee.fromString(e))}static fromName(e){return new n(ee.fromString(e).popFirst(5))}static empty(){return new n(ee.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ee.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ee.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ee(e.slice()))}};function $f(n,e,t){if(!t)throw new D(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function yI(n,e,t,r){if(e===!0&&r===!0)throw new D(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function nf(n){if(!x.isDocumentKey(n))throw new D(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function rf(n){if(x.isDocumentKey(n))throw new D(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Gf(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ks(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":L(12329,{type:typeof n})}function ot(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new D(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ks(n);throw new D(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function II(n,e){if(e<=0)throw new D(R.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function ce(n,e){let t={typeString:n};return e&&(t.value=e),t}function Br(n,e){if(!Gf(n))throw new D(R.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new D(R.INVALID_ARGUMENT,t);return!0}var sf=-62135596800,of=1e6,ue=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*of);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new D(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new D(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<sf)throw new D(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/of}_compareTo(e){return this.seconds===e.seconds?G(this.nanoseconds,e.nanoseconds):G(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Br(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-sf;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};ue._jsonSchemaVersion="firestore/timestamp/1.0",ue._jsonSchema={type:ce("string",ue._jsonSchemaVersion),seconds:ce("number"),nanoseconds:ce("number")};var U=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new ue(0,0))}static max(){return new n(new ue(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Pr=-1,Ga=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Ga.UNKNOWN_ID=-1;function EI(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=U.fromTimestamp(r===1e9?new ue(t+1,0):new ue(t,r));return new en(i,x.empty(),e)}function wI(n){return new en(n.readTime,n.key,Pr)}var en=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(U.min(),x.empty(),Pr)}static max(){return new n(U.max(),x.empty(),Pr)}};function vI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=x.comparator(n.documentKey,e.documentKey),t!==0?t:G(n.largestBatchId,e.largestBatchId))}var TI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ka=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function zn(n){if(n.code!==R.FAILED_PRECONDITION||n.message!==TI)throw n;V("LocalStore","Unexpectedly lost primary lease")}var C=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&L(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),u=0;for(let l=0;l<s;l++){let d=l;t(e[d]).next(p=>{a[d]=p,++u,u===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function AI(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function jn(n){return n.name==="IndexedDbTransactionError"}var bu=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>r.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),Su=-1;function Os(n){return n==null}function Nr(n){return n===0&&1/n==-1/0}function bI(n){return typeof n=="number"&&Number.isInteger(n)&&!Nr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Kf="";function SI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=af(e)),e=RI(n.get(t),e);return af(e)}function RI(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case Kf:t+="";break;default:t+=s}}return t}function af(n){return n+Kf+""}var CI="remoteDocuments",Hf="owner";var Wf="mutationQueues";var Qf="mutations";var Jf="documentMutations",PI="remoteDocumentsV14";var Yf="remoteDocumentGlobal";var Xf="targets";var Zf="targetDocuments";var ep="targetGlobal",tp="collectionParents";var np="clientMetadata";var rp="bundles";var ip="namedQueries";var NI="indexConfiguration";var DI="indexState";var kI="indexEntries";var sp="documentOverlays";var OI="globals";var VI=[Wf,Qf,Jf,CI,Xf,Hf,ep,Zf,np,Yf,tp,rp,ip],wA=[...VI,sp],xI=[Wf,Qf,Jf,PI,Xf,Hf,ep,Zf,np,Yf,tp,rp,ip,sp],LI=xI,MI=[...LI,NI,DI,kI];var vA=[...MI,OI];function cf(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Mt(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function op(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var re=class n{constructor(e,t){this.comparator=e,this.root=t||He.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,He.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,He.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Tn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Tn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Tn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Tn(this.root,e,this.comparator,!0)}},Tn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},He=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw L(43730,{key:this.key,value:this.value});if(this.right.isRed())throw L(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw L(27949);return e+(this.isRed()?0:1)}};He.EMPTY=null,He.RED=!0,He.BLACK=!1;He.EMPTY=new class{constructor(){this.size=0}get key(){throw L(57766)}get value(){throw L(16141)}get color(){throw L(16727)}get left(){throw L(29726)}get right(){throw L(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new He(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var pe=class n{constructor(e){this.comparator=e,this.data=new re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Zi(this.data.getIterator())}getIteratorFrom(e){return new Zi(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Zi=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Ve=class n{constructor(e){this.fields=e,e.sort(ke.comparator)}static empty(){return new n([])}unionWith(e){let t=new pe(ke.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Pn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var es=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var we=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new es("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return G(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};we.EMPTY_BYTE_STRING=new we("");var FI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function at(n){if(J(!!n,39018),typeof n=="string"){let e=0,t=FI.exec(n);if(J(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:te(n.seconds),nanos:te(n.nanos)}}function te(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ct(n){return typeof n=="string"?we.fromBase64String(n):we.fromUint8Array(n)}var ap="server_timestamp",cp="__type__",up="__previous_value__",lp="__local_write_time__";function Vs(n){return(n?.mapValue?.fields||{})[cp]?.stringValue===ap}function xs(n){let e=n.mapValue.fields[up];return Vs(e)?xs(e):e}function Dr(n){let e=at(n.mapValue.fields[lp].timestampValue);return new ue(e.seconds,e.nanos)}var Ha=class{constructor(e,t,r,i,s,a,u,l,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=p}},ts="(default)",ns=class n{constructor(e,t){this.projectId=e,this.database=t||ts}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===ts}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ru="__type__",hp="__max__",$i={mapValue:{fields:{__type__:{stringValue:hp}}}},Cu="__vector__",Nn="value";function kt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Vs(n)?4:fp(n)?9007199254740991:dp(n)?10:11:L(28295,{value:n})}function Je(n,e){if(n===e)return!0;let t=kt(n);if(t!==kt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Dr(n).isEqual(Dr(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=at(i.timestampValue),u=at(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return ct(i.bytesValue).isEqual(ct(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return te(i.geoPointValue.latitude)===te(s.geoPointValue.latitude)&&te(i.geoPointValue.longitude)===te(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return te(i.integerValue)===te(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=te(i.doubleValue),u=te(s.doubleValue);return a===u?Nr(a)===Nr(u):isNaN(a)&&isNaN(u)}return!1})(n,e);case 9:return Pn(n.arrayValue.values||[],e.arrayValue.values||[],Je);case 10:case 11:return(function(i,s){let a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(cf(a)!==cf(u))return!1;for(let l in a)if(a.hasOwnProperty(l)&&(u[l]===void 0||!Je(a[l],u[l])))return!1;return!0})(n,e);default:return L(52216,{left:n})}}function kr(n,e){return(n.values||[]).find(t=>Je(t,e))!==void 0}function Dn(n,e){if(n===e)return 0;let t=kt(n),r=kt(e);if(t!==r)return G(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return G(n.booleanValue,e.booleanValue);case 2:return(function(s,a){let u=te(s.integerValue||s.doubleValue),l=te(a.integerValue||a.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1})(n,e);case 3:return uf(n.timestampValue,e.timestampValue);case 4:return uf(Dr(n),Dr(e));case 5:return $a(n.stringValue,e.stringValue);case 6:return(function(s,a){let u=ct(s),l=ct(a);return u.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){let u=s.split("/"),l=a.split("/");for(let d=0;d<u.length&&d<l.length;d++){let p=G(u[d],l[d]);if(p!==0)return p}return G(u.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){let u=G(te(s.latitude),te(a.latitude));return u!==0?u:G(te(s.longitude),te(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return lf(n.arrayValue,e.arrayValue);case 10:return(function(s,a){let u=s.fields||{},l=a.fields||{},d=u[Nn]?.arrayValue,p=l[Nn]?.arrayValue,m=G(d?.values?.length||0,p?.values?.length||0);return m!==0?m:lf(d,p)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===$i.mapValue&&a===$i.mapValue)return 0;if(s===$i.mapValue)return 1;if(a===$i.mapValue)return-1;let u=s.fields||{},l=Object.keys(u),d=a.fields||{},p=Object.keys(d);l.sort(),p.sort();for(let m=0;m<l.length&&m<p.length;++m){let _=$a(l[m],p[m]);if(_!==0)return _;let S=Dn(u[l[m]],d[p[m]]);if(S!==0)return S}return G(l.length,p.length)})(n.mapValue,e.mapValue);default:throw L(23264,{he:t})}}function uf(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return G(n,e);let t=at(n),r=at(e),i=G(t.seconds,r.seconds);return i!==0?i:G(t.nanos,r.nanos)}function lf(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Dn(t[i],r[i]);if(s)return s}return G(t.length,r.length)}function kn(n){return Wa(n)}function Wa(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=at(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ct(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return x.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Wa(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${Wa(t.fields[a])}`;return i+"}"})(n.mapValue):L(61005,{value:n})}function Hi(n){switch(kt(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=xs(n);return e?16+Hi(e):16;case 5:return 2*n.stringValue.length;case 6:return ct(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+Hi(s),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Mt(r.fields,(s,a)=>{i+=s.length+Hi(a)}),i})(n.mapValue);default:throw L(13486,{value:n})}}function rs(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Qa(n){return!!n&&"integerValue"in n}function Pu(n){return!!n&&"arrayValue"in n}function hf(n){return!!n&&"nullValue"in n}function df(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Wi(n){return!!n&&"mapValue"in n}function dp(n){return(n?.mapValue?.fields||{})[Ru]?.stringValue===Cu}function br(n){if(n.geoPointValue)return{geoPointValue:H({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:H({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Mt(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=br(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=br(n.arrayValue.values[t]);return e}return H({},n)}function fp(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===hp}var AA={mapValue:{fields:{[Ru]:{stringValue:Cu},[Nn]:{arrayValue:{}}}}};var De=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Wi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=br(t)}setAll(e){let t=ke.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=br(a):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Wi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Je(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Wi(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Mt(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(br(this.value))}};function pp(n){let e=[];return Mt(n.fields,(t,r)=>{let i=new ke([t]);if(Wi(r)){let s=pp(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new Ve(e)}var Fe=class n{constructor(e,t,r,i,s,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,U.min(),U.min(),U.min(),De.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,U.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,U.min(),U.min(),De.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,U.min(),U.min(),De.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(U.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=De.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=De.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=U.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ot=class{constructor(e,t){this.position=e,this.inclusive=t}};function ff(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=x.comparator(x.fromName(a.referenceValue),t.key):r=Dn(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function pf(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Je(n.position[t],e.position[t]))return!1;return!0}var tn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function UI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var is=class{},ae=class n extends is{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Ya(e,t,r):t==="array-contains"?new ec(e,r):t==="in"?new tc(e,r):t==="not-in"?new nc(e,r):t==="array-contains-any"?new rc(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Xa(e,r):new Za(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Dn(t,this.value)):t!==null&&kt(this.value)===kt(t)&&this.matchesComparison(Dn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ue=class n extends is{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return mp(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function mp(n){return n.op==="and"}function gp(n){return BI(n)&&mp(n)}function BI(n){for(let e of n.filters)if(e instanceof Ue)return!1;return!0}function Ja(n){if(n instanceof ae)return n.field.canonicalString()+n.op.toString()+kn(n.value);if(gp(n))return n.filters.map(e=>Ja(e)).join(",");{let e=n.filters.map(t=>Ja(t)).join(",");return`${n.op}(${e})`}}function _p(n,e){return n instanceof ae?(function(r,i){return i instanceof ae&&r.op===i.op&&r.field.isEqual(i.field)&&Je(r.value,i.value)})(n,e):n instanceof Ue?(function(r,i){return i instanceof Ue&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,u)=>s&&_p(a,i.filters[u]),!0):!1})(n,e):void L(19439)}function yp(n){return n instanceof ae?(function(t){return`${t.field.canonicalString()} ${t.op} ${kn(t.value)}`})(n):n instanceof Ue?(function(t){return t.op.toString()+" {"+t.getFilters().map(yp).join(" ,")+"}"})(n):"Filter"}var Ya=class extends ae{constructor(e,t,r){super(e,t,r),this.key=x.fromName(r.referenceValue)}matches(e){let t=x.comparator(e.key,this.key);return this.matchesComparison(t)}},Xa=class extends ae{constructor(e,t){super(e,"in",t),this.keys=Ip("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Za=class extends ae{constructor(e,t){super(e,"not-in",t),this.keys=Ip("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Ip(n,e){return(e.arrayValue?.values||[]).map(t=>x.fromName(t.referenceValue))}var ec=class extends ae{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Pu(t)&&kr(t.arrayValue,this.value)}},tc=class extends ae{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&kr(this.value.arrayValue,t)}},nc=class extends ae{constructor(e,t){super(e,"not-in",t)}matches(e){if(kr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!kr(this.value.arrayValue,t)}},rc=class extends ae{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Pu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>kr(this.value.arrayValue,r))}};var ic=class{constructor(e,t=null,r=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.Te=null}};function mf(n,e=null,t=[],r=[],i=null,s=null,a=null){return new ic(n,e,t,r,i,s,a)}function Nu(n){let e=F(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Ja(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),Os(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>kn(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>kn(r)).join(",")),e.Te=t}return e.Te}function Du(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!UI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_p(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!pf(n.startAt,e.startAt)&&pf(n.endAt,e.endAt)}function sc(n){return x.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var ut=class{constructor(e,t=null,r=[],i=[],s=null,a="F",u=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function qI(n,e,t,r,i,s,a,u){return new ut(n,e,t,r,i,s,a,u)}function ku(n){return new ut(n)}function gf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Ou(n){return n.collectionGroup!==null}function An(n){let e=F(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new pe(ke.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new tn(s,r))}),t.has(ke.keyField().canonicalString())||e.Ie.push(new tn(ke.keyField(),r))}return e.Ie}function We(n){let e=F(n);return e.Ee||(e.Ee=zI(e,An(n))),e.Ee}function zI(n,e){if(n.limitType==="F")return mf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new tn(i.field,s)});let t=n.endAt?new Ot(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ot(n.startAt.position,n.startAt.inclusive):null;return mf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function oc(n,e){let t=n.filters.concat([e]);return new ut(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ss(n,e,t){return new ut(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ls(n,e){return Du(We(n),We(e))&&n.limitType===e.limitType}function Ep(n){return`${Nu(We(n))}|lt:${n.limitType}`}function En(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>yp(i)).join(", ")}]`),Os(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>kn(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>kn(i)).join(",")),`Target(${r})`})(We(n))}; limitType=${n.limitType})`}function Ms(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):x.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of An(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,u,l){let d=ff(a,u,l);return a.inclusive?d<=0:d<0})(r.startAt,An(r),i)||r.endAt&&!(function(a,u,l){let d=ff(a,u,l);return a.inclusive?d>=0:d>0})(r.endAt,An(r),i))})(n,e)}function jI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wp(n){return(e,t)=>{let r=!1;for(let i of An(n)){let s=$I(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function $I(n,e,t){let r=n.field.isKeyField()?x.comparator(e.key,t.key):(function(s,a,u){let l=a.data.field(s),d=u.data.field(s);return l!==null&&d!==null?Dn(l,d):L(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return L(19790,{direction:n.dir})}}var lt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Mt(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return op(this.inner)}size(){return this.innerSize}};var GI=new re(x.comparator);function ht(){return GI}var vp=new re(x.comparator);function Ar(...n){let e=vp;for(let t of n)e=e.insert(t.key,t);return e}function Tp(n){let e=vp;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Qt(){return Sr()}function Ap(){return Sr()}function Sr(){return new lt(n=>n.toString(),(n,e)=>n.isEqual(e))}var KI=new re(x.comparator),HI=new pe(x.comparator);function K(...n){let e=HI;for(let t of n)e=e.add(t);return e}var WI=new pe(G);function QI(){return WI}function Vu(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nr(e)?"-0":e}}function bp(n){return{integerValue:""+n}}function JI(n,e){return bI(e)?bp(e):Vu(n,e)}var On=class{constructor(){this._=void 0}};function YI(n,e,t){return n instanceof nn?(function(i,s){let a={fields:{[cp]:{stringValue:ap},[lp]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Vs(s)&&(s=xs(s)),s&&(a.fields[up]=s),{mapValue:a}})(t,e):n instanceof rn?Rp(n,e):n instanceof sn?Cp(n,e):(function(i,s){let a=Sp(i,s),u=_f(a)+_f(i.Ae);return Qa(a)&&Qa(i.Ae)?bp(u):Vu(i.serializer,u)})(n,e)}function XI(n,e,t){return n instanceof rn?Rp(n,e):n instanceof sn?Cp(n,e):t}function Sp(n,e){return n instanceof Vn?(function(r){return Qa(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var nn=class extends On{},rn=class extends On{constructor(e){super(),this.elements=e}};function Rp(n,e){let t=Pp(e);for(let r of n.elements)t.some(i=>Je(i,r))||t.push(r);return{arrayValue:{values:t}}}var sn=class extends On{constructor(e){super(),this.elements=e}};function Cp(n,e){let t=Pp(e);for(let r of n.elements)t=t.filter(i=>!Je(i,r));return{arrayValue:{values:t}}}var Vn=class extends On{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function _f(n){return te(n.integerValue||n.doubleValue)}function Pp(n){return Pu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var ac=class{constructor(e,t){this.field=e,this.transform=t}};function ZI(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof rn&&i instanceof rn||r instanceof sn&&i instanceof sn?Pn(r.elements,i.elements,Je):r instanceof Vn&&i instanceof Vn?Je(r.Ae,i.Ae):r instanceof nn&&i instanceof nn})(n.transform,e.transform)}var cc=class{constructor(e,t){this.version=e,this.transformResults=t}},it=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Qi(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var xn=class{};function Np(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Or(n.key,it.none()):new on(n.key,n.data,it.none());{let t=n.data,r=De.empty(),i=new pe(ke.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Ye(n.key,r,new Ve(i.toArray()),it.none())}}function eE(n,e,t){n instanceof on?(function(i,s,a){let u=i.value.clone(),l=If(i.fieldTransforms,s,a.transformResults);u.setAll(l),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()})(n,e,t):n instanceof Ye?(function(i,s,a){if(!Qi(i.precondition,s))return void s.convertToUnknownDocument(a.version);let u=If(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Dp(i)),l.setAll(u),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Rr(n,e,t,r){return n instanceof on?(function(s,a,u,l){if(!Qi(s.precondition,a))return u;let d=s.value.clone(),p=Ef(s.fieldTransforms,l,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Ye?(function(s,a,u,l){if(!Qi(s.precondition,a))return u;let d=Ef(s.fieldTransforms,l,a),p=a.data;return p.setAll(Dp(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))})(n,e,t,r):(function(s,a,u){return Qi(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u})(n,e,t)}function tE(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Sp(r.transform,i||null);s!=null&&(t===null&&(t=De.empty()),t.set(r.field,s))}return t||null}function yf(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Pn(r,i,(s,a)=>ZI(s,a))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var on=class extends xn{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Ye=class extends xn{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Dp(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function If(n,e,t){let r=new Map;J(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,XI(a,u,t[i]))}return r}function Ef(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,YI(s,a,e))}return r}var Or=class extends xn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},uc=class extends xn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var lc=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&eE(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Rr(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Rr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Ap();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,u=this.applyToLocalView(a,s.mutatedFields);u=t.has(i.key)?null:u;let l=Np(a,u);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(U.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),K())}isEqual(e){return this.batchId===e.batchId&&Pn(this.mutations,e.mutations,(t,r)=>yf(t,r))&&Pn(this.baseMutations,e.baseMutations,(t,r)=>yf(t,r))}},hc=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){J(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return KI})(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var dc=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var fc=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var se,W;function nE(n){switch(n){case R.OK:return L(64938);case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0;default:return L(15467,{code:n})}}function kp(n){if(n===void 0)return st("GRPC error has no .code"),R.UNKNOWN;switch(n){case se.OK:return R.OK;case se.CANCELLED:return R.CANCELLED;case se.UNKNOWN:return R.UNKNOWN;case se.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case se.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case se.INTERNAL:return R.INTERNAL;case se.UNAVAILABLE:return R.UNAVAILABLE;case se.UNAUTHENTICATED:return R.UNAUTHENTICATED;case se.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case se.NOT_FOUND:return R.NOT_FOUND;case se.ALREADY_EXISTS:return R.ALREADY_EXISTS;case se.PERMISSION_DENIED:return R.PERMISSION_DENIED;case se.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case se.ABORTED:return R.ABORTED;case se.OUT_OF_RANGE:return R.OUT_OF_RANGE;case se.UNIMPLEMENTED:return R.UNIMPLEMENTED;case se.DATA_LOSS:return R.DATA_LOSS;default:return L(39323,{code:n})}}(W=se||(se={}))[W.OK=0]="OK",W[W.CANCELLED=1]="CANCELLED",W[W.UNKNOWN=2]="UNKNOWN",W[W.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",W[W.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",W[W.NOT_FOUND=5]="NOT_FOUND",W[W.ALREADY_EXISTS=6]="ALREADY_EXISTS",W[W.PERMISSION_DENIED=7]="PERMISSION_DENIED",W[W.UNAUTHENTICATED=16]="UNAUTHENTICATED",W[W.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",W[W.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",W[W.ABORTED=10]="ABORTED",W[W.OUT_OF_RANGE=11]="OUT_OF_RANGE",W[W.UNIMPLEMENTED=12]="UNIMPLEMENTED",W[W.INTERNAL=13]="INTERNAL",W[W.UNAVAILABLE=14]="UNAVAILABLE",W[W.DATA_LOSS=15]="DATA_LOSS";var rE=null;function iE(){return new TextEncoder}var sE=new nt([4294967295,4294967295],0);function wf(n){let e=iE().encode(n),t=new Ra;return t.update(e),new Uint8Array(t.digest())}function vf(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new nt([t,r],0),new nt([i,s],0)]}var pc=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Jt(`Invalid padding: ${t}`);if(r<0)throw new Jt(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Jt(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Jt(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=nt.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(nt.fromNumber(r)));return i.compare(sE)===1&&(i=new nt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=wf(e),[r,i]=vf(t);for(let s=0;s<this.hashCount;s++){let a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.ge===0)return;let t=wf(e),[r,i]=vf(t);for(let s=0;s<this.hashCount;s++){let a=this.ye(r,i,s);this.Se(a)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Jt=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var os=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Vr.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(U.min(),i,new re(G),ht(),K())}},Vr=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,K(),K(),K())}};var bn=class{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}},as=class{constructor(e,t){this.targetId=e,this.Ce=t}},cs=class{constructor(e,t,r=we.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},us=class{constructor(){this.ve=0,this.Fe=Tf(),this.Me=we.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=K(),t=K(),r=K();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:L(38017,{changeType:s})}}),new Vr(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Tf()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,J(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}},mc=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=ht(),this.Je=Gi(),this.He=Gi(),this.Ye=new re(G)}Ze(e){for(let t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:L(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){let t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){let s=i.target;if(sc(s))if(r===0){let a=new x(s.path);this.et(t,a,Fe.newNoDocument(a,U.min()))}else J(r===1,20013,{expectedCount:r});else{let a=this._t(t);if(a!==r){let u=this.ut(e),l=u?this.ct(u,e,a):1;if(l!==0){this.it(t);let d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}rE?.lt((function(p,m,_,S,P){let O={localCacheCount:p,existenceFilterCount:m.count,databaseId:_.database,projectId:_.projectId},N=m.unchangedNames;return N&&(O.bloomFilter={applied:P===0,hashCount:N?.hashCount??0,bitmapLength:N?.bits?.bitmap?.length??0,padding:N?.bits?.padding??0,mightContain:B=>S?.mightContain(B)??!1}),O})(a,e.Ce,this.Ge.ht(),u,l))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,u;try{a=ct(r).toUint8Array()}catch(l){if(l instanceof es)return Cn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{u=new pc(a,i,s)}catch(l){return Cn(l instanceof Jt?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return u.ge===0?null:u}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.Ge.ht(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.et(t,s,null),i++)}),i}Tt(e){let t=new Map;this.ze.forEach((s,a)=>{let u=this.ot(a);if(u){if(s.current&&sc(u.target)){let l=new x(u.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Fe.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}});let r=K();this.He.forEach((s,a)=>{let u=!0;a.forEachWhile(l=>{let d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.je.forEach((s,a)=>a.setReadTime(e));let i=new os(e,t,this.Ye,this.je,r);return this.je=ht(),this.Je=Gi(),this.He=Gi(),this.Ye=new re(G),i}Xe(e,t){if(!this.rt(e))return;let r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new us,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new pe(G),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new pe(G),this.Je=this.Je.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new us),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Gi(){return new re(x.comparator)}function Tf(){return new re(x.comparator)}var oE={asc:"ASCENDING",desc:"DESCENDING"},aE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cE={and:"AND",or:"OR"},gc=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function _c(n,e){return n.useProto3Json||Os(e)?e:{value:e}}function ls(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Op(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function uE(n,e){return ls(n,e.toTimestamp())}function Qe(n){return J(!!n,49232),U.fromTimestamp((function(t){let r=at(t);return new ue(r.seconds,r.nanos)})(n))}function xu(n,e){return yc(n,e).canonicalString()}function yc(n,e){let t=(function(i){return new ee(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Vp(n){let e=ee.fromString(n);return J(Up(e),10190,{key:e.toString()}),e}function Ic(n,e){return xu(n.databaseId,e.path)}function Va(n,e){let t=Vp(e);if(t.get(1)!==n.databaseId.projectId)throw new D(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new D(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new x(Lp(t))}function xp(n,e){return xu(n.databaseId,e)}function lE(n){let e=Vp(n);return e.length===4?ee.emptyPath():Lp(e)}function Ec(n){return new ee(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Lp(n){return J(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Af(n,e,t){return{name:Ic(n,e),fields:t.value.mapValue.fields}}function hE(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:L(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(d,p){return d.useProto3Json?(J(p===void 0||typeof p=="string",58123),we.fromBase64String(p||"")):(J(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),we.fromUint8Array(p||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&(function(d){let p=d.code===void 0?R.UNKNOWN:kp(d.code);return new D(p,d.message||"")})(a);t=new cs(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Va(n,r.document.name),s=Qe(r.document.updateTime),a=r.document.createTime?Qe(r.document.createTime):U.min(),u=new De({mapValue:{fields:r.document.fields}}),l=Fe.newFoundDocument(i,s,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new bn(d,p,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Va(n,r.document),s=r.readTime?Qe(r.readTime):U.min(),a=Fe.newNoDocument(i,s),u=r.removedTargetIds||[];t=new bn([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Va(n,r.document),s=r.removedTargetIds||[];t=new bn([],s,i,null)}else{if(!("filter"in e))return L(11601,{Rt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new fc(i,s),u=r.targetId;t=new as(u,a)}}return t}function dE(n,e){let t;if(e instanceof on)t={update:Af(n,e.key,e.value)};else if(e instanceof Or)t={delete:Ic(n,e.key)};else if(e instanceof Ye)t={update:Af(n,e.key,e.data),updateMask:wE(e.fieldMask)};else{if(!(e instanceof uc))return L(16599,{Vt:e.type});t={verify:Ic(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(s,a){let u=a.transform;if(u instanceof nn)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof rn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof sn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Vn)return{fieldPath:a.field.canonicalString(),increment:u.Ae};throw L(20930,{transform:a.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:uE(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:L(27497)})(n,e.precondition)),t}function fE(n,e){return n&&n.length>0?(J(e!==void 0,14353),n.map(t=>(function(i,s){let a=i.updateTime?Qe(i.updateTime):Qe(s);return a.isEqual(U.min())&&(a=Qe(s)),new cc(a,i.transformResults||[])})(t,e))):[]}function pE(n,e){return{documents:[xp(n,e.path)]}}function mE(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=xp(n,i);let s=(function(d){if(d.length!==0)return Fp(Ue.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let a=(function(d){if(d.length!==0)return d.map(p=>(function(_){return{field:wn(_.field),direction:yE(_.dir)}})(p))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=_c(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function gE(n){let e=lE(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){J(r===1,65062);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=(function(m){let _=Mp(m);return _ instanceof Ue&&gp(_)?_.getFilters():[_]})(t.where));let a=[];t.orderBy&&(a=(function(m){return m.map(_=>(function(P){return new tn(vn(P.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(_))})(t.orderBy));let u=null;t.limit&&(u=(function(m){let _;return _=typeof m=="object"?m.value:m,Os(_)?null:_})(t.limit));let l=null;t.startAt&&(l=(function(m){let _=!!m.before,S=m.values||[];return new Ot(S,_)})(t.startAt));let d=null;return t.endAt&&(d=(function(m){let _=!m.before,S=m.values||[];return new Ot(S,_)})(t.endAt)),qI(e,i,a,s,u,"F",l,d)}function _E(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return L(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Mp(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=vn(t.unaryFilter.field);return ae.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=vn(t.unaryFilter.field);return ae.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=vn(t.unaryFilter.field);return ae.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=vn(t.unaryFilter.field);return ae.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return L(61313);default:return L(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ae.create(vn(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return L(58110);default:return L(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ue.create(t.compositeFilter.filters.map(r=>Mp(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return L(1026)}})(t.compositeFilter.op))})(n):L(30097,{filter:n})}function yE(n){return oE[n]}function IE(n){return aE[n]}function EE(n){return cE[n]}function wn(n){return{fieldPath:n.canonicalString()}}function vn(n){return ke.fromServerFormat(n.fieldPath)}function Fp(n){return n instanceof ae?(function(t){if(t.op==="=="){if(df(t.value))return{unaryFilter:{field:wn(t.field),op:"IS_NAN"}};if(hf(t.value))return{unaryFilter:{field:wn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(df(t.value))return{unaryFilter:{field:wn(t.field),op:"IS_NOT_NAN"}};if(hf(t.value))return{unaryFilter:{field:wn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wn(t.field),op:IE(t.op),value:t.value}}})(n):n instanceof Ue?(function(t){let r=t.getFilters().map(i=>Fp(i));return r.length===1?r[0]:{compositeFilter:{op:EE(t.op),filters:r}}})(n):L(54877,{filter:n})}function wE(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Up(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var xr=class n{constructor(e,t,r,i,s=U.min(),a=U.min(),u=we.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var wc=class{constructor(e){this.yt=e}};function vE(n){let e=gE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ss(e,e.limit,"L"):e}var hs=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(te(e.integerValue));else if("doubleValue"in e){let r=te(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Nr(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=at(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(ct(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?fp(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):dp(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):L(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=Nn,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(te(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),x.fromName(e).path.forEach(r=>{this.Ft(t,60),this.Ut(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};hs.Kt=new hs;var vc=class{constructor(){this.Cn=new Tc}addToCollectionParentIndex(e,t){return this.Cn.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return C.resolve()}deleteFieldIndex(e,t){return C.resolve()}deleteAllFieldIndexes(e){return C.resolve()}createTargetIndexes(e,t){return C.resolve()}getDocumentsMatchingTarget(e,t){return C.resolve(null)}getIndexType(e,t){return C.resolve(0)}getFieldIndexes(e,t){return C.resolve([])}getNextCollectionGroupToUpdate(e){return C.resolve(null)}getMinOffset(e,t){return C.resolve(en.min())}getMinOffsetFromCollectionGroup(e,t){return C.resolve(en.min())}updateCollectionGroup(e,t,r){return C.resolve()}updateIndexEntries(e,t){return C.resolve()}},Tc=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new pe(ee.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new pe(ee.comparator)).toArray()}};var bA=new Uint8Array(0);var bf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Bp=41943040,Oe=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Oe.DEFAULT_COLLECTION_PERCENTILE=10,Oe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Oe.DEFAULT=new Oe(Bp,Oe.DEFAULT_COLLECTION_PERCENTILE,Oe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Oe.DISABLED=new Oe(-1,0,0);var Lr=class n{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new n(0)}static cr(){return new n(-1)}};var Sf="LruGarbageCollector",TE=1048576;function Rf([n,e],[t,r]){let i=G(n,t);return i===0?G(e,r):i}var Ac=class{constructor(e){this.Ir=e,this.buffer=new pe(Rf),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Rf(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},bc=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){V(Sf,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){jn(t)?V(Sf,"Ignoring IndexedDB error during garbage collection: ",t):await zn(t)}await this.Vr(3e5)})}},Sc=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return C.resolve(bu.ce);let r=new Ac(t);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),C.resolve(bf)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bf):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,u,l,d,p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,a=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,u=Date.now(),this.removeTargets(e,r,t))).next(m=>(s=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),In()<=j.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${s} targets in `+(l-u)+`ms
	Removed ${m} documents in `+(d-l)+`ms
Total Duration: ${d-p}ms`),C.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}};function AE(n,e){return new Sc(n,e)}var Rc=class{constructor(){this.changes=new lt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Fe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?C.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Cc=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Pc=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Rr(r.mutation,i,Ve.empty(),ue.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,K()).next(()=>r))}getLocalViewOfDocuments(e,t,r=K()){let i=Qt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=Ar();return s.forEach((u,l)=>{a=a.insert(u,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=Qt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,K()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let s=ht(),a=Sr(),u=(function(){return Sr()})();return t.forEach((l,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof Ye)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),Rr(p.mutation,d,p.mutation.getFieldMask(),ue.now())):a.set(d.key,Ve.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>u.set(d,new Cc(p,a.get(d)??null))),u))}recalculateAndSaveOverlays(e,t){let r=Sr(),i=new re((a,u)=>a-u),s=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(l=>{let d=t.get(l);if(d===null)return;let p=r.get(l)||Ve.empty();p=u.applyToLocalView(d,p),r.set(l,p);let m=(i.get(u.batchId)||K()).add(l);i=i.insert(u.batchId,m)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let l=u.getNext(),d=l.key,p=l.value,m=Ap();p.forEach(_=>{if(!s.has(_)){let S=Np(t.get(_),r.get(_));S!==null&&m.set(_,S),s=s.add(_)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,m))}return C.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return x.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ou(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):C.resolve(Qt()),u=Pr,l=s;return a.next(d=>C.forEach(d,(p,m)=>(u<m.largestBatchId&&(u=m.largestBatchId),s.get(p)?C.resolve():this.remoteDocumentCache.getEntry(e,p).next(_=>{l=l.insert(p,_)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,l,d,K())).next(p=>({batchId:u,changes:Tp(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new x(t)).next(r=>{let i=Ar();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=Ar();return this.indexManager.getCollectionParents(e,s).next(u=>C.forEach(u,l=>{let d=(function(m,_){return new ut(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((m,_)=>{a=a.insert(m,_)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,Fe.newInvalidDocument(p)))});let u=Ar();return a.forEach((l,d)=>{let p=s.get(l);p!==void 0&&Rr(p.mutation,d,Ve.empty(),ue.now()),Ms(t,d)&&(u=u.insert(l,d))}),u})}};var Nc=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return C.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Qe(i.createTime)}})(t)),C.resolve()}getNamedQuery(e,t){return C.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:vE(i.bundledQuery),readTime:Qe(i.readTime)}})(t)),C.resolve()}};var Dc=class{constructor(){this.overlays=new re(x.comparator),this.qr=new Map}getOverlay(e,t){return C.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Qt();return C.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.St(e,t,s)}),C.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),C.resolve()}getOverlaysForCollection(e,t,r){let i=Qt(),s=t.length+1,a=new x(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let l=u.getNext().value,d=l.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return C.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new re((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=Qt(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=Qt(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return C.resolve(u)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new dc(t,r));let s=this.qr.get(t);s===void 0&&(s=K(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}};var kc=class{constructor(){this.sessionToken=we.EMPTY_BYTE_STRING}getSessionToken(e){return C.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,C.resolve()}};var Mr=class{constructor(){this.Qr=new pe(oe.$r),this.Ur=new pe(oe.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let r=new oe(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new oe(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){let t=new x(new ee([])),r=new oe(t,e),i=new oe(t,e+1),s=[];return this.Ur.forEachInRange([r,i],a=>{this.Gr(a),s.push(a.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new x(new ee([])),r=new oe(t,e),i=new oe(t,e+1),s=K();return this.Ur.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new oe(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},oe=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return x.comparator(e.key,t.key)||G(e.Yr,t.Yr)}static Kr(e,t){return G(e.Yr,t.Yr)||x.comparator(e.key,t.key)}};var Oc=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new pe(oe.$r)}checkEmpty(e){return C.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new lc(s,t,r,i);this.mutationQueue.push(a);for(let u of i)this.Zr=this.Zr.add(new oe(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return C.resolve(a)}lookupMutationBatch(e,t){return C.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.ei(r),s=i<0?0:i;return C.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(this.mutationQueue.length===0?Su:this.tr-1)}getAllMutationBatches(e){return C.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new oe(t,0),i=new oe(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],a=>{let u=this.Xr(a.Yr);s.push(u)}),C.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pe(G);return t.forEach(i=>{let s=new oe(i,0),a=new oe(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],u=>{r=r.add(u.Yr)})}),C.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;x.isDocumentKey(s)||(s=s.child(""));let a=new oe(new x(s),0),u=new pe(G);return this.Zr.forEachWhile(l=>{let d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(l.Yr)),!0)},a),C.resolve(this.ti(u))}ti(e){let t=[];return e.forEach(r=>{let i=this.Xr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){J(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return C.forEach(t.mutations,i=>{let s=new oe(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){let r=new oe(t,0),i=this.Zr.firstAfterOrEqual(r);return C.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,C.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Vc=class{constructor(e){this.ri=e,this.docs=(function(){return new re(x.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return C.resolve(r?r.document.mutableCopy():Fe.newInvalidDocument(t))}getEntries(e,t){let r=ht();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Fe.newInvalidDocument(i))}),C.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=ht(),a=t.path,u=new x(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){let{key:d,value:{document:p}}=l.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||vI(wI(p),r)<=0||(i.has(p.key)||Ms(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return C.resolve(s)}getAllFromCollectionGroup(e,t,r,i){L(9500)}ii(e,t){return C.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new xc(this)}getSize(e){return C.resolve(this.size)}},xc=class extends Rc{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),C.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}};var Lc=class{constructor(e){this.persistence=e,this.si=new lt(t=>Nu(t),Du),this.lastRemoteSnapshotVersion=U.min(),this.highestTargetId=0,this.oi=0,this._i=new Mr,this.targetCount=0,this.ai=Lr.ur()}forEachTarget(e,t){return this.si.forEach((r,i)=>t(i)),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),C.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new Lr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.Pr(t),C.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.si.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),C.waitFor(s).next(()=>i)}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){let r=this.si.get(t)||null;return C.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),C.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),C.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),C.resolve()}getMatchingKeysForTargetId(e,t){let r=this._i.Hr(t);return C.resolve(r)}containsKey(e,t){return C.resolve(this._i.containsKey(t))}};var ds=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new bu(0),this.li=!1,this.li=!0,this.hi=new kc,this.referenceDelegate=e(this),this.Pi=new Lc(this),this.indexManager=new vc,this.remoteDocumentCache=(function(i){return new Vc(i)})(r=>this.referenceDelegate.Ti(r)),this.serializer=new wc(t),this.Ii=new Nc(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Dc,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new Oc(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);let i=new Mc(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,t){return C.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}},Mc=class extends Ka{constructor(e){super(),this.currentSequenceNumber=e}},Fc=class n{constructor(e){this.persistence=e,this.Ri=new Mr,this.Vi=null}static mi(e){return new n(e)}get fi(){if(this.Vi)return this.Vi;throw L(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),C.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),C.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.fi,r=>{let i=x.fromPath(r);return this.gi(e,i).next(s=>{s||t.removeEntry(i,U.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return C.or([()=>C.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},fs=class n{constructor(e,t){this.persistence=e,this.pi=new lt(r=>SI(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=AE(this,t)}static mi(e,t){return new n(e,t)}Ei(){}di(e){return C.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return C.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?C.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,t).next(u=>{u||(r++,s.removeEntry(a,U.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),C.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),C.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),C.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),C.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Hi(e.data.value)),t}br(e,t,r){return C.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.pi.get(t);return C.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Uc=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=K(),i=K();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Bc=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var qc=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Vh()?8:AI(de())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ys(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ws(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new Bc;return this.Ss(e,t,a).next(u=>{if(s.result=u,this.Vs)return this.bs(e,t,a,u.size)})}).next(()=>s.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(In()<=j.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",En(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),C.resolve()):(In()<=j.DEBUG&&V("QueryEngine","Query:",En(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(In()<=j.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",En(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,We(t))):C.resolve())}ys(e,t){if(gf(t))return C.resolve(null);let r=We(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=ss(t,null,"F"),r=We(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=K(...s);return this.ps.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(l=>{let d=this.Ds(t,u);return this.Cs(t,d,a,l.readTime)?this.ys(e,ss(t,null,"F")):this.vs(e,d,t,l)}))})))}ws(e,t,r,i){return gf(t)||i.isEqual(U.min())?C.resolve(null):this.ps.getDocuments(e,r).next(s=>{let a=this.Ds(t,s);return this.Cs(t,a,r,i)?C.resolve(null):(In()<=j.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),En(t)),this.vs(e,a,t,EI(i,Pr)).next(u=>u))})}Ds(e,t){let r=new pe(wp(e));return t.forEach((i,s)=>{Ms(e,s)&&(r=r.add(s))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return In()<=j.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",En(t)),this.ps.getDocumentsMatchingQuery(e,t,en.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var Lu="LocalStore",bE=3e8,zc=class{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new re(G),this.xs=new lt(s=>Nu(s),Du),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Pc(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}};function SE(n,e,t,r){return new zc(n,e,t,r)}async function qp(n,e){let t=F(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],u=[],l=K();for(let d of i){a.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}for(let d of s){u.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}return t.localDocuments.getDocuments(r,l).next(d=>({Ls:d,removedBatchIds:a,addedBatchIds:u}))})})}function RE(n,e){let t=F(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,l,d,p){let m=d.batch,_=m.keys(),S=C.resolve();return _.forEach(P=>{S=S.next(()=>p.getEntry(l,P)).next(O=>{let N=d.docVersions.get(P);J(N!==null,48541),O.version.compareTo(N)<0&&(m.applyToRemoteDocument(O,d),O.isValidDocument()&&(O.setReadTime(d.commitVersion),p.addEntry(O)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(l,m))})(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(u){let l=K();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(l=l.add(u.batch.mutations[d].key));return l})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function zp(n){let e=F(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function CE(n,e){let t=F(n),r=e.snapshotVersion,i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;let u=[];e.targetChanges.forEach((p,m)=>{let _=i.get(m);if(!_)return;u.push(t.Pi.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.Pi.addMatchingKeys(s,p.addedDocuments,m)));let S=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?S=S.withResumeToken(we.EMPTY_BYTE_STRING,U.min()).withLastLimboFreeSnapshotVersion(U.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(m,S),(function(O,N,B){return O.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=bE?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0})(_,S,p)&&u.push(t.Pi.updateTargetData(s,S))});let l=ht(),d=K();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(PE(s,a,e.documentUpdates).next(p=>{l=p.ks,d=p.qs})),!r.isEqual(U.min())){let p=t.Pi.getLastRemoteSnapshotVersion(s).next(m=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(p)}return C.waitFor(u).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,d)).next(()=>l)}).then(s=>(t.Ms=i,s))}function PE(n,e,t){let r=K(),i=K();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=ht();return t.forEach((u,l)=>{let d=s.get(u);l.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),l.isNoDocument()&&l.version.isEqual(U.min())?(e.removeEntry(u,l.readTime),a=a.insert(u,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),a=a.insert(u,l)):V(Lu,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",l.version)}),{ks:a,qs:i}})}function NE(n,e){let t=F(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Su),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function DE(n,e){let t=F(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Pi.getTargetData(r,e).next(s=>s?(i=s,C.resolve(i)):t.Pi.allocateTargetId(r).next(a=>(i=new xr(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}async function jc(n,e,t){let r=F(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!jn(a))throw a;V(Lu,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Cf(n,e,t){let r=F(n),i=U.min(),s=K();return r.persistence.runTransaction("Execute query","readwrite",a=>(function(l,d,p){let m=F(l),_=m.xs.get(p);return _!==void 0?C.resolve(m.Ms.get(_)):m.Pi.getTargetData(d,p)})(r,a,We(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,u.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:U.min(),t?s:K())).next(u=>(kE(r,jI(e),u),{documents:u,Qs:s})))}function kE(n,e,t){let r=n.Os.get(e)||U.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Os.set(e,r)}var ps=class{constructor(){this.activeTargetIds=QI()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var $c=class{constructor(){this.Mo=new ps,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new ps,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Gc=class{Oo(e){}shutdown(){}};var Pf="ConnectivityMonitor",ms=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){V(Pf,"Network connectivity changed: AVAILABLE");for(let e of this.qo)e(0)}ko(){V(Pf,"Network connectivity changed: UNAVAILABLE");for(let e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ki=null;function Kc(){return Ki===null?Ki=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ki++,"0x"+Ki.toString(16)}var xa="RestConnection",OE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Hc=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===ts?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){let a=Kc(),u=this.zo(e,t.toUriEncodedString());V(xa,`Sending RPC '${e}' ${a}:`,u,r);let l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);let{host:d}=new URL(u),p=Le(d);return this.Jo(e,u,l,r,p).then(m=>(V(xa,`Received RPC '${e}' ${a}: `,m),m),m=>{throw Cn(xa,`RPC '${e}' ${a} failed with error: `,m,"url: ",u,"request:",r),m})}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+qn})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,t){let r=OE[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}};var Wc=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}};var Ee="WebChannelConnection",Qc=class extends Hc{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){let a=Kc();return new Promise((u,l)=>{let d=new Ca;d.setWithCredentials(!0),d.listenOnce(Pa.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Tr.NO_ERROR:let m=d.getResponseJson();V(Ee,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),u(m);break;case Tr.TIMEOUT:V(Ee,`RPC '${e}' ${a} timed out`),l(new D(R.DEADLINE_EXCEEDED,"Request time out"));break;case Tr.HTTP_ERROR:let _=d.getStatus();if(V(Ee,`RPC '${e}' ${a} failed with status:`,_,"response text:",d.getResponseText()),_>0){let S=d.getResponseJson();Array.isArray(S)&&(S=S[0]);let P=S?.error;if(P&&P.status&&P.message){let O=(function(B){let $=B.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf($)>=0?$:R.UNKNOWN})(P.status);l(new D(O,P.message))}else l(new D(R.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new D(R.UNAVAILABLE,"Connection failed."));break;default:L(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{V(Ee,`RPC '${e}' ${a} completed.`)}});let p=JSON.stringify(i);V(Ee,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",p,r,15)})}T_(e,t,r){let i=Kc(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ka(),u=Da(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let p=s.join("");V(Ee,`Creating RPC '${e}' stream ${i}: ${p}`,l);let m=a.createWebChannel(p,l);this.I_(m);let _=!1,S=!1,P=new Wc({Yo:N=>{S?V(Ee,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(_||(V(Ee,`Opening RPC '${e}' stream ${i} transport.`),m.open(),_=!0),V(Ee,`RPC '${e}' stream ${i} sending:`,N),m.send(N))},Zo:()=>m.close()}),O=(N,B,$)=>{N.listen(B,Q=>{try{$(Q)}catch(me){setTimeout(()=>{throw me},0)}})};return O(m,yn.EventType.OPEN,()=>{S||(V(Ee,`RPC '${e}' stream ${i} transport opened.`),P.o_())}),O(m,yn.EventType.CLOSE,()=>{S||(S=!0,V(Ee,`RPC '${e}' stream ${i} transport closed`),P.a_(),this.E_(m))}),O(m,yn.EventType.ERROR,N=>{S||(S=!0,Cn(Ee,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),P.a_(new D(R.UNAVAILABLE,"The operation could not be completed")))}),O(m,yn.EventType.MESSAGE,N=>{if(!S){let B=N.data[0];J(!!B,16349);let $=B,Q=$?.error||$[0]?.error;if(Q){V(Ee,`RPC '${e}' stream ${i} received error:`,Q);let me=Q.status,ge=(function(g){let I=se[g];if(I!==void 0)return kp(I)})(me),ie=Q.message;ge===void 0&&(ge=R.INTERNAL,ie="Unknown error status: "+me+" with message "+Q.message),S=!0,P.a_(new D(ge,ie)),m.close()}else V(Ee,`RPC '${e}' stream ${i} received:`,B),P.u_(B)}}),O(u,Na.STAT_EVENT,N=>{N.stat===ji.PROXY?V(Ee,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===ji.NOPROXY&&V(Ee,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{P.__()},0),P}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}};function La(){return typeof document<"u"?document:null}function Fs(n){return new gc(n,!0)}var gs=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}};var Nf="PersistentStream",_s=class{constructor(e,t,r,i,s,a,u,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new gs(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(st(t.toString()),st("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{let i=new D(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){let r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return V(Nf,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(V(Nf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Jc=class extends _s{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=hE(this.serializer,e),r=(function(s){if(!("targetChange"in s))return U.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?U.min():a.readTime?Qe(a.readTime):U.min()})(e);return this.listener.H_(t,r)}Y_(e){let t={};t.database=Ec(this.serializer),t.addTarget=(function(s,a){let u,l=a.target;if(u=sc(l)?{documents:pE(s,l)}:{query:mE(s,l).ft},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Op(s,a.resumeToken);let d=_c(s,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(U.min())>0){u.readTime=ls(s,a.snapshotVersion.toTimestamp());let d=_c(s,a.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);let r=_E(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){let t={};t.database=Ec(this.serializer),t.removeTarget=e,this.q_(t)}},Yc=class extends _s{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return J(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,J(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){J(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=fE(e.writeResults,e.commitTime),r=Qe(e.commitTime);return this.listener.na(r,t)}ra(){let e={};e.database=Ec(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>dE(this.serializer,r))};this.q_(t)}};var Xc=class{},Zc=class extends Xc{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new D(R.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Go(e,yc(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new D(R.UNKNOWN,s.toString())})}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Ho(e,yc(t,r),i,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new D(R.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}},eu=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(st(t),this.aa=!1):V("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var an="RemoteStore",tu=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(a=>{r.enqueueAndForget(async()=>{cn(this)&&(V(an,"Restarting streams for network reachability change."),await(async function(l){let d=F(l);d.Ea.add(4),await qr(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Us(d)})(this))})}),this.Ra=new eu(r,i)}};async function Us(n){if(cn(n))for(let e of n.da)await e(!0)}async function qr(n){for(let e of n.da)await e(!1)}function jp(n,e){let t=F(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Bu(t)?Uu(t):$n(t).O_()&&Fu(t,e))}function Mu(n,e){let t=F(n),r=$n(t);t.Ia.delete(e),r.O_()&&$p(t,e),t.Ia.size===0&&(r.O_()?r.L_():cn(t)&&t.Ra.set("Unknown"))}function Fu(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(U.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}$n(n).Y_(e)}function $p(n,e){n.Va.Ue(e),$n(n).Z_(e)}function Uu(n){n.Va=new mc({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),$n(n).start(),n.Ra.ua()}function Bu(n){return cn(n)&&!$n(n).x_()&&n.Ia.size>0}function cn(n){return F(n).Ea.size===0}function Gp(n){n.Va=void 0}async function VE(n){n.Ra.set("Online")}async function xE(n){n.Ia.forEach((e,t)=>{Fu(n,e)})}async function LE(n,e){Gp(n),Bu(n)?(n.Ra.ha(e),Uu(n)):n.Ra.set("Unknown")}async function ME(n,e,t){if(n.Ra.set("Online"),e instanceof cs&&e.state===2&&e.cause)try{await(async function(i,s){let a=s.cause;for(let u of s.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,a),i.Ia.delete(u),i.Va.removeTarget(u))})(n,e)}catch(r){V(an,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ys(n,r)}else if(e instanceof bn?n.Va.Ze(e):e instanceof as?n.Va.st(e):n.Va.tt(e),!t.isEqual(U.min()))try{let r=await zp(n.localStore);t.compareTo(r)>=0&&await(function(s,a){let u=s.Va.Tt(a);return u.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){let p=s.Ia.get(d);p&&s.Ia.set(d,p.withResumeToken(l.resumeToken,a))}}),u.targetMismatches.forEach((l,d)=>{let p=s.Ia.get(l);if(!p)return;s.Ia.set(l,p.withResumeToken(we.EMPTY_BYTE_STRING,p.snapshotVersion)),$p(s,l);let m=new xr(p.target,l,d,p.sequenceNumber);Fu(s,m)}),s.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(r){V(an,"Failed to raise snapshot:",r),await ys(n,r)}}async function ys(n,e,t){if(!jn(e))throw e;n.Ea.add(1),await qr(n),n.Ra.set("Offline"),t||(t=()=>zp(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{V(an,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Us(n)})}function Kp(n,e){return e().catch(t=>ys(n,t,e))}async function Bs(n){let e=F(n),t=Vt(e),r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Su;for(;FE(e);)try{let i=await NE(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,UE(e,i)}catch(i){await ys(e,i)}Hp(e)&&Wp(e)}function FE(n){return cn(n)&&n.Ta.length<10}function UE(n,e){n.Ta.push(e);let t=Vt(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Hp(n){return cn(n)&&!Vt(n).x_()&&n.Ta.length>0}function Wp(n){Vt(n).start()}async function BE(n){Vt(n).ra()}async function qE(n){let e=Vt(n);for(let t of n.Ta)e.ea(t.mutations)}async function zE(n,e,t){let r=n.Ta.shift(),i=hc.from(r,e,t);await Kp(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Bs(n)}async function jE(n,e){e&&Vt(n).X_&&await(async function(r,i){if((function(a){return nE(a)&&a!==R.ABORTED})(i.code)){let s=r.Ta.shift();Vt(r).B_(),await Kp(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Bs(r)}})(n,e),Hp(n)&&Wp(n)}async function Df(n,e){let t=F(n);t.asyncQueue.verifyOperationInProgress(),V(an,"RemoteStore received new credentials");let r=cn(t);t.Ea.add(3),await qr(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Us(t)}async function $E(n,e){let t=F(n);e?(t.Ea.delete(2),await Us(t)):e||(t.Ea.add(2),await qr(t),t.Ra.set("Unknown"))}function $n(n){return n.ma||(n.ma=(function(t,r,i){let s=F(t);return s.sa(),new Jc(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:VE.bind(null,n),t_:xE.bind(null,n),r_:LE.bind(null,n),H_:ME.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),Bu(n)?Uu(n):n.Ra.set("Unknown")):(await n.ma.stop(),Gp(n))})),n.ma}function Vt(n){return n.fa||(n.fa=(function(t,r,i){let s=F(t);return s.sa(),new Yc(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:BE.bind(null,n),r_:jE.bind(null,n),ta:qE.bind(null,n),na:zE.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Bs(n)):(await n.fa.stop(),n.Ta.length>0&&(V(an,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var nu=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Me,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,u=new n(e,t,a,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function qu(n,e){if(st("AsyncQueue",`${e}: ${n}`),jn(n))return new D(R.UNAVAILABLE,`${e}: ${n}`);throw n}var Is=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||x.comparator(t.key,r.key):(t,r)=>x.comparator(t.key,r.key),this.keyedMap=Ar(),this.sortedSet=new re(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Es=class{constructor(){this.ga=new re(x.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):L(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}},Ln=class n{constructor(e,t,r,i,s,a,u,l,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,Is.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ls(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var ru=class{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}},iu=class{constructor(){this.queries=kf(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=F(t),s=i.queries;i.queries=kf(),s.forEach((a,u)=>{for(let l of u.Sa)l.onError(r)})})(this,new D(R.ABORTED,"Firestore shutting down"))}};function kf(){return new lt(n=>Ep(n),Ls)}async function Qp(n,e){let t=F(n),r=3,i=e.query,s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new ru,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){let u=qu(a,`Initialization of query '${En(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&zu(t)}async function Jp(n,e){let t=F(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function GE(n,e){let t=F(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let u of a.Sa)u.Fa(i)&&(r=!0);a.wa=i}}r&&zu(t)}function KE(n,e,t){let r=F(n),i=r.queries.get(e);if(i)for(let s of i.Sa)s.onError(t);r.queries.delete(e)}function zu(n){n.Ca.forEach(e=>{e.next()})}var su,Of;(Of=su||(su={})).Ma="default",Of.Cache="cache";var ws=class{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Ln(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ln.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==su.Cache}};var vs=class{constructor(e){this.key=e}},Ts=class{constructor(e){this.key=e}},ou=class{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=K(),this.mutatedKeys=K(),this.eu=wp(e),this.tu=new Is(this.eu)}get nu(){return this.Ya}ru(e,t){let r=t?t.iu:new Es,i=t?t.tu:this.tu,s=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{let _=i.get(p),S=Ms(this.query,m)?m:null,P=!!_&&this.mutatedKeys.has(_.key),O=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),N=!1;_&&S?_.data.isEqual(S.data)?P!==O&&(r.track({type:3,doc:S}),N=!0):this.su(_,S)||(r.track({type:2,doc:S}),N=!0,(l&&this.eu(S,l)>0||d&&this.eu(S,d)<0)&&(u=!0)):!_&&S?(r.track({type:0,doc:S}),N=!0):_&&!S&&(r.track({type:1,doc:_}),N=!0,(l||d)&&(u=!0)),N&&(S?(a=a.add(S),s=O?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{tu:a,iu:r,Cs:u,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let a=e.iu.ya();a.sort((p,m)=>(function(S,P){let O=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return L(20277,{Rt:N})}};return O(S)-O(P)})(p.type,m.type)||this.eu(p.doc,m.doc)),this.ou(r),i=i??!1;let u=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,d=l!==this.Za;return this.Za=l,a.length!==0||d?{snapshot:new Ln(this.query,e.tu,s,a,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Es,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Xa;this.Xa=K(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});let t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new Ts(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new vs(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=K();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ln.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}},ju="SyncEngine",au=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},cu=class{constructor(e){this.key=e,this.hu=!1}},uu=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new lt(u=>Ep(u),Ls),this.Iu=new Map,this.Eu=new Set,this.du=new re(x.comparator),this.Au=new Map,this.Ru=new Mr,this.Vu={},this.mu=new Map,this.fu=Lr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function HE(n,e,t=!0){let r=nm(n),i,s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await Yp(r,e,t,!0),i}async function WE(n,e){let t=nm(n);await Yp(t,e,!0,!1)}async function Yp(n,e,t,r){let i=await DE(n.localStore,We(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),u;return r&&(u=await QE(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&jp(n.remoteStore,i),u}async function QE(n,e,t,r,i){n.pu=(m,_,S)=>(async function(O,N,B,$){let Q=N.view.ru(B);Q.Cs&&(Q=await Cf(O.localStore,N.query,!1).then(({documents:w})=>N.view.ru(w,Q)));let me=$&&$.targetChanges.get(N.targetId),ge=$&&$.targetMismatches.get(N.targetId)!=null,ie=N.view.applyChanges(Q,O.isPrimaryClient,me,ge);return xf(O,N.targetId,ie.au),ie.snapshot})(n,m,_,S);let s=await Cf(n.localStore,e,!0),a=new ou(e,s.Qs),u=a.ru(s.documents),l=Vr.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,l);xf(n,t,d.au);let p=new au(e,t,a);return n.Tu.set(e,p),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function JE(n,e,t){let r=F(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(a=>!Ls(a,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await jc(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Mu(r.remoteStore,i.targetId),lu(r,i.targetId)}).catch(zn)):(lu(r,i.targetId),await jc(r.localStore,i.targetId,!0))}async function YE(n,e){let t=F(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Mu(t.remoteStore,r.targetId))}async function XE(n,e,t){let r=sw(n);try{let i=await(function(a,u){let l=F(a),d=ue.now(),p=u.reduce((S,P)=>S.add(P.key),K()),m,_;return l.persistence.runTransaction("Locally write mutations","readwrite",S=>{let P=ht(),O=K();return l.Ns.getEntries(S,p).next(N=>{P=N,P.forEach((B,$)=>{$.isValidDocument()||(O=O.add(B))})}).next(()=>l.localDocuments.getOverlayedDocuments(S,P)).next(N=>{m=N;let B=[];for(let $ of u){let Q=tE($,m.get($.key).overlayedDocument);Q!=null&&B.push(new Ye($.key,Q,pp(Q.value.mapValue),it.exists(!0)))}return l.mutationQueue.addMutationBatch(S,d,B,u)}).next(N=>{_=N;let B=N.applyToLocalDocumentSet(m,O);return l.documentOverlayCache.saveOverlays(S,N.batchId,B)})}).then(()=>({batchId:_.batchId,changes:Tp(m)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,u,l){let d=a.Vu[a.currentUser.toKey()];d||(d=new re(G)),d=d.insert(u,l),a.Vu[a.currentUser.toKey()]=d})(r,i.batchId,t),await zr(r,i.changes),await Bs(r.remoteStore)}catch(i){let s=qu(i,"Failed to persist write");t.reject(s)}}async function Xp(n,e){let t=F(n);try{let r=await CE(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Au.get(s);a&&(J(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?J(a.hu,14607):i.removedDocuments.size>0&&(J(a.hu,42227),a.hu=!1))}),await zr(t,r,e)}catch(r){await zn(r)}}function Vf(n,e,t){let r=F(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach((s,a)=>{let u=a.view.va(e);u.snapshot&&i.push(u.snapshot)}),(function(a,u){let l=F(a);l.onlineState=u;let d=!1;l.queries.forEach((p,m)=>{for(let _ of m.Sa)_.va(u)&&(d=!0)}),d&&zu(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ZE(n,e,t){let r=F(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Au.get(e),s=i&&i.key;if(s){let a=new re(x.comparator);a=a.insert(s,Fe.newNoDocument(s,U.min()));let u=K().add(s),l=new os(U.min(),new Map,new re(G),a,u);await Xp(r,l),r.du=r.du.remove(s),r.Au.delete(e),$u(r)}else await jc(r.localStore,e,!1).then(()=>lu(r,e,t)).catch(zn)}async function ew(n,e){let t=F(n),r=e.batch.batchId;try{let i=await RE(t.localStore,e);em(t,r,null),Zp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await zr(t,i)}catch(i){await zn(i)}}async function tw(n,e,t){let r=F(n);try{let i=await(function(a,u){let l=F(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return l.mutationQueue.lookupMutationBatch(d,u).next(m=>(J(m!==null,37113),p=m.keys(),l.mutationQueue.removeMutationBatch(d,m))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>l.localDocuments.getDocuments(d,p))})})(r.localStore,e);em(r,e,t),Zp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await zr(r,i)}catch(i){await zn(i)}}function Zp(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function em(n,e,t){let r=F(n),i=r.Vu[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function lu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(r=>{n.Ru.containsKey(r)||tm(n,r)})}function tm(n,e){n.Eu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(Mu(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),$u(n))}function xf(n,e,t){for(let r of t)r instanceof vs?(n.Ru.addReference(r.key,e),nw(n,r)):r instanceof Ts?(V(ju,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||tm(n,r.key)):L(19791,{wu:r})}function nw(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(V(ju,"New document in limbo: "+t),n.Eu.add(r),$u(n))}function $u(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new x(ee.fromString(e)),r=n.fu.next();n.Au.set(r,new cu(t)),n.du=n.du.insert(t,r),jp(n.remoteStore,new xr(We(ku(t.path)),r,"TargetPurposeLimboResolution",bu.ce))}}async function zr(n,e,t){let r=F(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((u,l)=>{a.push(r.pu(l,e,t).then(d=>{if((d||t)&&r.isPrimaryClient){let p=d?!d.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(d){i.push(d);let p=Uc.As(l.targetId,d);s.push(p)}}))}),await Promise.all(a),r.Pu.H_(i),await(async function(l,d){let p=F(l);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>C.forEach(d,_=>C.forEach(_.Es,S=>p.persistence.referenceDelegate.addReference(m,_.targetId,S)).next(()=>C.forEach(_.ds,S=>p.persistence.referenceDelegate.removeReference(m,_.targetId,S)))))}catch(m){if(!jn(m))throw m;V(Lu,"Failed to update sequence numbers: "+m)}for(let m of d){let _=m.targetId;if(!m.fromCache){let S=p.Ms.get(_),P=S.snapshotVersion,O=S.withLastLimboFreeSnapshotVersion(P);p.Ms=p.Ms.insert(_,O)}}})(r.localStore,s))}async function rw(n,e){let t=F(n);if(!t.currentUser.isEqual(e)){V(ju,"User change. New user:",e.toKey());let r=await qp(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach(u=>{u.forEach(l=>{l.reject(new D(R.CANCELLED,a))})}),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await zr(t,r.Ls)}}function iw(n,e){let t=F(n),r=t.Au.get(e);if(r&&r.hu)return K().add(r.key);{let i=K(),s=t.Iu.get(e);if(!s)return i;for(let a of s){let u=t.Tu.get(a);i=i.unionWith(u.view.nu)}return i}}function nm(n){let e=F(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Xp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iw.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZE.bind(null,e),e.Pu.H_=GE.bind(null,e.eventManager),e.Pu.yu=KE.bind(null,e.eventManager),e}function sw(n){let e=F(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ew.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tw.bind(null,e),e}var rm=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Fs(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return SE(this.persistence,new qc,t.initialUser,this.serializer)}Cu(t){return new ds(Fc.mi,this.serializer)}Du(t){return new $c}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),hu=class extends rm{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){J(this.persistence.referenceDelegate instanceof fs,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new bc(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Oe.withCacheSize(this.cacheSizeBytes):Oe.DEFAULT;return new ds(r=>fs.mi(r,t),this.serializer)}};var ow=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Vf(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=rw.bind(null,this.syncEngine),await $E(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new iu})()}createDatastore(t){let r=Fs(t.databaseInfo.databaseId),i=(function(a){return new Qc(a)})(t.databaseInfo);return(function(a,u,l,d){return new Zc(a,u,l,d)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,s,a,u,l){return new tu(i,s,a,u,l)})(this.localStore,this.datastore,t.asyncQueue,r=>Vf(this.syncEngine,r,0),(function(){return ms.v()?new ms:new Gc})())}createSyncEngine(t,r){return(function(s,a,u,l,d,p,m){let _=new uu(s,a,u,l,d,p);return m&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){let i=F(r);V(an,"RemoteStore shutting down."),i.Ea.add(5),await qr(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var As=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):st("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var xt="FirestoreClient",du=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=fe.UNAUTHENTICATED,this.clientId=Cr.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async a=>{V(xt,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(V(xt,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Me;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=qu(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function Ma(n,e){n.asyncQueue.verifyOperationInProgress(),V(xt,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await qp(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Lf(n,e){n.asyncQueue.verifyOperationInProgress();let t=await aw(n);V(xt,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Df(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Df(e.remoteStore,i)),n._onlineComponents=e}async function aw(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V(xt,"Using user provided OfflineComponentProvider");try{await Ma(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===R.FAILED_PRECONDITION||i.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Cn("Error using user provided cache. Falling back to memory cache: "+t),await Ma(n,new rm)}}else V(xt,"Using default OfflineComponentProvider"),await Ma(n,new hu(void 0));return n._offlineComponents}async function im(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(V(xt,"Using user provided OnlineComponentProvider"),await Lf(n,n._uninitializedComponentsProvider._online)):(V(xt,"Using default OnlineComponentProvider"),await Lf(n,new ow))),n._onlineComponents}function cw(n){return im(n).then(e=>e.syncEngine)}async function sm(n){let e=await im(n),t=e.eventManager;return t.onListen=HE.bind(null,e.syncEngine),t.onUnlisten=JE.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=WE.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=YE.bind(null,e.syncEngine),t}function uw(n,e,t={}){let r=new Me;return n.asyncQueue.enqueueAndForget(async()=>(function(s,a,u,l,d){let p=new As({next:_=>{p.Nu(),a.enqueueAndForget(()=>Jp(s,m));let S=_.docs.has(u);!S&&_.fromCache?d.reject(new D(R.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&_.fromCache&&l&&l.source==="server"?d.reject(new D(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(_)},error:_=>d.reject(_)}),m=new ws(ku(u.path),p,{includeMetadataChanges:!0,qa:!0});return Qp(s,m)})(await sm(n),n.asyncQueue,e,t,r)),r.promise}function lw(n,e,t={}){let r=new Me;return n.asyncQueue.enqueueAndForget(async()=>(function(s,a,u,l,d){let p=new As({next:_=>{p.Nu(),a.enqueueAndForget(()=>Jp(s,m)),_.fromCache&&l.source==="server"?d.reject(new D(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(_)},error:_=>d.reject(_)}),m=new ws(u,p,{includeMetadataChanges:!0,qa:!0});return Qp(s,m)})(await sm(n),n.asyncQueue,e,t,r)),r.promise}function om(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Mf=new Map;var am="firestore.googleapis.com",Ff=!0,bs=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new D(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=am,this.ssl=Ff}else this.host=e.host,this.ssl=e.ssl??Ff;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Bp;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<TE)throw new D(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=om(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new D(R.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new D(R.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new D(R.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Mn=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bs({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new D(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new D(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bs(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Fa;switch(r.type){case"firstParty":return new za(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new D(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=Mf.get(t);r&&(V("ComponentProvider","Removing Datastore"),Mf.delete(t),r.terminate())})(this),Promise.resolve()}};function hw(n,e,t,r={}){n=ot(n,Mn);let i=Le(e),s=n._getSettings(),a=xe(H({},s),{emulatorOptions:n._getEmulatorOptions()}),u=`${e}:${t}`;i&&(dn(`https://${u}`),fn("Firestore",!0)),s.host!==am&&s.host!==u&&Cn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=xe(H({},s),{host:u,ssl:i,emulatorOptions:r});if(!ze(l,a)&&(n._setSettings(l),r.mockUserToken)){let d,p;if(typeof r.mockUserToken=="string")d=r.mockUserToken,p=fe.MOCK_USER;else{d=Ch(r.mockUserToken,n._app?.options.projectId);let m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new D(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new fe(m)}n._authCredentials=new Ua(new Ji(d,p))}}var dt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},ye=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ct(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Br(t,n._jsonSchema))return new n(e,r||null,new x(ee.fromString(t.referencePath)))}};ye._jsonSchemaVersion="firestore/documentReference/1.0",ye._jsonSchema={type:ce("string",ye._jsonSchemaVersion),referencePath:ce("string")};var Ct=class n extends dt{constructor(e,t,r){super(e,t,ku(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ye(this.firestore,null,new x(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function SA(n,e,...t){if(n=X(n),$f("collection","path",e),n instanceof Mn){let r=ee.fromString(e,...t);return rf(r),new Ct(n,null,r)}{if(!(n instanceof ye||n instanceof Ct))throw new D(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ee.fromString(e,...t));return rf(r),new Ct(n.firestore,null,r)}}function dw(n,e,...t){if(n=X(n),arguments.length===1&&(e=Cr.newId()),$f("doc","path",e),n instanceof Mn){let r=ee.fromString(e,...t);return nf(r),new ye(n,null,new x(r))}{if(!(n instanceof ye||n instanceof Ct))throw new D(R.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ee.fromString(e,...t));return nf(r),new ye(n.firestore,n instanceof Ct?n.converter:null,new x(r))}}var Uf="AsyncQueue",Ss=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new gs(this,"async_queue_retry"),this._c=()=>{let r=La();r&&V(Uf,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=La();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=La();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new Me;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!jn(e))throw e;V(Uf,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,st("INTERNAL UNHANDLED ERROR: ",Bf(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=nu.createAndSchedule(this,e,t,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&L(47125,{Pc:Bf(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function Bf(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Lt=class extends Mn{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Ss,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Ss(e),this._firestoreClient=void 0,await e}}};function cm(n,e){let t=typeof n=="object"?n:gn(),r=typeof n=="string"?n:e||ts,i=$t(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=_i("firestore");s&&hw(i,...s)}return i}function Gu(n){if(n._terminated)throw new D(R.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||fw(n),n._firestoreClient}function fw(n){let e=n._freezeSettings(),t=(function(i,s,a,u){return new Ha(i,s,a,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,om(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new du(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){let s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}var Pt=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(we.fromBase64String(e))}catch(t){throw new D(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(we.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Br(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Pt._jsonSchemaVersion="firestore/bytes/1.0",Pt._jsonSchema={type:ce("string",Pt._jsonSchemaVersion),bytes:ce("string")};var Fn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new D(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ke(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Un=class{constructor(e){this._methodName=e}};var Nt=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new D(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new D(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return G(this._lat,e._lat)||G(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Br(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Nt._jsonSchemaVersion="firestore/geoPoint/1.0",Nt._jsonSchema={type:ce("string",Nt._jsonSchemaVersion),latitude:ce("number"),longitude:ce("number")};var Dt=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Br(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new D(R.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Dt._jsonSchemaVersion="firestore/vectorValue/1.0",Dt._jsonSchema={type:ce("string",Dt._jsonSchemaVersion),vectorValues:ce("object")};var pw=/^__.*__$/,fu=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ye(e,this.data,this.fieldMask,t,this.fieldTransforms):new on(e,this.data,t,this.fieldTransforms)}},Rs=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ye(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function um(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L(40011,{Ac:n})}}var pu=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new n(H(H({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ps(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(um(this.Ac)&&pw.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}},mu=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Fs(e)}Cc(e,t,r,i=!1){return new pu({Ac:e,methodName:t,Dc:r,path:ke.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function qs(n){let e=n._freezeSettings(),t=Fs(n._databaseId);return new mu(n._databaseId,!!e.ignoreUndefinedProperties,t)}function mw(n,e,t,r,i,s={}){let a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);Ku("Data must be an object, but it was:",a,r);let u=hm(r,a),l,d;if(s.merge)l=new Ve(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let m of s.mergeFields){let _=_u(e,m,t);if(!a.contains(_))throw new D(R.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);fm(p,_)||p.push(_)}l=new Ve(p),d=a.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,d=a.fieldTransforms;return new fu(new De(u),l,d)}var Cs=class n extends Un{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};var gu=class n extends Un{_toFieldTransform(e){return new ac(e.path,new nn)}isEqual(e){return e instanceof n}};function gw(n,e,t,r){let i=n.Cc(1,e,t);Ku("Data must be an object, but it was:",i,r);let s=[],a=De.empty();Mt(r,(l,d)=>{let p=Hu(e,l,t);d=X(d);let m=i.yc(p);if(d instanceof Cs)s.push(p);else{let _=jr(d,m);_!=null&&(s.push(p),a.set(p,_))}});let u=new Ve(s);return new Rs(a,u,i.fieldTransforms)}function _w(n,e,t,r,i,s){let a=n.Cc(1,e,t),u=[_u(e,r,t)],l=[i];if(s.length%2!=0)throw new D(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)u.push(_u(e,s[_])),l.push(s[_+1]);let d=[],p=De.empty();for(let _=u.length-1;_>=0;--_)if(!fm(d,u[_])){let S=u[_],P=l[_];P=X(P);let O=a.yc(S);if(P instanceof Cs)d.push(S);else{let N=jr(P,O);N!=null&&(d.push(S),p.set(S,N))}}let m=new Ve(d);return new Rs(p,m,a.fieldTransforms)}function lm(n,e,t,r=!1){return jr(t,n.Cc(r?4:3,e))}function jr(n,e){if(dm(n=X(n)))return Ku("Unsupported field value:",e,n),hm(n,e);if(n instanceof Un)return(function(r,i){if(!um(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){let s=[],a=0;for(let u of r){let l=jr(u,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=X(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return JI(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=ue.fromDate(r);return{timestampValue:ls(i.serializer,s)}}if(r instanceof ue){let s=new ue(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ls(i.serializer,s)}}if(r instanceof Nt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pt)return{bytesValue:Op(i.serializer,r._byteString)};if(r instanceof ye){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:xu(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Dt)return(function(a,u){return{mapValue:{fields:{[Ru]:{stringValue:Cu},[Nn]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw u.Sc("VectorValues must only contain numeric values.");return Vu(u.serializer,d)})}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${ks(r)}`)})(n,e)}function hm(n,e){let t={};return op(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Mt(n,(r,i)=>{let s=jr(i,e.mc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function dm(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ue||n instanceof Nt||n instanceof Pt||n instanceof ye||n instanceof Un||n instanceof Dt)}function Ku(n,e,t){if(!dm(t)||!Gf(t)){let r=ks(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function _u(n,e,t){if((e=X(e))instanceof Fn)return e._internalPath;if(typeof e=="string")return Hu(n,e);throw Ps("Field path arguments must be of type string or ",n,!1,void 0,t)}var yw=new RegExp("[~\\*/\\[\\]]");function Hu(n,e,t){if(e.search(yw)>=0)throw Ps(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Fn(...e.split("."))._internalPath}catch{throw Ps(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ps(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new D(R.INVALID_ARGUMENT,u+n+l)}function fm(n,e){return n.some(t=>t.isEqual(e))}var Fr=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ye(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new yu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(zs("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},yu=class extends Fr{data(){return super.data()}};function zs(n,e){return typeof e=="string"?Hu(n,e):e instanceof Fn?e._internalPath:e._delegate._internalPath}function Iw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new D(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ur=class{},Bn=class extends Ur{};function RA(n,e,...t){let r=[];e instanceof Ur&&r.push(e),r=r.concat(t),(function(s){let a=s.filter(l=>l instanceof Iu).length,u=s.filter(l=>l instanceof Ns).length;if(a>1||a>0&&u>0)throw new D(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var Ns=class n extends Bn{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return pm(e._query,t),new dt(e.firestore,e.converter,oc(e._query,t))}_parse(e){let t=qs(e.firestore);return(function(s,a,u,l,d,p,m){let _;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new D(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){zf(m,p);let P=[];for(let O of m)P.push(qf(l,s,O));_={arrayValue:{values:P}}}else _=qf(l,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||zf(m,p),_=lm(u,a,m,p==="in"||p==="not-in");return ae.create(d,p,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function CA(n,e,t){let r=e,i=zs("where",n);return Ns._create(i,r,t)}var Iu=class n extends Ur{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ue.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i,u=s.getFlattenedFilters();for(let l of u)pm(a,l),a=oc(a,l)})(e._query,t),new dt(e.firestore,e.converter,oc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Eu=class n extends Bn{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(i,s,a){if(i.startAt!==null)throw new D(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new D(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new tn(s,a)})(e._query,this._field,this._direction);return new dt(e.firestore,e.converter,(function(i,s){let a=i.explicitOrderBy.concat([s]);return new ut(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}};function PA(n,e="asc"){let t=e,r=zs("orderBy",n);return Eu._create(r,t)}var wu=class n extends Bn{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new dt(e.firestore,e.converter,ss(e._query,this._limit,this._limitType))}};function NA(n){return II("limit",n),wu._create("limit",n,"F")}var vu=class n extends Bn{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=Ew(e,this.type,this._docOrFields,this._inclusive);return new dt(e.firestore,e.converter,(function(i,s){return new ut(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)})(e._query,t))}};function DA(...n){return vu._create("startAfter",n,!1)}function Ew(n,e,t,r){if(t[0]=X(t[0]),t[0]instanceof Fr)return(function(s,a,u,l,d){if(!l)throw new D(R.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);let p=[];for(let m of An(s))if(m.field.isKeyField())p.push(rs(a,l.key));else{let _=l.data.field(m.field);if(Vs(_))throw new D(R.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+m.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(_===null){let S=m.field.canonicalString();throw new D(R.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${S}' (used as the orderBy) does not exist.`)}p.push(_)}return new Ot(p,d)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=qs(n.firestore);return(function(a,u,l,d,p,m){let _=a.explicitOrderBy;if(p.length>_.length)throw new D(R.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let S=[];for(let P=0;P<p.length;P++){let O=p[P];if(_[P].field.isKeyField()){if(typeof O!="string")throw new D(R.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof O}`);if(!Ou(a)&&O.indexOf("/")!==-1)throw new D(R.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${O}' contains a slash.`);let N=a.path.child(ee.fromString(O));if(!x.isDocumentKey(N))throw new D(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);let B=new x(N);S.push(rs(u,B))}else{let N=lm(l,d,O);S.push(N)}}return new Ot(S,m)})(n._query,n.firestore._databaseId,i,e,t,r)}}function qf(n,e,t){if(typeof(t=X(t))=="string"){if(t==="")throw new D(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ou(e)&&t.indexOf("/")!==-1)throw new D(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ee.fromString(t));if(!x.isDocumentKey(r))throw new D(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return rs(n,new x(r))}if(t instanceof ye)return rs(n,t._key);throw new D(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ks(t)}.`)}function zf(n,e){if(!Array.isArray(n)||n.length===0)throw new D(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pm(n,e){let t=(function(i,s){for(let a of i)for(let u of a.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new D(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Tu=class{convertValue(e,t="none"){switch(kt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return te(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ct(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw L(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Mt(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){let t=e.fields?.[Nn].arrayValue?.values?.map(r=>te(r.doubleValue));return new Dt(t)}convertGeoPoint(e){return new Nt(te(e.latitude),te(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=xs(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Dr(e));default:return null}}convertTimestamp(e){let t=at(e);return new ue(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ee.fromString(e);J(Up(r),9688,{name:e});let i=new ns(r.get(1),r.get(3)),s=new x(r.popFirst(5));return i.isEqual(t)||st(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function ww(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Yt=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Xt=class n extends Fr{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Sn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(zs("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new D(R.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Xt._jsonSchemaVersion="firestore/documentSnapshot/1.0",Xt._jsonSchema={type:ce("string",Xt._jsonSchemaVersion),bundleSource:ce("string","DocumentSnapshot"),bundleName:ce("string"),bundle:ce("string")};var Sn=class extends Xt{data(e={}){return super.data(e)}},Rn=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Yt(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Sn(this._firestore,this._userDataWriter,r.key,r,new Yt(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new D(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let l=new Sn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Yt(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let l=new Sn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Yt(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:vw(u.type),doc:l,oldIndex:d,newIndex:p}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new D(R.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Cr.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function vw(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L(61501,{type:n})}}function kA(n){n=ot(n,ye);let e=ot(n.firestore,Lt);return uw(Gu(e),n._key).then(t=>Tw(e,n,t))}Rn._jsonSchemaVersion="firestore/querySnapshot/1.0",Rn._jsonSchema={type:ce("string",Rn._jsonSchemaVersion),bundleSource:ce("string","QuerySnapshot"),bundleName:ce("string"),bundle:ce("string")};var Ds=class extends Tu{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pt(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ye(this.firestore,null,t)}};function OA(n){n=ot(n,dt);let e=ot(n.firestore,Lt),t=Gu(e),r=new Ds(e);return Iw(n._query),lw(t,n._query).then(i=>new Rn(e,r,n,i))}function VA(n,e,t,...r){n=ot(n,ye);let i=ot(n.firestore,Lt),s=qs(i),a;return a=typeof(e=X(e))=="string"||e instanceof Fn?_w(s,"updateDoc",n._key,e,t,r):gw(s,"updateDoc",n._key,e),Wu(i,[a.toMutation(n._key,it.exists(!0))])}function xA(n){return Wu(ot(n.firestore,Lt),[new Or(n._key,it.none())])}function LA(n,e){let t=ot(n.firestore,Lt),r=dw(n),i=ww(n.converter,e);return Wu(t,[mw(qs(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,it.exists(!1))]).then(()=>r)}function Wu(n,e){return(function(r,i){let s=new Me;return r.asyncQueue.enqueueAndForget(async()=>XE(await cw(r),i,s)),s.promise})(Gu(n),e)}function Tw(n,e,t){let r=t.docs.get(e._key),i=new Ds(n);return new Xt(n,i,e._key,r,new Yt(t.hasPendingWrites,t.fromCache),e.converter)}function MA(){return new gu("serverTimestamp")}(function(e,t=!0){(function(i){qn=i})(vt),$e(new Re("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),u=new Lt(new Ba(r.getProvider("auth-internal")),new ja(a,r.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new D(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ns(d.options.projectId,p)})(a,i),a);return s=H({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Ce(Zd,ef,e),Ce(Zd,ef,"esm2020")})();var Aw="type.googleapis.com/google.protobuf.Int64Value",bw="type.googleapis.com/google.protobuf.UInt64Value";function ym(n,e){let t={};for(let r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function js(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>js(e));if(typeof n=="function"||typeof n=="object")return ym(n,e=>js(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Gn(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case Aw:case bw:{let e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Gn(e)):typeof n=="function"||typeof n=="object"?ym(n,e=>Gn(e)):n}var Xu="functions";var mm={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Pe=class n extends Ae{constructor(e,t,r){super(`${Xu}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,n.prototype)}};function Sw(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function $s(n,e){let t=Sw(n),r=t,i;try{let s=e&&e.error;if(s){let a=s.status;if(typeof a=="string"){if(!mm[a])return new Pe("internal","internal");t=mm[a],r=a}let u=s.message;typeof u=="string"&&(r=u),i=s.details,i!==void 0&&(i=Gn(i))}}catch{}return t==="ok"?null:new Pe(t,r,i)}var Qu=class{constructor(e,t,r,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,be(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i?.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){let t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){let t=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:i}}};var Ju="us-central1",Rw=/^data: (.*?)(?:\n|$)/;function Cw(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new Pe("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}var Yu=class{constructor(e,t,r,i,s=Ju,a=(...u)=>fetch(...u)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new Qu(e,t,r,i),this.cancelAllRequests=new Promise(u=>{this.deleteService=()=>Promise.resolve(u())});try{let u=new URL(s);this.customDomain=u.origin+(u.pathname==="/"?"":u.pathname),this.region=Ju}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function Pw(n,e,t){let r=Le(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(dn(n.emulatorOrigin+"/backends"),fn("Functions",!0))}function Nw(n,e,t){let r=i=>kw(n,e,i,t||{});return r.stream=(i,s)=>Vw(n,e,i,s),r}function Im(n){return n.emulatorOrigin&&Le(n.emulatorOrigin)?"include":void 0}async function Dw(n,e,t,r,i){t["Content-Type"]="application/json";let s;try{s=await r(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:Im(i)})}catch{return{status:0,json:null}}let a=null;try{a=await s.json()}catch{}return{status:s.status,json:a}}async function Em(n,e){let t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function kw(n,e,t,r){let i=n._url(e);return Ow(n,i,t,r)}async function Ow(n,e,t,r){t=js(t);let i={data:t},s=await Em(n,r),a=r.timeout||7e4,u=Cw(a),l=await Promise.race([Dw(e,i,s,n.fetchImpl,n),u.promise,n.cancelAllRequests]);if(u.cancel(),!l)throw new Pe("cancelled","Firebase Functions instance was deleted.");let d=$s(l.status,l.json);if(d)throw d;if(!l.json)throw new Pe("internal","Response is not valid JSON object.");let p=l.json.data;if(typeof p>"u"&&(p=l.json.result),typeof p>"u")throw new Pe("internal","Response is missing data field.");return{data:Gn(p)}}function Vw(n,e,t,r){let i=n._url(e);return xw(n,i,t,r||{})}async function xw(n,e,t,r){t=js(t);let i={data:t},s=await Em(n,r);s["Content-Type"]="application/json",s.Accept="text/event-stream";let a;try{a=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:s,signal:r?.signal,credentials:Im(n)})}catch(_){if(_ instanceof Error&&_.name==="AbortError"){let P=new Pe("cancelled","Request was cancelled.");return{data:Promise.reject(P),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(P)}}}}}}let S=$s(0,null);return{data:Promise.reject(S),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(S)}}}}}}let u,l,d=new Promise((_,S)=>{u=_,l=S});r?.signal?.addEventListener("abort",()=>{let _=new Pe("cancelled","Request was cancelled.");l(_)});let p=a.body.getReader(),m=Lw(p,u,l,r?.signal);return{stream:{[Symbol.asyncIterator](){let _=m.getReader();return{async next(){let{value:S,done:P}=await _.read();return{value:S,done:P}},async return(){return await _.cancel(),{done:!0,value:void 0}}}}},data:d}}function Lw(n,e,t,r){let i=(a,u)=>{let l=a.match(Rw);if(!l)return;let d=l[1];try{let p=JSON.parse(d);if("result"in p){e(Gn(p.result));return}if("message"in p){u.enqueue(Gn(p.message));return}if("error"in p){let m=$s(0,p);u.error(m),t(m);return}}catch(p){if(p instanceof Pe){u.error(p),t(p);return}}},s=new TextDecoder;return new ReadableStream({start(a){let u="";return l();async function l(){if(r?.aborted){let d=new Pe("cancelled","Request was cancelled");return a.error(d),t(d),Promise.resolve()}try{let{value:d,done:p}=await n.read();if(p){u.trim()&&i(u.trim(),a),a.close();return}if(r?.aborted){let _=new Pe("cancelled","Request was cancelled");a.error(_),t(_),await n.cancel();return}u+=s.decode(d,{stream:!0});let m=u.split(`
`);u=m.pop()||"";for(let _ of m)_.trim()&&i(_.trim(),a);return l()}catch(d){let p=d instanceof Pe?d:$s(0,null);a.error(p),t(p)}}},cancel(){return n.cancel()}})}var gm="@firebase/functions",_m="0.13.1";var Mw="auth-internal",Fw="app-check-internal",Uw="messaging-internal";function Bw(n){let e=(t,{instanceIdentifier:r})=>{let i=t.getProvider("app").getImmediate(),s=t.getProvider(Mw),a=t.getProvider(Uw),u=t.getProvider(Fw);return new Yu(i,s,a,u,r)};$e(new Re(Xu,e,"PUBLIC").setMultipleInstances(!0)),Ce(gm,_m,n),Ce(gm,_m,"esm2020")}function wm(n=gn(),e=Ju){let r=$t(X(n),Xu).getImmediate({identifier:e}),i=_i("functions");return i&&qw(r,...i),r}function qw(n,e,t){Pw(X(n),e,t)}function GA(n,e,t){return Nw(X(n),e,t)}Bw();var vm={production:!0,version:"1.0.0",encryptionKey:"hostinger-workspace-encryption-key-2026-secure-32chars",cloudFunctionsUrl:"https://us-central1-hostinger-workspace-manager.cloudfunctions.net",firebase:{apiKey:"AIzaSyBAtCWvxDHyYXA_xh4f3x7D7Rl82OQsxqA",authDomain:"hostinger-workspace-manager.firebaseapp.com",projectId:"hostinger-workspace-manager",storageBucket:"hostinger-workspace-manager.firebasestorage.app",messagingSenderId:"503361832560",appId:"1:503361832560:web:49801ef3604d20649316b5",measurementId:"G-962EJYLVCD"},api:{hostinger:{baseUrl:"https://api.hostinger.com/v1",timeout:1e4}}};var Tm=class{static app=null;static authInstance=null;static firestoreInstance=null;static functionsInstance=null;static initialize(){if(this.app){console.warn("Firebase already initialized");return}this.app=Jo(vm.firebase)}static getApp(){if(!this.app)throw new Error("Firebase not initialized. Call FirebaseAdapter.initialize() first.");return this.app}static getAuth(){return this.authInstance||(this.authInstance=Sa(this.getApp()),Aa(this.authInstance,Bi).catch(e=>{console.error("Error setting auth persistence:",e)})),this.authInstance}static getFirestore(){return this.firestoreInstance||(this.firestoreInstance=cm(this.getApp())),this.firestoreInstance}static getFunctions(){return this.functionsInstance||(this.functionsInstance=wm(this.getApp(),"us-central1")),this.functionsInstance}};var jw=["data-p-icon","times"],cb=(()=>{class n extends wh{static \u0275fac=(()=>{let t;return function(i){return(t||(t=ui(n)))(i||n)}})();static \u0275cmp=li({type:n,selectors:[["","data-p-icon","times"]],features:[ur],attrs:jw,decls:1,vars:0,consts:[["d","M8.01186 7.00933L12.27 2.75116C12.341 2.68501 12.398 2.60524 12.4375 2.51661C12.4769 2.42798 12.4982 2.3323 12.4999 2.23529C12.5016 2.13827 12.4838 2.0419 12.4474 1.95194C12.4111 1.86197 12.357 1.78024 12.2884 1.71163C12.2198 1.64302 12.138 1.58893 12.0481 1.55259C11.9581 1.51625 11.8617 1.4984 11.7647 1.50011C11.6677 1.50182 11.572 1.52306 11.4834 1.56255C11.3948 1.60204 11.315 1.65898 11.2488 1.72997L6.99067 5.98814L2.7325 1.72997C2.59553 1.60234 2.41437 1.53286 2.22718 1.53616C2.03999 1.53946 1.8614 1.61529 1.72901 1.74767C1.59663 1.88006 1.5208 2.05865 1.5175 2.24584C1.5142 2.43303 1.58368 2.61419 1.71131 2.75116L5.96948 7.00933L1.71131 11.2675C1.576 11.403 1.5 11.5866 1.5 11.7781C1.5 11.9696 1.576 12.1532 1.71131 12.2887C1.84679 12.424 2.03043 12.5 2.2219 12.5C2.41338 12.5 2.59702 12.424 2.7325 12.2887L6.99067 8.03052L11.2488 12.2887C11.3843 12.424 11.568 12.5 11.7594 12.5C11.9509 12.5 12.1346 12.424 12.27 12.2887C12.4053 12.1532 12.4813 11.9696 12.4813 11.7781C12.4813 11.5866 12.4053 11.403 12.27 11.2675L8.01186 7.00933Z","fill","currentColor"]],template:function(r,i){r&1&&(sh(),dh(0,"path",0))},encapsulation:2})}return n})();var Am=class n{static isArray(e,t=!0){return Array.isArray(e)&&(t||e.length!==0)}static isObject(e,t=!0){return typeof e=="object"&&!Array.isArray(e)&&e!=null&&(t||Object.keys(e).length!==0)}static equals(e,t,r){return r?this.resolveFieldData(e,r)===this.resolveFieldData(t,r):this.equalsByValue(e,t)}static equalsByValue(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var r=Array.isArray(e),i=Array.isArray(t),s,a,u;if(r&&i){if(a=e.length,a!=t.length)return!1;for(s=a;s--!==0;)if(!this.equalsByValue(e[s],t[s]))return!1;return!0}if(r!=i)return!1;var l=this.isDate(e),d=this.isDate(t);if(l!=d)return!1;if(l&&d)return e.getTime()==t.getTime();var p=e instanceof RegExp,m=t instanceof RegExp;if(p!=m)return!1;if(p&&m)return e.toString()==t.toString();var _=Object.keys(e);if(a=_.length,a!==Object.keys(t).length)return!1;for(s=a;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,_[s]))return!1;for(s=a;s--!==0;)if(u=_[s],!this.equalsByValue(e[u],t[u]))return!1;return!0}return e!==e&&t!==t}static resolveFieldData(e,t){if(e&&t){if(this.isFunction(t))return t(e);if(t.indexOf(".")==-1)return e[t];{let r=t.split("."),i=e;for(let s=0,a=r.length;s<a;++s){if(i==null)return null;i=i[r[s]]}return i}}else return null}static isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)}static reorderArray(e,t,r){let i;e&&t!==r&&(r>=e.length&&(r%=e.length,t%=e.length),e.splice(r,0,e.splice(t,1)[0]))}static insertIntoOrderedArray(e,t,r,i){if(r.length>0){let s=!1;for(let a=0;a<r.length;a++)if(this.findIndexInList(r[a],i)>t){r.splice(a,0,e),s=!0;break}s||r.push(e)}else r.push(e)}static findIndexInList(e,t){let r=-1;if(t){for(let i=0;i<t.length;i++)if(t[i]==e){r=i;break}}return r}static contains(e,t){if(e!=null&&t&&t.length){for(let r of t)if(this.equals(e,r))return!0}return!1}static removeAccents(e){return e&&(e=e.normalize("NFKD").replace(new RegExp("\\p{Diacritic}","gu"),"")),e}static isDate(e){return Object.prototype.toString.call(e)==="[object Date]"}static isEmpty(e){return e==null||e===""||Array.isArray(e)&&e.length===0||!this.isDate(e)&&typeof e=="object"&&Object.keys(e).length===0}static isNotEmpty(e){return!this.isEmpty(e)}static compare(e,t,r,i=1){let s=-1,a=this.isEmpty(e),u=this.isEmpty(t);return a&&u?s=0:a?s=i:u?s=-i:typeof e=="string"&&typeof t=="string"?s=e.localeCompare(t,r,{numeric:!0}):s=e<t?-1:e>t?1:0,s}static sort(e,t,r=1,i,s=1){let a=n.compare(e,t,i,r),u=r;return(n.isEmpty(e)||n.isEmpty(t))&&(u=s===1?r:s),u*a}static merge(e,t){if(!(e==null&&t==null)){{if((e==null||typeof e=="object")&&(t==null||typeof t=="object"))return H(H({},e||{}),t||{});if((e==null||typeof e=="string")&&(t==null||typeof t=="string"))return[e||"",t||""].join(" ")}return t||e}}static isPrintableCharacter(e=""){return this.isNotEmpty(e)&&e.length===1&&e.match(/\S| /)}static getItemValue(e,...t){return this.isFunction(e)?e(...t):e}static findLastIndex(e,t){let r=-1;if(this.isNotEmpty(e))try{r=e.findLastIndex(t)}catch{r=e.lastIndexOf([...e].reverse().find(t))}return r}static findLast(e,t){let r;if(this.isNotEmpty(e))try{r=e.findLast(t)}catch{r=[...e].reverse().find(t)}return r}static deepEquals(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var r=Array.isArray(e),i=Array.isArray(t),s,a,u;if(r&&i){if(a=e.length,a!=t.length)return!1;for(s=a;s--!==0;)if(!this.deepEquals(e[s],t[s]))return!1;return!0}if(r!=i)return!1;var l=e instanceof Date,d=t instanceof Date;if(l!=d)return!1;if(l&&d)return e.getTime()==t.getTime();var p=e instanceof RegExp,m=t instanceof RegExp;if(p!=m)return!1;if(p&&m)return e.toString()==t.toString();var _=Object.keys(e);if(a=_.length,a!==Object.keys(t).length)return!1;for(s=a;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,_[s]))return!1;for(s=a;s--!==0;)if(u=_[s],!this.deepEquals(e[u],t[u]))return!1;return!0}return e!==e&&t!==t}static minifyCSS(e){return e&&e.replace(/\/\*(?:(?!\*\/)[\s\S])*\*\/|[\r\n\t]+/g,"").replace(/ {2,}/g," ").replace(/ ([{:}]) /g,"$1").replace(/([;,]) /g,"$1").replace(/ !/g,"!").replace(/: /g,":")}static toFlatCase(e){return this.isString(e)?e.replace(/(-|_)/g,"").toLowerCase():e}static isString(e,t=!0){return typeof e=="string"&&(t||e!=="")}},bm=0;function lb(n="pn_id_"){return bm++,`${n}${bm}`}function $w(){let n=[],e=(s,a)=>{let u=n.length>0?n[n.length-1]:{key:s,value:a},l=u.value+(u.key===s?0:a)+2;return n.push({key:s,value:l}),l},t=s=>{n=n.filter(a=>a.value!==s)},r=()=>n.length>0?n[n.length-1].value:0,i=s=>s&&parseInt(s.style.zIndex,10)||0;return{get:i,set:(s,a,u)=>{a&&(a.style.zIndex=String(e(s,u)))},clear:s=>{s&&(t(i(s)),s.style.zIndex="")},getCurrent:()=>r(),generateZIndex:e,revertZIndex:t}}var hb=$w(),db=n=>!!n;var Gw=Object.defineProperty,Sm=Object.getOwnPropertySymbols,Kw=Object.prototype.hasOwnProperty,Hw=Object.prototype.propertyIsEnumerable,Rm=(n,e,t)=>e in n?Gw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Cm=(n,e)=>{for(var t in e||(e={}))Kw.call(e,t)&&Rm(n,t,e[t]);if(Sm)for(var t of Sm(e))Hw.call(e,t)&&Rm(n,t,e[t]);return n},Ww=(n,e,t)=>new Promise((r,i)=>{var s=l=>{try{u(t.next(l))}catch(d){i(d)}},a=l=>{try{u(t.throw(l))}catch(d){i(d)}},u=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,a);u((t=t.apply(n,e)).next())}),Gs="animation",$r="transition";function Qw(n){return n?n.disabled||!!(n.safe&&yh()):!1}function Jw(n,e){return n?Cm(Cm({},n),Object.entries(e).reduce((t,[r,i])=>{var s;return t[r]=(s=n[r])!=null?s:i,t},{})):e}function Yw(n){let{name:e,enterClass:t,leaveClass:r}=n||{};return{enter:{from:t?.from||`${e}-enter-from`,to:t?.to||`${e}-enter-to`,active:t?.active||`${e}-enter-active`},leave:{from:r?.from||`${e}-leave-from`,to:r?.to||`${e}-leave-to`,active:r?.active||`${e}-leave-active`}}}function Xw(n){return{enter:{onBefore:n?.onBeforeEnter,onStart:n?.onEnter,onAfter:n?.onAfterEnter,onCancelled:n?.onEnterCancelled},leave:{onBefore:n?.onBeforeLeave,onStart:n?.onLeave,onAfter:n?.onAfterLeave,onCancelled:n?.onLeaveCancelled}}}function Zw(n,e){let t=window.getComputedStyle(n),r=S=>{let P=t[`${S}Delay`],O=t[`${S}Duration`];return[P.split(", ").map(So),O.split(", ").map(So)]},[i,s]=r($r),[a,u]=r(Gs),l=Math.max(...s.map((S,P)=>S+i[P])),d=Math.max(...u.map((S,P)=>S+a[P])),p,m=0,_=0;return e===$r?l>0&&(p=$r,m=l,_=s.length):e===Gs?d>0&&(p=Gs,m=d,_=u.length):(m=Math.max(l,d),p=m>0?l>d?$r:Gs:void 0,_=p?p===$r?s.length:u.length:0),{type:p,timeout:m,count:_}}function ev(n,e){return typeof n=="number"?n:typeof n=="object"&&n[e]!=null?n[e]:null}function tv(n,e=!0,t=!1){if(!e&&!t)return;let r=_h(n);e&&bo(n,"--pui-motion-height",r.height+"px"),t&&bo(n,"--pui-motion-width",r.width+"px")}var nv={name:"p",safe:!0,disabled:!1,enter:!0,leave:!0,autoHeight:!0,autoWidth:!1};function Zu(n,e){if(!n)throw new Error("Element is required.");let t={},r=!1,i={},s=null,a={},u=p=>{if(Object.assign(t,Jw(p,nv)),!t.enter&&!t.leave)throw new Error("Enter or leave must be true.");a=Xw(t),r=Qw(t),i=Yw(t),s=null},l=p=>Ww(null,null,function*(){s?.();let{onBefore:m,onStart:_,onAfter:S,onCancelled:P}=a[p]||{},O={element:n};if(r){m?.(O),_?.(O),S?.(O);return}let{from:N,active:B,to:$}=i[p]||{};return tv(n,t.autoHeight,t.autoWidth),m?.(O),hi(n,N),hi(n,B),n.offsetHeight,Ao(n,N),hi(n,$),_?.(O),new Promise(Q=>{let me=ev(t.duration,p),ge=()=>{Ao(n,[$,B]),s=null},ie=()=>{ge(),S?.(O),Q()};s=()=>{ge(),P?.(O),Q()},iv(n,t.type,me,ie)})});u(e);let d={enter:()=>t.enter?l("enter"):Promise.resolve(),leave:()=>t.leave?l("leave"):Promise.resolve(),cancel:()=>{s?.(),s=null},update:(p,m)=>{if(!p)throw new Error("Element is required.");n=p,d.cancel(),u(m)}};return t.appear&&d.enter(),d}var rv=0;function iv(n,e,t,r){let i=n._motionEndId=++rv,s=()=>{i===n._motionEndId&&r()};if(t!=null)return setTimeout(s,t);let{type:a,timeout:u,count:l}=Zw(n,e);if(!a){r();return}let d=a+"end",p=0,m=()=>{n.removeEventListener(d,_,!0),s()},_=S=>{S.target===n&&++p>=l&&m()};n.addEventListener(d,_,{capture:!0,once:!0}),setTimeout(()=>{p<l&&m()},u+1)}var sv=["*"];function ov(n,e){n&1&&ph(0)}var Ks=new WeakMap;function Gr(n,e){if(n)switch(Ks.has(n)||Ks.set(n,{display:n.style.display,visibility:n.style.visibility,maxHeight:n.style.maxHeight}),e){case"display":n.style.display="none";break;case"visibility":n.style.visibility="hidden",n.style.maxHeight="0";break}}function Hs(n,e){if(!n)return;let t=Ks.get(n)??n.style;switch(e){case"display":n.style.display=t?.display||"";break;case"visibility":n.style.visibility=t?.visibility||"",n.style.maxHeight=t?.maxHeight||"";break}Ks.delete(n)}var av=`
    .p-motion {
        display: block;
    }
`,cv={root:"p-motion"},el=(()=>{class n extends Ih{name="motion";style=av;classes=cv;static \u0275fac=(()=>{let t;return function(i){return(t||(t=ui(n)))(i||n)}})();static \u0275prov=rh({token:n,factory:n.\u0275fac})}return n})();var Pm=new Eo("MOTION_INSTANCE"),uv=(()=>{class n extends Co{$pcMotion=cr(Pm,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=cr(fi,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}_componentStyle=cr(el);visible=z(!1);mountOnEnter=z(!0);unmountOnLeave=z(!0);name=z(void 0);type=z(void 0);safe=z(void 0);disabled=z(!1);appear=z(!1);enter=z(!0);leave=z(!0);duration=z(void 0);hideStrategy=z("display");enterFromClass=z(void 0);enterToClass=z(void 0);enterActiveClass=z(void 0);leaveFromClass=z(void 0);leaveToClass=z(void 0);leaveActiveClass=z(void 0);options=z({});onBeforeEnter=_e();onEnter=_e();onAfterEnter=_e();onEnterCancelled=_e();onBeforeLeave=_e();onLeave=_e();onAfterLeave=_e();onLeaveCancelled=_e();motionOptions=vo(()=>{let t=this.options();return{name:t.name??this.name(),type:t.type??this.type(),safe:t.safe??this.safe(),disabled:t.disabled??this.disabled(),appear:!1,enter:t.enter??this.enter(),leave:t.leave??this.leave(),duration:t.duration??this.duration(),enterClass:{from:t.enterClass?.from??(t.name?void 0:this.enterFromClass()),to:t.enterClass?.to??(t.name?void 0:this.enterToClass()),active:t.enterClass?.active??(t.name?void 0:this.enterActiveClass())},leaveClass:{from:t.leaveClass?.from??(t.name?void 0:this.leaveFromClass()),to:t.leaveClass?.to??(t.name?void 0:this.leaveToClass()),active:t.leaveClass?.active??(t.name?void 0:this.leaveActiveClass())},onBeforeEnter:t.onBeforeEnter??this.handleBeforeEnter,onEnter:t.onEnter??this.handleEnter,onAfterEnter:t.onAfterEnter??this.handleAfterEnter,onEnterCancelled:t.onEnterCancelled??this.handleEnterCancelled,onBeforeLeave:t.onBeforeLeave??this.handleBeforeLeave,onLeave:t.onLeave??this.handleLeave,onAfterLeave:t.onAfterLeave??this.handleAfterLeave,onLeaveCancelled:t.onLeaveCancelled??this.handleLeaveCancelled}});motion;isInitialMount=!0;cancelled=!1;destroyed=!1;rendered=oh(!1);handleBeforeEnter=t=>!this.destroyed&&this.onBeforeEnter.emit(t);handleEnter=t=>!this.destroyed&&this.onEnter.emit(t);handleAfterEnter=t=>!this.destroyed&&this.onAfterEnter.emit(t);handleEnterCancelled=t=>!this.destroyed&&this.onEnterCancelled.emit(t);handleBeforeLeave=t=>!this.destroyed&&this.onBeforeLeave.emit(t);handleLeave=t=>!this.destroyed&&this.onLeave.emit(t);handleAfterLeave=t=>!this.destroyed&&this.onAfterLeave.emit(t);handleLeaveCancelled=t=>!this.destroyed&&this.onLeaveCancelled.emit(t);constructor(){super(),ci(()=>{let t=this.hideStrategy();this.isInitialMount?(Gr(this.$el,t),this.rendered.set(this.visible()&&this.mountOnEnter()||!this.mountOnEnter())):this.visible()&&!this.rendered()&&(Gr(this.$el,t),this.rendered.set(!0))}),ci(()=>{this.motion||(this.motion=Zu(this.$el,this.motionOptions()))}),To(async()=>{if(!this.$el)return;let t=this.isInitialMount&&this.visible()&&this.appear(),r=this.hideStrategy();this.visible()?(await di(),Hs(this.$el,r),(t||!this.isInitialMount)&&this.motion?.enter()):this.isInitialMount||(await di(),this.motion?.leave()?.then(async()=>{this.$el&&!this.cancelled&&!this.visible()&&(Gr(this.$el,r),this.unmountOnLeave()&&(await di(),this.cancelled||this.rendered.set(!1)))})),this.isInitialMount=!1})}onDestroy(){this.destroyed=!0,this.cancelled=!0,this.motion?.cancel(),this.motion=void 0,Hs(this.$el,this.hideStrategy()),this.isInitialMount=!0}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=li({type:n,selectors:[["p-motion"]],hostVars:2,hostBindings:function(r,i){r&2&&mh(i.cx("root"))},inputs:{visible:[1,"visible"],mountOnEnter:[1,"mountOnEnter"],unmountOnLeave:[1,"unmountOnLeave"],name:[1,"name"],type:[1,"type"],safe:[1,"safe"],disabled:[1,"disabled"],appear:[1,"appear"],enter:[1,"enter"],leave:[1,"leave"],duration:[1,"duration"],hideStrategy:[1,"hideStrategy"],enterFromClass:[1,"enterFromClass"],enterToClass:[1,"enterToClass"],enterActiveClass:[1,"enterActiveClass"],leaveFromClass:[1,"leaveFromClass"],leaveToClass:[1,"leaveToClass"],leaveActiveClass:[1,"leaveActiveClass"],options:[1,"options"]},outputs:{onBeforeEnter:"onBeforeEnter",onEnter:"onEnter",onAfterEnter:"onAfterEnter",onEnterCancelled:"onEnterCancelled",onBeforeLeave:"onBeforeLeave",onLeave:"onLeave",onAfterLeave:"onAfterLeave",onLeaveCancelled:"onLeaveCancelled"},features:[wo([el,{provide:Pm,useExisting:n},{provide:Ro,useExisting:n}]),uh([fi]),ur],ngContentSelectors:sv,decls:1,vars:1,template:function(r,i){r&1&&(fh(),lh(0,ov,1,0)),r&2&&hh(i.rendered()?0:-1)},dependencies:[gh,Eh],encapsulation:2})}return n})(),Nm=new Eo("MOTION_DIRECTIVE_INSTANCE"),Nb=(()=>{class n extends Co{$pcMotionDirective=cr(Nm,{optional:!0,skipSelf:!0})??void 0;visible=z(!1,{alias:"pMotion"});name=z(void 0,{alias:"pMotionName"});type=z(void 0,{alias:"pMotionType"});safe=z(void 0,{alias:"pMotionSafe"});disabled=z(!1,{alias:"pMotionDisabled"});appear=z(!1,{alias:"pMotionAppear"});enter=z(!0,{alias:"pMotionEnter"});leave=z(!0,{alias:"pMotionLeave"});duration=z(void 0,{alias:"pMotionDuration"});hideStrategy=z("display",{alias:"pMotionHideStrategy"});enterFromClass=z(void 0,{alias:"pMotionEnterFromClass"});enterToClass=z(void 0,{alias:"pMotionEnterToClass"});enterActiveClass=z(void 0,{alias:"pMotionEnterActiveClass"});leaveFromClass=z(void 0,{alias:"pMotionLeaveFromClass"});leaveToClass=z(void 0,{alias:"pMotionLeaveToClass"});leaveActiveClass=z(void 0,{alias:"pMotionLeaveActiveClass"});options=z({},{alias:"pMotionOptions"});onBeforeEnter=_e({alias:"pMotionOnBeforeEnter"});onEnter=_e({alias:"pMotionOnEnter"});onAfterEnter=_e({alias:"pMotionOnAfterEnter"});onEnterCancelled=_e({alias:"pMotionOnEnterCancelled"});onBeforeLeave=_e({alias:"pMotionOnBeforeLeave"});onLeave=_e({alias:"pMotionOnLeave"});onAfterLeave=_e({alias:"pMotionOnAfterLeave"});onLeaveCancelled=_e({alias:"pMotionOnLeaveCancelled"});motionOptions=vo(()=>{let t=this.options()??{};return{name:t.name??this.name(),type:t.type??this.type(),safe:t.safe??this.safe(),disabled:t.disabled??this.disabled(),appear:!1,enter:t.enter??this.enter(),leave:t.leave??this.leave(),duration:t.duration??this.duration(),enterClass:{from:t.enterClass?.from??(t.name?void 0:this.enterFromClass()),to:t.enterClass?.to??(t.name?void 0:this.enterToClass()),active:t.enterClass?.active??(t.name?void 0:this.enterActiveClass())},leaveClass:{from:t.leaveClass?.from??(t.name?void 0:this.leaveFromClass()),to:t.leaveClass?.to??(t.name?void 0:this.leaveToClass()),active:t.leaveClass?.active??(t.name?void 0:this.leaveActiveClass())},onBeforeEnter:t.onBeforeEnter??this.handleBeforeEnter,onEnter:t.onEnter??this.handleEnter,onAfterEnter:t.onAfterEnter??this.handleAfterEnter,onEnterCancelled:t.onEnterCancelled??this.handleEnterCancelled,onBeforeLeave:t.onBeforeLeave??this.handleBeforeLeave,onLeave:t.onLeave??this.handleLeave,onAfterLeave:t.onAfterLeave??this.handleAfterLeave,onLeaveCancelled:t.onLeaveCancelled??this.handleLeaveCancelled}});motion;isInitialMount=!0;cancelled=!1;destroyed=!1;handleBeforeEnter=t=>!this.destroyed&&this.onBeforeEnter.emit(t);handleEnter=t=>!this.destroyed&&this.onEnter.emit(t);handleAfterEnter=t=>!this.destroyed&&this.onAfterEnter.emit(t);handleEnterCancelled=t=>!this.destroyed&&this.onEnterCancelled.emit(t);handleBeforeLeave=t=>!this.destroyed&&this.onBeforeLeave.emit(t);handleLeave=t=>!this.destroyed&&this.onLeave.emit(t);handleAfterLeave=t=>!this.destroyed&&this.onAfterLeave.emit(t);handleLeaveCancelled=t=>!this.destroyed&&this.onLeaveCancelled.emit(t);constructor(){super(),ci(()=>{this.motion||(this.motion=Zu(this.$el,this.motionOptions()))}),To(()=>{if(!this.$el)return;let t=this.isInitialMount&&this.visible()&&this.appear(),r=this.hideStrategy();this.visible()?(Hs(this.$el,r),(t||!this.isInitialMount)&&this.motion?.enter()):this.isInitialMount?Gr(this.$el,r):this.motion?.leave()?.then(()=>{this.$el&&!this.cancelled&&!this.visible()&&Gr(this.$el,r)}),this.isInitialMount=!1})}onDestroy(){this.destroyed=!0,this.cancelled=!0,this.motion?.cancel(),this.motion=void 0,Hs(this.$el,this.hideStrategy()),this.isInitialMount=!0}static \u0275fac=function(r){return new(r||n)};static \u0275dir=ch({type:n,selectors:[["","pMotion",""]],inputs:{visible:[1,"pMotion","visible"],name:[1,"pMotionName","name"],type:[1,"pMotionType","type"],safe:[1,"pMotionSafe","safe"],disabled:[1,"pMotionDisabled","disabled"],appear:[1,"pMotionAppear","appear"],enter:[1,"pMotionEnter","enter"],leave:[1,"pMotionLeave","leave"],duration:[1,"pMotionDuration","duration"],hideStrategy:[1,"pMotionHideStrategy","hideStrategy"],enterFromClass:[1,"pMotionEnterFromClass","enterFromClass"],enterToClass:[1,"pMotionEnterToClass","enterToClass"],enterActiveClass:[1,"pMotionEnterActiveClass","enterActiveClass"],leaveFromClass:[1,"pMotionLeaveFromClass","leaveFromClass"],leaveToClass:[1,"pMotionLeaveToClass","leaveToClass"],leaveActiveClass:[1,"pMotionLeaveActiveClass","leaveActiveClass"],options:[1,"pMotionOptions","options"]},outputs:{onBeforeEnter:"pMotionOnBeforeEnter",onEnter:"pMotionOnEnter",onAfterEnter:"pMotionOnAfterEnter",onEnterCancelled:"pMotionOnEnterCancelled",onBeforeLeave:"pMotionOnBeforeLeave",onLeave:"pMotionOnLeave",onAfterLeave:"pMotionOnAfterLeave",onLeaveCancelled:"pMotionOnLeaveCancelled"},features:[wo([el,{provide:Nm,useExisting:n},{provide:Ro,useExisting:n}]),ur]})}return n})(),Db=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=ah({type:n});static \u0275inj=ih({imports:[uv]})}return n})();export{Ae as a,iy as b,sy as c,oy as d,ue as e,SA as f,dw as g,RA as h,CA as i,PA as j,NA as k,DA as l,kA as m,OA as n,VA as o,xA as p,LA as q,MA as r,GA as s,vm as t,Tm as u,cb as v,Am as w,lb as x,hb as y,db as z,uv as A,Nb as B,Db as C};
