var m=(r=>(r.HEALTHY="healthy",r.WARNING="warning",r.CRITICAL="critical",r))(m||{});var i=class s{id;name;userId;description;encryptedToken;status;createdAt;updatedAt;lastTestedAt;lastTestError;lastSyncAt;lastSyncStatus;lastError;lastErrorAt;tags;priority;isFavorite;constructor(e){this.id=e.id,this.name=e.name,this.userId=e.userId,this.description=e.description,this.encryptedToken=e.encryptedToken,this.status=e.status,this.createdAt=e.createdAt,this.updatedAt=e.updatedAt,this.lastTestedAt=e.lastTestedAt,this.lastTestError=e.lastTestError,this.lastSyncAt=e.lastSyncAt,this.lastSyncStatus=e.lastSyncStatus,this.lastError=e.lastError,this.lastErrorAt=e.lastErrorAt,this.tags=e.tags,this.priority=e.priority,this.isFavorite=e.isFavorite}isHealthy(){return this.status==="ACTIVE"}hasTokenIssue(){return this.status==="INVALID_TOKEN"}isRateLimited(){return this.status==="RATE_LIMITED"}isDisabled(){return this.status==="DISABLED"}canSync(){return!this.isDisabled()&&!this.hasTokenIssue()}getStatusMessage(){switch(this.status){case"ACTIVE":return"Active";case"INVALID_TOKEN":return"Invalid Token";case"RATE_LIMITED":return"Rate Limited";case"ERROR":return"Error";case"DISABLED":return"Disabled";default:return"Unknown"}}toFirestore(){return{name:this.name,userId:this.userId,description:this.description,encryptedToken:this.encryptedToken,status:this.status,createdAt:this.createdAt,updatedAt:this.updatedAt,lastTestedAt:this.lastTestedAt,lastTestError:this.lastTestError,lastSyncAt:this.lastSyncAt,lastSyncStatus:this.lastSyncStatus,lastError:this.lastError,lastErrorAt:this.lastErrorAt,tags:this.tags,priority:this.priority,isFavorite:this.isFavorite}}static fromFirestore(e,t){return new s({id:e,name:t.name,userId:t.userId,description:t.description,encryptedToken:t.encryptedToken,status:t.status,createdAt:t.createdAt,updatedAt:t.updatedAt,lastTestedAt:t.lastTestedAt,lastTestError:t.lastTestError,lastSyncAt:t.lastSyncAt,lastSyncStatus:t.lastSyncStatus,lastError:t.lastError,lastErrorAt:t.lastErrorAt,tags:t.tags,priority:t.priority,isFavorite:t.isFavorite})}};var n=class s{id;workspaceId;startAt;endAt;status;domainsProcessed;subscriptionsProcessed;errors;constructor(e){this.id=e.id,this.workspaceId=e.workspaceId,this.startAt=e.startAt,this.endAt=e.endAt,this.status=e.status,this.domainsProcessed=e.domainsProcessed,this.subscriptionsProcessed=e.subscriptionsProcessed,this.errors=e.errors}isRunning(){return this.status==="running"}isSuccess(){return this.status==="success"}isFailed(){return this.status==="failed"}isPartialSuccess(){return this.status==="partial_success"}hasErrors(){return this.errors.length>0}getTotalProcessed(){return this.domainsProcessed+this.subscriptionsProcessed}getDurationMs(){return this.endAt?this.endAt.toMillis()-this.startAt.toMillis():null}getDurationSeconds(){let e=this.getDurationMs();return e?Math.round(e/1e3):null}toFirestore(){return{workspaceId:this.workspaceId,startAt:this.startAt,endAt:this.endAt,status:this.status,domainsProcessed:this.domainsProcessed,subscriptionsProcessed:this.subscriptionsProcessed,errors:this.errors}}static fromFirestore(e,t){return new s({id:e,workspaceId:t.workspaceId,startAt:t.startAt,endAt:t.endAt,status:t.status,domainsProcessed:t.domainsProcessed||0,subscriptionsProcessed:t.subscriptionsProcessed||0,errors:t.errors||[]})}};var o=class{id;workspaceId;entityType;entityId;entityName;daysBefore;expiresAt;createdAt;processed;constructor(e){this.id=e.id,this.workspaceId=e.workspaceId,this.entityType=e.entityType,this.entityId=e.entityId,this.entityName=e.entityName,this.daysBefore=e.daysBefore,this.expiresAt=e.expiresAt,this.createdAt=e.createdAt,this.processed=e.processed}isCritical(){return this.daysBefore<=7}isWarning(){return this.daysBefore>7&&this.daysBefore<=30}isInfo(){return this.daysBefore>30}getSeverity(){return this.daysBefore<=3?"danger":this.daysBefore<=7?"warn":this.daysBefore<=30?"info":"success"}getDaysBeforeLabel(){return this.daysBefore===1?"1 d\xEDa":`${this.daysBefore} d\xEDas`}getEntityTypeLabel(){return this.entityType==="domain"?"Dominio":"Suscripci\xF3n"}};var a=class{id;action;workspaceId;actorUid;actorEmail;createdAt;status;meta;errorMessage;constructor(e){this.id=e.id,this.action=e.action,this.workspaceId=e.workspaceId,this.actorUid=e.actorUid,this.actorEmail=e.actorEmail,this.createdAt=e.createdAt,this.status=e.status,this.meta=e.meta,this.errorMessage=e.errorMessage}isSuccess(){return this.status==="success"}isFailure(){return this.status==="failed"}isPartial(){return this.status==="partial"}getSeverity(){switch(this.status){case"success":return"success";case"failed":return"danger";case"partial":return"warn";default:return"info"}}getActionLabel(){return{"workspace.create":"Crear Workspace","workspace.update":"Actualizar Workspace","workspace.disable":"Deshabilitar Workspace","workspace.delete":"Eliminar Workspace","token.save":"Guardar Token","token.test":"Probar Conexi\xF3n","sync.manual":"Sincronizaci\xF3n Manual","sync.scheduled":"Sincronizaci\xF3n Programada","alert.generate":"Generar Alertas","dns.view":"Ver DNS","dns.validate":"Validar DNS","dns.snapshot":"Snapshot DNS","dns.rollback":"Rollback DNS"}[this.action]||this.action}getStatusLabel(){return{success:"\xC9xito",failure:"Fallo",partial:"Parcial"}[this.status]||this.status}getActionIcon(){return this.action.startsWith("workspace.")?"pi pi-briefcase":this.action.startsWith("token.")?"pi pi-key":this.action.startsWith("sync.")?"pi pi-sync":this.action.startsWith("alert.")?"pi pi-bell":this.action.startsWith("dns.")?"pi pi-globe":"pi pi-file"}isWorkspaceAction(){return this.action.startsWith("workspace.")}isSyncAction(){return this.action.startsWith("sync.")}};var c=class{workspaceId;workspaceName;rateLimitRequests;rateLimitRemaining;rateLimitResetTime;rateLimitPercentage;lastSuccessfulSync;lastFailedSync;consecutiveFailures;averageSyncTime;totalSyncs;successfulSyncs;failedSyncs;lastError;lastErrorTime;errorFrequency;errorTypes;circuitBreakerStatus;circuitBreakerOpenedAt;healthStatus;healthScore;lastUpdated;constructor(e){this.workspaceId=e.workspaceId,this.workspaceName=e.workspaceName,this.rateLimitRequests=e.rateLimitRequests,this.rateLimitRemaining=e.rateLimitRemaining,this.rateLimitResetTime=e.rateLimitResetTime,this.rateLimitPercentage=e.rateLimitPercentage,this.lastSuccessfulSync=e.lastSuccessfulSync,this.lastFailedSync=e.lastFailedSync,this.consecutiveFailures=e.consecutiveFailures,this.averageSyncTime=e.averageSyncTime,this.totalSyncs=e.totalSyncs,this.successfulSyncs=e.successfulSyncs,this.failedSyncs=e.failedSyncs,this.lastError=e.lastError,this.lastErrorTime=e.lastErrorTime,this.errorFrequency=e.errorFrequency,this.errorTypes=e.errorTypes,this.circuitBreakerStatus=e.circuitBreakerStatus,this.circuitBreakerOpenedAt=e.circuitBreakerOpenedAt,this.healthStatus=e.healthStatus,this.healthScore=e.healthScore,this.lastUpdated=e.lastUpdated}isNearRateLimit(){return this.rateLimitPercentage>=80}hasCriticalRateLimit(){return this.rateLimitPercentage>=90}hasConsecutiveFailures(){return this.consecutiveFailures>=3}isCircuitOpen(){return this.circuitBreakerStatus==="open"}isHealthy(){return this.healthStatus==="healthy"}needsAttention(){return this.healthStatus==="warning"||this.healthStatus==="critical"}getTimeUntilReset(){return this.rateLimitResetTime?this.rateLimitResetTime.getTime()-Date.now():null}getSyncSuccessRate(){return this.totalSyncs===0?100:Math.round(this.successfulSyncs/this.totalSyncs*100)}getFormattedSyncTime(){let e=Math.round(this.averageSyncTime/1e3);if(e<60)return`${e}s`;let t=Math.floor(e/60),r=e%60;return`${t}m ${r}s`}getMostCommonError(){let e=Object.entries(this.errorTypes);return e.length===0?null:e.sort((r,p)=>p[1]-r[1])[0][0]}static calculateHealthScore(e){let t=100;return e.rateLimitPercentage!==void 0&&(e.rateLimitPercentage>=90?t-=30:e.rateLimitPercentage>=80?t-=20:e.rateLimitPercentage>=70&&(t-=10)),e.consecutiveFailures!==void 0&&(t-=Math.min(e.consecutiveFailures*10,30)),e.errorFrequency!==void 0&&(t-=Math.min(e.errorFrequency*2,20)),e.circuitBreakerStatus==="open"&&(t-=20),Math.max(0,t)}static getHealthStatusFromScore(e){return e>=80?"healthy":e>=50?"warning":"critical"}},u=class{totalWorkspaces;healthyWorkspaces;warningWorkspaces;criticalWorkspaces;totalRateLimitUsage;workspacesNearLimit;totalSyncsToday;successfulSyncsToday;failedSyncsToday;totalErrors24h;workspacesWithErrors;averageHealthScore;lastUpdated;constructor(e){this.totalWorkspaces=e.totalWorkspaces,this.healthyWorkspaces=e.healthyWorkspaces,this.warningWorkspaces=e.warningWorkspaces,this.criticalWorkspaces=e.criticalWorkspaces,this.totalRateLimitUsage=e.totalRateLimitUsage,this.workspacesNearLimit=e.workspacesNearLimit,this.totalSyncsToday=e.totalSyncsToday,this.successfulSyncsToday=e.successfulSyncsToday,this.failedSyncsToday=e.failedSyncsToday,this.totalErrors24h=e.totalErrors24h,this.workspacesWithErrors=e.workspacesWithErrors,this.averageHealthScore=e.averageHealthScore,this.lastUpdated=e.lastUpdated}getSyncSuccessRate(){return this.totalSyncsToday===0?100:Math.round(this.successfulSyncsToday/this.totalSyncsToday*100)}isSystemHealthy(){return this.criticalWorkspaces===0&&this.warningWorkspaces===0}getHealthyPercentage(){return this.totalWorkspaces===0?100:Math.round(this.healthyWorkspaces/this.totalWorkspaces*100)}},l=class{timestamp;workspaceId;healthScore;rateLimitUsage;syncSuccess;errorCount;constructor(e){this.timestamp=e.timestamp,this.workspaceId=e.workspaceId,this.healthScore=e.healthScore,this.rateLimitUsage=e.rateLimitUsage,this.syncSuccess=e.syncSuccess,this.errorCount=e.errorCount}};export{m as a,i as b,n as c,o as d,a as e,c as f,u as g,l as h};
