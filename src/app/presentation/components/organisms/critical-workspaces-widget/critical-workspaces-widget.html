<div class="glass-card full-height critical-widget-container">
  <div class="card-header-compact">
    <div class="header-icon-wrapper">
      <i class="pi pi-exclamation-triangle"></i>
    </div>
    <h3>Workspaces Críticos</h3>
  </div>

  <div class="critical-list-container">
    @if (criticalWorkspaces().length === 0) {
      <div class="no-data">
        <div class="success-icon-wrapper">
          <i class="pi pi-verified"></i>
        </div>
        <p>Todo en orden</p>
        <span class="sub-text">No hay workspaces críticos</span>
      </div>
    } @else {
      <div class="list-content">
        @for (item of criticalWorkspaces(); track item.workspace.id) {
          <div
            class="critical-item"
            [class]="getSeverityClass(item.criticalityScore)"
            (click)="onWorkspaceClick(item.workspace)"
          >
            <div class="item-content">
              <div class="item-main">
                <div class="name-row">
                  <h4 class="workspace-name">{{ item.workspace.name }}</h4>
                  <span class="score-pill" [class]="getSeverityClass(item.criticalityScore)">{{
                    item.criticalityScore
                  }}</span>
                </div>
                <div class="status-row">
                  <span class="status-dot" [class]="getStatusClass(item.workspace.status)"></span>
                  <span class="status-text">{{ item.workspace.status }}</span>
                </div>
              </div>
              <div class="item-action">
                <i class="pi pi-chevron-right"></i>
              </div>
            </div>

            <div class="reasons-list">
              @for (reason of item.reasons.slice(0, 1); track $index) {
                <div class="reason-pill">
                  <i class="pi pi-info-circle"></i>
                  <span>{{ reason }}</span>
                </div>
              }
              @if (item.reasons.length > 1) {
                <span class="more-reasons">+{{ item.reasons.length - 1 }} más</span>
              }
            </div>
          </div>
        }
      </div>
    }
  </div>
</div>
