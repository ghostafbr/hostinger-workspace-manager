<header class="header">
  <div class="header-left">
    <!-- Toggle Sidebar (mobile) -->
    <button
      pButton
      icon="pi pi-bars"
      class="p-button-text p-button-rounded toggle-sidebar-btn"
      (click)="onToggleSidebar()"
      pTooltip="Toggle menu"
      tooltipPosition="bottom"
      aria-label="Abrir o cerrar menú lateral"
      aria-controls="navigation"
    ></button>

    <!-- Workspace Selector -->
    <div class="workspace-selector" role="region" aria-label="Selector de workspace">
      <p-select
        [options]="workspaceOptions()"
        [(ngModel)]="selectedWorkspaceId"
        (onChange)="onWorkspaceChange($event)"
        placeholder="Selecciona un workspace"
        [showClear]="false"
        class="workspace-dropdown"
        aria-label="Seleccionar workspace activo"
      >
        <ng-template let-workspace pTemplate="selectedItem">
          @if (workspace) {
            <div class="workspace-item">
              <span class="workspace-name">{{ workspace.label }}</span>
              @if (workspace.status) {
                <p-tag
                  [value]="workspace.status"
                  [severity]="getStatusSeverity(workspace.status)"
                  class="workspace-status-tag"
                ></p-tag>
              }
            </div>
          }
        </ng-template>
        <ng-template let-workspace pTemplate="item">
          <div class="workspace-item">
            <span class="workspace-name">{{ workspace.label }}</span>
            <p-tag
              [value]="workspace.status"
              [severity]="getStatusSeverity(workspace.status)"
            ></p-tag>
          </div>
        </ng-template>
      </p-select>
    </div>

    <!-- Quick Actions -->
    @if (hasWorkspaceSelected()) {
      <div class="quick-actions" role="group" aria-label="Acciones rápidas">
        <button
          pButton
          icon="pi pi-link"
          label="Test"
          class="p-button-outlined p-button-sm"
          (click)="onTestConnection()"
          [loading]="isTestingConnection()"
          [disabled]="!canTestConnection()"
          pTooltip="Test connection to Hostinger API"
          tooltipPosition="bottom"
          aria-label="Probar conexión con la API de Hostinger"
        ></button>
        <button
          pButton
          icon="pi pi-refresh"
          label="Sync"
          class="p-button-outlined p-button-sm"
          (click)="onSyncNow()"
          [loading]="isSyncing()"
          [disabled]="!canSync()"
          pTooltip="Sync data from Hostinger"
          tooltipPosition="bottom"
          aria-label="Sincronizar datos desde Hostinger"
        ></button>
      </div>
    }
  </div>

  <div class="header-right">
    <!-- Notifications -->
    <button
      pButton
      icon="pi pi-bell"
      class="p-button-text p-button-rounded notification-btn"
      badge="3"
      badgeClass="p-badge-danger"
      pTooltip="Notifications"
      tooltipPosition="bottom"
    ></button>

    <!-- User Menu -->
    <div class="user-menu">
      <p-avatar
        [label]="userInitials()"
        class="user-avatar"
        shape="circle"
        [style]="{ 'background-color': '#2196F3', color: '#ffffff', cursor: 'pointer' }"
        (click)="userPopover.toggle($event)"
      ></p-avatar>

      <p-popover #userPopover>
        <p-menu [model]="userMenuItems" class="user-dropdown-menu" />
      </p-popover>
    </div>
  </div>
</header>
