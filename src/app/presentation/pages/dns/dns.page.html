<div class="dns-page" role="main" aria-labelledby="dns-heading">
  <p-toast />

  <!-- Toolbar -->
  <p-toolbar class="dns-toolbar" role="toolbar" aria-label="Barra de herramientas DNS">
    <div class="p-toolbar-group-start">
      <h1 class="page-title" id="dns-heading">
        <i class="pi pi-sitemap" aria-hidden="true"></i>
        Gestión DNS
      </h1>
    </div>

    <div class="p-toolbar-group-end domain-toolbar-group">
      <span class="domain-toolbar-label">
        <i class="pi pi-globe card-icon" aria-hidden="true"></i>
        Seleccionar Dominio
      </span>
      <p-select
        inputId="domain-select"
        [options]="domainOptions()"
        [(ngModel)]="selectedDomain"
        (ngModelChange)="onDomainChange($event)"
        placeholder="Selecciona un dominio..."
        [filter]="true"
        filterPlaceholder="Buscar dominio"
        [showClear]="true"
        [loading]="isLoadingDomains()"
        optionLabel="label"
        optionValue="value"
        class="w-auto domain-toolbar-select"
        [disabled]="isLoadingDomains()"
      >
        <ng-template pTemplate="empty">
          <div class="empty-state-dropdown">
            <i class="pi pi-inbox" aria-hidden="true"></i>
            <span>No hay dominios disponibles</span>
            <small>Sincroniza tus dominios primero</small>
          </div>
        </ng-template>
      </p-select>
      <span class="domain-toolbar-count">
        <i class="pi pi-info-circle" aria-hidden="true"></i>
        {{ domains().length }} dominio{{ domains().length !== 1 ? 's' : '' }} disponible{{ domains().length !== 1 ? 's' : '' }}
      </span>
      <p-button
        icon="pi pi-refresh"
        severity="secondary"
        [outlined]="true"
        [loading]="isSyncingDns()"
        (onClick)="syncDnsRecords()"
        pTooltip="Sincronizar registros DNS"
        tooltipPosition="bottom"
        aria-label="Sincronizar registros DNS desde Hostinger API"
        [text]="true"
      />
    </div>
  </p-toolbar>

  <!-- Main Content -->
  <div class="dns-content">


    @if (domainName()) {
      <!-- DNS Records Section -->
      <div class="dns-section" @slideUp>
        <div class="section-header">
          <div class="header-left">
            <h2>
              <i class="pi pi-list" aria-hidden="true"></i>
              Registros DNS
            </h2>
            <p-chip
              label="{{ domainName() }}"
              icon="pi pi-globe"
              class="domain-chip"
            />
          </div>
        </div>
        <app-dns-viewer [domainName]="domainName()" />
      </div>

      <!-- DNS Comparison Section -->
      <div class="dns-section" @slideUp>
        <div class="section-header">
          <div class="header-left">
            <h2>
              <i class="pi pi-history" aria-hidden="true"></i>
              Comparar Snapshots
            </h2>
          </div>
          <p class="section-subtitle">Compara la configuración actual con versiones anteriores</p>
        </div>
        <app-dns-comparator [domainName]="domainName()" />
      </div>
    } @else {
      <!-- Empty State -->
      <div class="empty-state-container" @fadeIn>
        <p-card>
          <div class="empty-state-content">
            <div class="empty-icon">
              <i class="pi pi-search" aria-hidden="true"></i>
            </div>
            <h3>Selecciona un Dominio</h3>
            <p>Elige un dominio del selector para visualizar sus registros DNS y comparar snapshots</p>
            @if (domains().length === 0) {
              <p-button
                label="Sincronizar Dominios"
                icon="pi pi-refresh"
                severity="primary"
                [outlined]="true"
                (onClick)="syncDnsRecords()"
                [loading]="isSyncingDns()"
              />
            }
          </div>
        </p-card>
      </div>
    }
  </div>
</div>
